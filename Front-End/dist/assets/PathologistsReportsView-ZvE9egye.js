var J=Object.defineProperty;var U=(y,e,a)=>e in y?J(y,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):y[e]=a;var E=(y,e,a)=>U(y,typeof e!="symbol"?e+"":e,a);import{A as q,a as N,u as K,b as Q}from"./PathologistList.vue_vue_type_style_index_0_scoped_45f5ffeb_lang-FwbajLSj.js";import{d as P,c as $,j as M,e as d,u as b,w as O,f as v,D as X,b as u,h as t,F as T,l as j,t as p,n as Z,r as _,k as I,T as tt,g as et,q as ot,i as st}from"./index-CAHFE_9E.js";import{C as S,_ as nt}from"./DiseaseList.vue_vue_type_style_index_0_scoped_2e8ef3ac_lang-CSxq79ax.js";/* empty css                                                                   */import{_ as rt}from"./AccessDeniedAlert.vue_vue_type_script_setup_true_lang-DQszwtgF.js";import{F as D}from"./FormSelect-Dz8sviG5.js";import{a as at,_ as it}from"./ClearButton.vue_vue_type_script_setup_true_lang-iqMnWNPk.js";import{R as lt}from"./RefreshIcon-CgqLp7N5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const dt=P({__name:"PathologistPerformanceChart",props:{datos:{}},setup(y){const e=y,a=$(()=>[{name:"Dentro de Oportunidad",data:e.datos.map(s=>s.withinOpportunity)},{name:"Fuera de Oportunidad",data:e.datos.map(s=>s.outOfOpportunity)}]),i=$(()=>({chart:{type:"bar",stacked:!0,toolbar:{show:!0,tools:{download:!1,selection:!1,zoom:!1,zoomin:!1,zoomout:!1,pan:!1,reset:!1}},fontFamily:"Inter, sans-serif",background:"#F9FAFB"},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,formatter:function(s,n){const r=n.dataPointIndex;if(n.seriesIndex===1){const m=a.value[0].data[r],h=a.value[1].data[r],x=m+h;return x>0?`${x}`:""}return""},style:{fontSize:"11px",fontWeight:"bold",colors:["#374151"]},offsetY:-18},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:e.datos.map(s=>s.name),labels:{style:{fontSize:"12px",fontFamily:"Inter, sans-serif"}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{title:{text:"Casos asignados",style:{fontSize:"12px",fontFamily:"Inter, sans-serif"}},labels:{style:{fontSize:"12px",fontFamily:"Inter, sans-serif"}}},fill:{opacity:1},tooltip:{y:{formatter:s=>`${s} procedimientos`},theme:"light",style:{fontSize:"12px",fontFamily:"Inter, sans-serif"}},legend:{position:"top",horizontalAlign:"right",fontSize:"12px",fontFamily:"Inter, sans-serif",markers:{width:12,height:12,radius:12}},colors:["#6ce9a6","#f97066"],grid:{borderColor:"#E5E7EB",strokeDashArray:4,xaxis:{lines:{show:!1}}}}));return i.value.responsive=[{breakpoint:1280,options:{plotOptions:{bar:{columnWidth:"60%"}},legend:{position:"top"}}},{breakpoint:1024,options:{plotOptions:{bar:{columnWidth:"70%"}},legend:{position:"bottom"}}},{breakpoint:640,options:{plotOptions:{bar:{columnWidth:"80%"}},xaxis:{labels:{rotate:-45}},legend:{position:"bottom"}}}],(s,n)=>{const r=X("apexchart");return d(),M(b(S),{title:"Rendimiento por Patólogo",description:"Gráfico de barras apiladas mostrando dentro/fuera de oportunidad por patólogo."},{default:O(()=>[v(r,{type:"bar",height:"320",options:i.value,series:a.value},null,8,["options","series"])]),_:1})}}}),ct={class:"overflow-x-auto -mx-4 sm:mx-0"},ut={class:"min-w-full divide-y divide-gray-200"},pt={class:"bg-white divide-y divide-gray-200"},mt=["onClick"],gt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ft={class:"flex items-center space-x-2"},ht={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},xt={class:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium"},yt={class:"px-6 py-4 whitespace-nowrap text-sm text-red-600 font-medium"},vt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},bt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},_t=P({__name:"PathologistDetailTable",props:{datos:{}},emits:["pathologistClick"],setup(y){const e=y,a=n=>{const r=n.withinOpportunity+n.outOfOpportunity;return r>0?Math.round(n.withinOpportunity/r*100):0},i=n=>n>=80?"text-green-600 font-semibold":n>=60?"text-yellow-600 font-semibold":"text-red-600 font-semibold",s=$(()=>[...e.datos].sort((n,r)=>{const m=n.withinOpportunity+n.outOfOpportunity;return r.withinOpportunity+r.outOfOpportunity-m}));return(n,r)=>(d(),u("div",ct,[t("table",ut,[r[1]||(r[1]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Patólogo "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Total "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Dentro "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fuera "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," % Cumplimiento "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tiempo Promedio ")])],-1)),t("tbody",pt,[(d(!0),u(T,null,j(s.value,m=>(d(),u("tr",{key:m.name,class:"hover:bg-gray-50 cursor-pointer transition-colors duration-200",onClick:h=>n.$emit("pathologistClick",m)},[t("td",gt,[t("div",ft,[t("span",null,p(m.name),1),r[0]||(r[0]=t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])]),t("td",ht,p(m.withinOpportunity+m.outOfOpportunity),1),t("td",xt,p(m.withinOpportunity),1),t("td",yt,p(m.outOfOpportunity),1),t("td",vt,[t("span",{class:Z(i(a(m)))},p(a(m))+"% ",3)]),t("td",bt,p(m.avgTime.toFixed(1))+" días ",1)],8,mt))),128))])])]))}});class wt{constructor(){E(this,"baseCases",q.ENDPOINTS.CASES)}async getMonthlyPathologists(e,a){try{const i={};typeof e=="number"&&(i.month=e),typeof a=="number"&&(i.year=a);const s=await N.get(`${this.baseCases}/estadisticas-oportunidad-mensual-detalle`,{params:i}),n=(s==null?void 0:s.data)??s;return this.mapApiToFront(n)}catch(i){console.warn("Fallo en /estadisticas-oportunidad-mensual-detalle. Se intenta fallback /estadisticas",i);try{const s=`${this.baseCases}/estadisticas`,n=await N.get(s),r=(n==null?void 0:n.data)??n;return this.mapGeneralStatsToFront(r)}catch(s){return console.error("Fallo en /estadisticas",s),{pathologists:[]}}}}mapApiToFront(e){const a=[],i=(e==null?void 0:e.patologos)||(e==null?void 0:e.rendimiento_patologos)||(e==null?void 0:e.pathologists)||[];if(Array.isArray(i))for(const r of i)a.push({name:String(r.nombre||r.name||r.patologo||""),withinOpportunity:Number(r.dentroOportunidad||r.within||r.en_oportunidad||0),outOfOpportunity:Number(r.fueraOportunidad||r.out||r.fuera||0),avgTime:Number(r.tiempoPromedio||r.avgTime||r.tiempo||0)});const s=(e==null?void 0:e.resumen)||{},n={total:Number(s.total||0),within:Number(s.dentro||0),out:Number(s.fuera||0)};return{pathologists:a,summary:n}}mapGeneralStatsToFront(e){const a=[],i=(e==null?void 0:e.casos_por_patologo)||(e==null?void 0:e.by_pathologist)||{};if(i&&typeof i=="object")for(const[s,n]of Object.entries(i))a.push({name:s,withinOpportunity:Number(n),outOfOpportunity:0,avgTime:0});return{pathologists:a}}async getPathologistEntities(e,a,i){try{const s={patologo:e};typeof a=="number"&&(s.month=a),typeof i=="number"&&(s.year=i),console.log("Llamando API entidades con params:",s);const n=await N.get(`${this.baseCases}/entidades-por-patologo`,{params:s}),r=(n==null?void 0:n.data)??n;return console.log("Respuesta API entidades:",r),r}catch(s){throw console.error("Error obteniendo entidades del patólogo:",s),new Error("Error de conexión con el servidor")}}async getPathologistTests(e,a,i){try{const s={patologo:e};typeof a=="number"&&(s.month=a),typeof i=="number"&&(s.year=i);const n=await N.get(`${this.baseCases}/pruebas-por-patologo`,{params:s});return(n==null?void 0:n.data)??n}catch(s){throw console.error("Error obteniendo pruebas del patólogo:",s),new Error("Error de conexión con el servidor")}}}const z=new wt,kt={class:"relative bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto overflow-x-hidden mt-4 sm:mt-10 md:mt-16 mx-4 sm:mx-0"},Ot={class:"sticky top-0 z-10 bg-white border-b border-gray-200 px-4 sm:px-6 py-3 sm:py-4 rounded-t-2xl flex items-center justify-between"},$t={class:"text-sm text-gray-500 mt-1"},Ct={class:"p-4 sm:p-6 space-y-4 sm:space-y-6"},Mt={class:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100"},Pt={class:"flex items-center space-x-4"},Ft={class:"text-2xl font-bold text-gray-900"},Nt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"},St={class:"bg-green-50 border border-green-200 rounded-xl p-4"},Tt={class:"flex items-center justify-between"},jt={class:"text-2xl font-bold text-green-700"},zt={class:"bg-red-50 border border-red-200 rounded-xl p-4"},At={class:"flex items-center justify-between"},Et={class:"text-2xl font-bold text-red-700"},Dt={class:"bg-blue-50 border border-blue-200 rounded-xl p-4"},It={class:"flex items-center justify-between"},Bt={class:"text-2xl font-bold text-blue-700"},Vt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6"},Lt={class:"bg-gray-50 rounded-xl p-6 space-y-4"},Rt={key:0,class:"flex items-center justify-center py-8"},Yt={key:1,class:"text-center py-8 text-gray-500"},Gt={key:2,class:"space-y-3"},Ht={class:"flex items-center justify-between"},Wt={class:"flex items-center space-x-3"},Jt={class:"text-sm font-medium text-gray-900"},Ut={class:"text-xs text-gray-500"},qt={class:"text-right"},Kt={class:"text-lg font-bold text-blue-600"},Qt={class:"bg-gray-50 rounded-xl p-6 space-y-4"},Xt={key:0,class:"flex items-center justify-center py-8"},Zt={key:1,class:"text-center py-8 text-gray-500"},te={key:2,class:"space-y-3"},ee={class:"flex items-center justify-between"},oe={class:"flex items-center space-x-3"},se={class:"text-sm font-medium text-gray-900"},ne={class:"text-xs text-gray-500"},re={class:"text-right"},ae={class:"text-lg font-bold text-green-600"},ie={class:"sticky bottom-0 bg-white border-t border-gray-200 px-4 sm:px-6 py-3 sm:py-4 rounded-b-2xl flex justify-end"},le=P({__name:"PathologistDetailsModal",props:{pathologist:{},period:{}},emits:["close"],setup(y){const e=y,a=_([]),i=_(!1),s=_([]),n=_(!1);$(()=>e.pathologist?e.pathologist.withinOpportunity+e.pathologist.outOfOpportunity:0);function r(l){if(l<1)return`${Math.round(l*60)} min`;const o=Math.floor(l),g=Math.round((l-o)*60);return`${o}h ${g}min`}function m(){return`${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][e.period.month-1]} ${e.period.year}`}async function h(){if(e.pathologist){i.value=!0;try{const l=await z.getPathologistEntities(e.pathologist.name,e.period.month,e.period.year);a.value=l.entidades||[]}catch(l){console.error("Error cargando entidades:",l),a.value=[]}finally{i.value=!1}}}async function x(){if(e.pathologist){n.value=!0;try{const l=await z.getPathologistTests(e.pathologist.name,e.period.month,e.period.year);s.value=l.pruebas||[]}catch(l){console.error("Error cargando pruebas:",l),s.value=[]}finally{n.value=!1}}}return I(()=>e.pathologist,l=>{l?(h(),x()):(a.value=[],s.value=[])},{immediate:!0}),(l,o)=>(d(),M(tt,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:O(()=>[l.pathologist?(d(),u("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:o[2]||(o[2]=ot(g=>l.$emit("close"),["self"]))},[t("div",kt,[t("div",Ot,[t("div",null,[o[3]||(o[3]=t("h3",{class:"text-xl font-semibold text-gray-900"},"Detalles del Patólogo",-1)),t("p",$t,"Período: "+p(m()),1)]),t("button",{onClick:o[0]||(o[0]=g=>l.$emit("close")),class:"text-gray-400 hover:text-gray-600 transition-colors"},[...o[4]||(o[4]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Ct,[t("div",Mt,[t("div",Pt,[o[6]||(o[6]=t("div",{class:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center"},[t("svg",{class:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),t("div",null,[t("h4",Ft,p(l.pathologist.name),1),o[5]||(o[5]=t("p",{class:"text-blue-600 font-medium"},"Patólogo",-1))])])]),t("div",Nt,[t("div",St,[t("div",Tt,[t("div",null,[o[7]||(o[7]=t("p",{class:"text-sm text-green-600 font-medium"},"Dentro de Oportunidad",-1)),t("p",jt,p(l.pathologist.withinOpportunity),1),o[8]||(o[8]=t("p",{class:"text-xs text-green-600"},"casos",-1))]),o[9]||(o[9]=t("div",{class:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center"},[t("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1))])]),t("div",zt,[t("div",At,[t("div",null,[o[10]||(o[10]=t("p",{class:"text-sm text-red-600 font-medium"},"Fuera de Oportunidad",-1)),t("p",Et,p(l.pathologist.outOfOpportunity),1),o[11]||(o[11]=t("p",{class:"text-xs text-red-600"},"casos",-1))]),o[12]||(o[12]=t("div",{class:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center"},[t("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1))])]),t("div",Dt,[t("div",It,[t("div",null,[o[13]||(o[13]=t("p",{class:"text-sm text-blue-600 font-medium"},"Tiempo Promedio",-1)),t("p",Bt,p(r(l.pathologist.avgTime)),1),o[14]||(o[14]=t("p",{class:"text-xs text-blue-600"},"por caso",-1))]),o[15]||(o[15]=t("div",{class:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center"},[t("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])])]),t("div",Vt,[t("div",Lt,[o[20]||(o[20]=t("h5",{class:"text-lg font-semibold text-gray-900"},"Entidades donde trabaja",-1)),i.value?(d(),u("div",Rt,[...o[16]||(o[16]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),t("span",{class:"ml-2 text-gray-600"},"Cargando entidades...",-1)])])):a.value.length===0?(d(),u("div",Yt,[...o[17]||(o[17]=[t("svg",{class:"w-12 h-12 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1),t("p",null,"No se encontraron entidades",-1)])])):(d(),u("div",Gt,[(d(!0),u(T,null,j(a.value,g=>(d(),u("div",{key:g.name,class:"bg-white rounded-lg p-4 border border-gray-200"},[t("div",Ht,[t("div",Wt,[o[18]||(o[18]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),t("div",null,[t("h6",Jt,p(g.name),1),t("p",Ut,p(g.codigo),1)])]),t("div",qt,[t("div",Kt,p(g.casesCount),1),o[19]||(o[19]=t("div",{class:"text-xs text-gray-500"},"casos",-1))])])]))),128))]))]),t("div",Qt,[o[25]||(o[25]=t("h5",{class:"text-lg font-semibold text-gray-900"},"Pruebas realizadas",-1)),n.value?(d(),u("div",Xt,[...o[21]||(o[21]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"},null,-1),t("span",{class:"ml-2 text-gray-600"},"Cargando pruebas...",-1)])])):s.value.length===0?(d(),u("div",Zt,[...o[22]||(o[22]=[t("svg",{class:"w-12 h-12 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("p",null,"No se encontraron pruebas",-1)])])):(d(),u("div",te,[(d(!0),u(T,null,j(s.value,g=>(d(),u("div",{key:g.name,class:"bg-white rounded-lg p-4 border border-gray-200"},[t("div",ee,[t("div",oe,[o[23]||(o[23]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",null,[t("h6",se,p(g.name),1),t("p",ne,p(g.codigo),1)])]),t("div",re,[t("div",ae,p(g.count),1),o[24]||(o[24]=t("div",{class:"text-xs text-gray-500"},"realizadas",-1))])])]))),128))]))])])]),t("div",ie,[t("button",{onClick:o[1]||(o[1]=g=>l.$emit("close")),class:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-200 transition-colors"}," Cerrar ")])])])):et("",!0)]),_:1}))}}),de={class:"space-y-6"},ce={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"},ue={class:"flex items-end gap-2"},pe={key:1,class:"space-y-4"},me={class:"px-2"},ge={class:"text-xl font-bold text-brand-700"},fe={key:0,class:"text-gray-500"},he={key:1},xe=P({__name:"PathologistsReport",setup(y){const e=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],a=new Date,i=a.getFullYear(),s=Array.from({length:5},(c,f)=>i-f),n=a.getMonth(),r=(n+11)%12,m=n===0?i-1:i,h=_(String(r)),x=_(String(m)),l=_(!1),o=_(!1),g=_(null),A=$(()=>{const c=new Date,f=c.getFullYear(),w=c.getMonth();return e.map((k,C)=>Number(x.value)===f&&C>=w?null:{value:String(C),label:k}).filter(k=>k!==null)}),B=$(()=>s.map(c=>({value:String(c),label:String(c)})));I(x,c=>{const f=new Date,w=f.getFullYear(),k=f.getMonth();if(Number(c)===w&&Number(h.value)>=k){const W=(k+11)%12;h.value=String(W)}});const V=$(()=>{const c=Number(h.value);return Number.isFinite(c)&&e[c]?e[c]:""}),L=async()=>{if(!h.value||!x.value)return;const c=new Date,f=c.getFullYear(),w=c.getMonth(),k=Number(x.value),C=Number(h.value);if(k>f||k===f&&C>=w){console.warn("No se puede generar reporte para un mes futuro");return}l.value=!0;try{await Y(),o.value=!0}finally{l.value=!1}},R=()=>{h.value="",x.value="",o.value=!1},F=_([]);async function Y(){const c=await z.getMonthlyPathologists(Number(h.value)+1,Number(x.value));F.value=c.pathologists}function G(c){g.value=c}function H(){g.value=null}return(c,f)=>(d(),u("div",de,[v(b(S),{title:"Reporte de Patólogos",description:"Seleccione mes y año para generar el informe."},{default:O(()=>[t("div",ce,[v(b(D),{modelValue:h.value,"onUpdate:modelValue":f[0]||(f[0]=w=>h.value=w),label:"Mes",options:A.value,placeholder:"Seleccione mes"},null,8,["modelValue","options"]),v(b(D),{modelValue:x.value,"onUpdate:modelValue":f[1]||(f[1]=w=>x.value=w),label:"Año",options:B.value,placeholder:"Seleccione año"},null,8,["modelValue","options"]),t("div",ue,[v(b(at),{loading:l.value,disabled:!h.value||!x.value,text:l.value?"Generando...":"Generar Informe",onClick:L},null,8,["loading","disabled","text"]),v(b(it),{onClick:R},{icon:O(()=>[v(b(lt),{class:"w-4 h-4 mr-2"})]),default:O(()=>[f[2]||(f[2]=st(" Limpiar ",-1))]),_:1})])])]),_:1}),o.value?(d(),u("div",pe,[t("div",me,[t("h2",ge,"Reporte de Patólogos - "+p(V.value)+" "+p(x.value),1)]),v(dt,{datos:F.value},null,8,["datos"]),v(b(S),{title:"Detalle por Patólogo",description:"Tabla con métricas detalladas. Haz clic en una fila para ver detalles completos."},{default:O(()=>[F.value.length===0?(d(),u("div",fe,"No hay patólogos con datos para el período seleccionado.")):(d(),u("div",he,[v(_t,{datos:F.value,onPathologistClick:G},null,8,["datos"])]))]),_:1})])):(d(),M(b(S),{key:0,title:"Vista previa",description:"Selecciona un período y genera el informe."},{default:O(()=>[...f[3]||(f[3]=[t("div",{class:"text-gray-600"},'Aún no se ha generado el informe. Selecciona mes y año y presiona "Generar Informe".',-1)])]),_:1})),v(le,{pathologist:g.value,period:{month:Number(h.value)+1,year:Number(x.value)},onClose:H},null,8,["pathologist","period"])]))}}),ye={class:"p-6"},ve={key:1,class:"space-y-6"},Ne=P({__name:"PathologistsReportsView",setup(y){const e=_("Reportes de Patólogos"),{canAccessStatistics:a}=K();return(i,s)=>(d(),M(b(Q),null,{default:O(()=>[v(b(nt),{pageTitle:e.value},null,8,["pageTitle"]),t("div",ye,[b(a)?(d(),u("div",ve,[v(xe)])):(d(),M(rt,{key:0}))])]),_:1}))}});export{Ne as default};
