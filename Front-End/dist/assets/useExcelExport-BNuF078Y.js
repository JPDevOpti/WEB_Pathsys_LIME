import{b as J,e as K,h as b,d as Rt,c as It,j as Ut,g as dt,t as Y,i as kt,x as Vt,n as Dt,C as ce,G as fe,r as xt,k as Bt,o as ee,u as mt,w as At,f as ht,I as he,q as St,_ as re,F as Ot,l as Tt,p as pe,T as me,a as ge}from"./index-CAHFE_9E.js";import{C as ve}from"./DiseaseList.vue_vue_type_style_index_0_scoped_2e8ef3ac_lang-CSxq79ax.js";import{_ as se,a as _e}from"./SearchButton.vue_vue_type_script_setup_true_lang-y2wCoroa.js";import{F as ye}from"./FormSelect-Dz8sviG5.js";import{P as be}from"./PathologistList-CbsQJHAr.js";import{E as we}from"./EntityList-gIDUOf46.js";import{T as xe}from"./TestList-BA4OK-D1.js";import{u as ke,D as ne,S as Xt,c as Ce,a as ie,A as ae}from"./PathologistList.vue_vue_type_style_index_0_scoped_45f5ffeb_lang-FwbajLSj.js";import{_ as Gt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{R as Se}from"./RefreshIcon-CgqLp7N5.js";import{_ as Zt}from"./FormCheckbox.vue_vue_type_script_setup_true_lang-DxUtxK1N.js";import{g as Ae,c as Ft,h as Ee}from"./html2pdf-I8xnP9zX.js";import{_ as ze}from"./PreviewButton.vue_vue_type_script_setup_true_lang-CTpBWkFw.js";import{a as Jt}from"./ActionButton.vue_vue_type_script_setup_true_lang-BQdFEsew.js";import{u as Ie}from"./cases.store-BuW2t6qD.js";const De={},Oe={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Te(nt,it){return K(),J("svg",Oe,[...it[0]||(it[0]=[b("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.5 12C3.5 7.30558 7.30558 3.5 12 3.5C16.6944 3.5 20.5 7.30558 20.5 12C20.5 16.6944 16.6944 20.5 12 20.5C7.30558 20.5 3.5 16.6944 3.5 12ZM12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2ZM11.0991 7.52507C11.0991 8.02213 11.5021 8.42507 11.9991 8.42507H12.0001C12.4972 8.42507 12.9001 8.02213 12.9001 7.52507C12.9001 7.02802 12.4972 6.62507 12.0001 6.62507H11.9991C11.5021 6.62507 11.0991 7.02802 11.0991 7.52507ZM12.0001 17.3714C11.5859 17.3714 11.2501 17.0356 11.2501 16.6214V10.9449C11.2501 10.5307 11.5859 10.1949 12.0001 10.1949C12.4143 10.1949 12.7501 10.5307 12.7501 10.9449V16.6214C12.7501 17.0356 12.4143 17.3714 12.0001 17.3714Z",fill:"currentColor"},null,-1)])])}const Qt=Gt(De,[["render",Te]]),Be={},Re={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Pe(nt,it){return K(),J("svg",Re,[...it[0]||(it[0]=[b("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.54118 3.7915C6.54118 2.54886 7.54854 1.5415 8.79118 1.5415H11.2078C12.4505 1.5415 13.4578 2.54886 13.4578 3.7915V4.0415H15.6249H16.6658C17.08 4.0415 17.4158 4.37729 17.4158 4.7915C17.4158 5.20572 17.08 5.5415 16.6658 5.5415H16.3749V8.24638V13.2464V16.2082C16.3749 17.4508 15.3676 18.4582 14.1249 18.4582H5.87492C4.63228 18.4582 3.62492 17.4508 3.62492 16.2082V13.2464V8.24638V5.5415H3.33325C2.91904 5.5415 2.58325 5.20572 2.58325 4.7915C2.58325 4.37729 2.91904 4.0415 3.33325 4.0415H4.37492H6.54118V3.7915ZM14.8749 13.2464V8.24638V5.5415H13.4578H12.7078H7.29118H6.54118H5.12492V8.24638V13.2464V16.2082C5.12492 16.6224 5.46071 16.9582 5.87492 16.9582H14.1249C14.5391 16.9582 14.8749 16.6224 14.8749 16.2082V13.2464ZM8.04118 4.0415H11.9578V3.7915C11.9578 3.37729 11.6221 3.0415 11.2078 3.0415H8.79118C8.37696 3.0415 8.04118 3.37729 8.04118 3.7915V4.0415ZM8.33325 7.99984C8.74747 7.99984 9.08325 8.33562 9.08325 8.74984V13.7498C9.08325 14.1641 8.74747 14.4998 8.33325 14.4998C7.91904 14.4998 7.58325 14.1641 7.58325 13.7498V8.74984C7.58325 8.33562 7.91904 7.99984 8.33325 7.99984ZM12.4166 8.74984C12.4166 8.33562 12.0808 7.99984 11.6666 7.99984C11.2524 7.99984 10.9166 8.33562 10.9166 8.74984V13.7498C10.9166 14.1641 11.2524 14.4998 11.6666 14.4998C12.0808 14.4998 12.4166 14.1641 12.4166 13.7498V8.74984Z",fill:"currentColor"},null,-1)])])}const $e=Gt(Be,[["render",Pe]]),te=Rt({__name:"DateInputField",props:{modelValue:{default:""},label:{default:""},placeholder:{default:"Seleccione fecha"},required:{type:Boolean,default:!1},errors:{default:()=>[]},warnings:{default:()=>[]},helpText:{default:""},min:{default:""},max:{default:""}},emits:["update:modelValue"],setup(nt,{emit:it}){const m=nt,P=it;function w(h){return/^\d{4}-\d{2}-\d{2}$/.test(h)}function l(h){return/^\d{2}\/\d{2}\/\d{4}$/.test(h)}function r(h){if(!l(h))return"";const[_,g,y]=h.split("/");return`${y}-${g}-${_}`}function n(h){if(!w(h))return"";const[_,g,y]=h.split("-");return`${y}/${g}/${_}`}const a=It({get:()=>{const h=m.modelValue||"";return h?w(h)?h:l(h)?r(h):"":""},set:h=>{if(!h){P("update:modelValue","");return}if(w(h)){P("update:modelValue",n(h));return}P("update:modelValue",h)}});return(h,_)=>(K(),Ut(se,{label:h.label,placeholder:h.placeholder||"Seleccione fecha",type:"date",required:h.required,errors:h.errors,warnings:h.warnings,"help-text":h.helpText,min:h.min,max:h.max,modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=g=>a.value=g)},null,8,["label","placeholder","required","errors","warnings","help-text","min","max","modelValue"]))}}),Ne={class:"flex items-center justify-center"},Fe={class:"text-center"},je={key:0,class:"ml-2 text-gray-600 text-sm mt-2 block"},si=Rt({__name:"LoadingSpinner",props:{text:{default:"Cargando..."}},setup(nt){return(it,m)=>(K(),J("div",Ne,[b("div",Fe,[m[0]||(m[0]=b("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-600 mx-auto"},null,-1)),it.text?(K(),J("span",je,Y(it.text),1)):dt("",!0)])]))}}),Le=["type","disabled"],Ue={key:0,class:"flex items-center"},Me={key:1,class:"flex items-center justify-center"},Ve={key:0},Wt=Rt({__name:"BaseButton",props:{type:{default:"button"},variant:{default:"primary"},size:{default:"md"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{default:""},fullWidth:{type:Boolean,default:!1},customClass:{default:""}},emits:["click"],setup(nt,{emit:it}){const m=nt,P=it,w=It(()=>{const r=["inline-flex items-center justify-center font-medium rounded-lg","transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"],n={xs:"px-2.5 py-1.5 text-xs",sm:"px-3 py-2 text-sm",md:"px-4 py-2.5 text-sm",lg:"px-5 py-3 text-base",xl:"px-6 py-3.5 text-base"};r.push(n[m.size]);const a={primary:["bg-blue-600 text-white shadow-sm hover:bg-blue-700","focus:ring-blue-500 active:bg-blue-800"],secondary:["bg-gray-600 text-white shadow-sm hover:bg-gray-700","focus:ring-gray-500 active:bg-gray-800"],success:["bg-green-600 text-white shadow-sm hover:bg-green-700","focus:ring-green-500 active:bg-green-800"],danger:["bg-red-600 text-white shadow-sm hover:bg-red-700","focus:ring-red-500 active:bg-red-800"],warning:["bg-yellow-600 text-white shadow-sm hover:bg-yellow-700","focus:ring-yellow-500 active:bg-yellow-800"],ghost:["bg-transparent text-gray-700 hover:bg-gray-100","focus:ring-gray-300 active:bg-gray-200"],outline:["bg-transparent text-blue-600 border border-blue-600","hover:bg-blue-50 focus:ring-blue-500 active:bg-blue-100"]};return r.push(...a[m.variant]),m.fullWidth&&r.push("w-full"),m.customClass&&r.push(m.customClass),r.join(" ")}),l=r=>{!m.disabled&&!m.loading&&P("click",r)};return(r,n)=>(K(),J("button",{type:r.type,disabled:r.disabled||r.loading,class:Dt(w.value),onClick:l},[r.loading?(K(),J("div",Ue,[n[0]||(n[0]=b("div",{class:"animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full mr-2"},null,-1)),kt(" "+Y(r.loadingText||"Cargando..."),1)])):(K(),J("div",Me,[Vt(r.$slots,"icon-left"),r.$slots.default?(K(),J("span",Ve,[Vt(r.$slots,"default")])):dt("",!0),Vt(r.$slots,"icon-right")]))],10,Le))}});function Lt(){const nt=new Date,it=new Date(nt);it.setDate(it.getDate()+1);const m=nt.getFullYear(),P=new Date(m,0,1),w=l=>{const r=l.getDate().toString().padStart(2,"0"),n=(l.getMonth()+1).toString().padStart(2,"0"),a=l.getFullYear();return`${r}/${n}/${a}`};return{dateFrom:w(P),dateTo:w(it)}}const Ze={class:"flex flex-col md:flex-row gap-3"},We={class:"flex-1"},He={class:"w-full md:w-auto flex items-end"},qe={class:"flex gap-3 items-end"},Ge={class:"w-44 md:w-56"},Ye={class:"w-44 md:w-56"},Ke={class:"flex flex-col md:flex-row gap-3 mt-3"},Xe={class:"flex-1"},Je={class:"flex-1"},Qe={class:"flex-1"},tr={class:"flex-1"},er={class:"flex flex-col sm:flex-row justify-end gap-2"},ni=Rt({__name:"FiltersBar",props:{modelValue:{},totalFiltered:{},totalAll:{},isLoading:{type:Boolean},canExport:{type:Boolean}},emits:["update:modelValue","refresh","export"],setup(nt,{emit:it}){const m=nt,P=it,{isPatologo:w}=ke(),l=ce(),r=fe({...m.modelValue}),n=xt(""),a=xt(""),h=It(()=>{if(!w.value||!l.user)return null;let c=l.user.username||l.user.nombre||l.user.nombres||l.user.nombre_completo||l.user.full_name||null;if(!c&&(l.user.nombres||l.user.apellidos)){const i=l.user.nombres||"",d=l.user.apellidos||"";c=`${i} ${d}`.trim()}if(!c&&(l.user.first_name||l.user.last_name)){const i=l.user.first_name||"",d=l.user.last_name||"";c=`${i} ${d}`.trim()}return c}),_=[{value:"",label:"Todos"},{value:"En proceso",label:"En proceso"},{value:"Por firmar",label:"Por firmar"},{value:"Por entregar",label:"Por entregar"},{value:"Completado",label:"Completado"}];Bt(()=>m.modelValue,c=>Object.assign(r,c)),Bt(r,()=>P("update:modelValue",{...r}),{deep:!0}),Bt(h,c=>{c&&w.value&&(r.searchPathologist=c)},{immediate:!0}),ee(()=>{h.value&&w.value&&(r.searchPathologist=h.value)});function g(){const c=Lt();r.searchQuery="",w.value?h.value&&(r.searchPathologist=h.value):r.searchPathologist="",r.dateFrom=c.dateFrom,r.dateTo=c.dateTo,r.selectedEntity="",r.selectedStatus="",r.selectedTest="",n.value="",a.value=""}function y(c){if(w.value&&h.value){r.searchPathologist=h.value;return}r.searchPathologist=(c==null?void 0:c.nombre)||""}function o(c){r.selectedEntity=(c==null?void 0:c.nombre)||""}return(c,i)=>(K(),Ut(mt(ve),{title:"Listado de Casos",description:"Filtre los casos actuales por caso, paciente, patólogo, rango de fechas de creación, entidad, estado y pruebas."},{icon:At(()=>[...i[11]||(i[11]=[b("svg",{class:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)])]),footer:At(()=>[b("div",er,[ht(mt(Wt),{size:"sm",variant:"outline",onClick:g},{"icon-left":At(()=>[ht(mt($e),{class:"w-4 h-4 mr-1"})]),default:At(()=>[i[13]||(i[13]=kt(" Limpiar ",-1))]),_:1}),ht(mt(Wt),{size:"sm",variant:"outline",disabled:!c.canExport,onClick:i[9]||(i[9]=d=>c.$emit("export"))},{"icon-left":At(()=>[ht(mt(ne),{class:"w-4 h-4 mr-1"})]),default:At(()=>[i[14]||(i[14]=kt(" Exportar a Excel ",-1))]),_:1},8,["disabled"]),ht(mt(Wt),{size:"sm",variant:"outline",disabled:c.isLoading,onClick:i[10]||(i[10]=d=>c.$emit("refresh"))},{"icon-left":At(()=>[ht(mt(Se),{class:"w-4 h-4 mr-1"})]),default:At(()=>[i[15]||(i[15]=kt(" Actualizar ",-1))]),_:1},8,["disabled"])])]),default:At(()=>[b("div",Ze,[b("div",We,[i[12]||(i[12]=b("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Buscar por nombre o cédula o caso",-1)),ht(mt(se),{modelValue:r.searchQuery,"onUpdate:modelValue":i[0]||(i[0]=d=>r.searchQuery=d),placeholder:"Ej: 2025-00001, 123456789, Juan Pérez",onKeydown:i[1]||(i[1]=he(St(()=>{},["prevent"]),["enter"]))},null,8,["modelValue"])]),b("div",He,[ht(mt(_e),{text:"Buscar",size:"md",disabled:c.isLoading,onClick:i[2]||(i[2]=d=>c.$emit("refresh"))},null,8,["disabled"])]),b("div",qe,[b("div",Ge,[ht(mt(te),{modelValue:r.dateFrom,"onUpdate:modelValue":i[3]||(i[3]=d=>r.dateFrom=d),label:"Fecha desde",placeholder:"DD/MM/AAAA"},null,8,["modelValue"])]),b("div",Ye,[ht(mt(te),{modelValue:r.dateTo,"onUpdate:modelValue":i[4]||(i[4]=d=>r.dateTo=d),label:"Fecha hasta",placeholder:"DD/MM/AAAA"},null,8,["modelValue"])])])]),b("div",Ke,[b("div",Xe,[ht(mt(be),{modelValue:n.value,"onUpdate:modelValue":i[5]||(i[5]=d=>n.value=d),label:"Patólogo",placeholder:mt(w).value?"Patólogo fijo (usted)":"Buscar y seleccionar patólogo...",disabled:mt(w).value,onPathologistSelected:y},null,8,["modelValue","placeholder","disabled"])]),b("div",Je,[ht(mt(we),{modelValue:a.value,"onUpdate:modelValue":i[6]||(i[6]=d=>a.value=d),label:"Entidad",placeholder:"Buscar y seleccionar entidad...",onEntitySelected:o},null,8,["modelValue"])]),b("div",Qe,[ht(mt(xe),{modelValue:r.selectedTest,"onUpdate:modelValue":i[7]||(i[7]=d=>r.selectedTest=d),label:"Pruebas",placeholder:"Buscar y seleccionar prueba..."},null,8,["modelValue"])]),b("div",tr,[ht(mt(ye),{modelValue:r.selectedStatus,"onUpdate:modelValue":i[8]||(i[8]=d=>r.selectedStatus=d),label:"Estado",options:_,placeholder:"Seleccione estado"},null,8,["modelValue"])])])]),_:1}))}});function jt(nt){throw new Error('Could not dynamically require "'+nt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var oe={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(nt,it){(function(m){nt.exports=m()})(function(){return function m(P,w,l){function r(h,_){if(!w[h]){if(!P[h]){var g=typeof jt=="function"&&jt;if(!_&&g)return g(h,!0);if(n)return n(h,!0);var y=new Error("Cannot find module '"+h+"'");throw y.code="MODULE_NOT_FOUND",y}var o=w[h]={exports:{}};P[h][0].call(o.exports,function(c){var i=P[h][1][c];return r(i||c)},o,o.exports,m,P,w,l)}return w[h].exports}for(var n=typeof jt=="function"&&jt,a=0;a<l.length;a++)r(l[a]);return r}({1:[function(m,P,w){var l=m("./utils"),r=m("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";w.encode=function(a){for(var h,_,g,y,o,c,i,d=[],u=0,v=a.length,x=v,A=l.getTypeOf(a)!=="string";u<a.length;)x=v-u,g=A?(h=a[u++],_=u<v?a[u++]:0,u<v?a[u++]:0):(h=a.charCodeAt(u++),_=u<v?a.charCodeAt(u++):0,u<v?a.charCodeAt(u++):0),y=h>>2,o=(3&h)<<4|_>>4,c=1<x?(15&_)<<2|g>>6:64,i=2<x?63&g:64,d.push(n.charAt(y)+n.charAt(o)+n.charAt(c)+n.charAt(i));return d.join("")},w.decode=function(a){var h,_,g,y,o,c,i=0,d=0,u="data:";if(a.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var v,x=3*(a=a.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(a.charAt(a.length-1)===n.charAt(64)&&x--,a.charAt(a.length-2)===n.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=r.uint8array?new Uint8Array(0|x):new Array(0|x);i<a.length;)h=n.indexOf(a.charAt(i++))<<2|(y=n.indexOf(a.charAt(i++)))>>4,_=(15&y)<<4|(o=n.indexOf(a.charAt(i++)))>>2,g=(3&o)<<6|(c=n.indexOf(a.charAt(i++))),v[d++]=h,o!==64&&(v[d++]=_),c!==64&&(v[d++]=g);return v}},{"./support":30,"./utils":32}],2:[function(m,P,w){var l=m("./external"),r=m("./stream/DataWorker"),n=m("./stream/Crc32Probe"),a=m("./stream/DataLengthProbe");function h(_,g,y,o,c){this.compressedSize=_,this.uncompressedSize=g,this.crc32=y,this.compression=o,this.compressedContent=c}h.prototype={getContentWorker:function(){var _=new r(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),g=this;return _.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new r(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(_,g,y){return _.pipe(new n).pipe(new a("uncompressedSize")).pipe(g.compressWorker(y)).pipe(new a("compressedSize")).withStreamInfo("compression",g)},P.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(m,P,w){var l=m("./stream/GenericWorker");w.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},w.DEFLATE=m("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(m,P,w){var l=m("./utils"),r=function(){for(var n,a=[],h=0;h<256;h++){n=h;for(var _=0;_<8;_++)n=1&n?3988292384^n>>>1:n>>>1;a[h]=n}return a}();P.exports=function(n,a){return n!==void 0&&n.length?l.getTypeOf(n)!=="string"?function(h,_,g,y){var o=r,c=y+g;h^=-1;for(var i=y;i<c;i++)h=h>>>8^o[255&(h^_[i])];return-1^h}(0|a,n,n.length,0):function(h,_,g,y){var o=r,c=y+g;h^=-1;for(var i=y;i<c;i++)h=h>>>8^o[255&(h^_.charCodeAt(i))];return-1^h}(0|a,n,n.length,0):0}},{"./utils":32}],5:[function(m,P,w){w.base64=!1,w.binary=!1,w.dir=!1,w.createFolders=!0,w.date=null,w.compression=null,w.compressionOptions=null,w.comment=null,w.unixPermissions=null,w.dosPermissions=null},{}],6:[function(m,P,w){var l=null;l=typeof Promise<"u"?Promise:m("lie"),P.exports={Promise:l}},{lie:37}],7:[function(m,P,w){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=m("pako"),n=m("./utils"),a=m("./stream/GenericWorker"),h=l?"uint8array":"array";function _(g,y){a.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=y,this.meta={}}w.magic="\b\0",n.inherits(_,a),_.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(n.transformTo(h,g.data),!1)},_.prototype.flush=function(){a.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(y){g.push({data:y,meta:g.meta})}},w.compressWorker=function(g){return new _("Deflate",g)},w.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(m,P,w){function l(o,c){var i,d="";for(i=0;i<c;i++)d+=String.fromCharCode(255&o),o>>>=8;return d}function r(o,c,i,d,u,v){var x,A,E=o.file,N=o.compression,$=v!==h.utf8encode,U=n.transformTo("string",v(E.name)),R=n.transformTo("string",h.utf8encode(E.name)),C=E.comment,z=n.transformTo("string",v(C)),s=n.transformTo("string",h.utf8encode(C)),k=R.length!==E.name.length,e=s.length!==C.length,D="",X="",M="",et=E.dir,V=E.date,st={crc32:0,compressedSize:0,uncompressedSize:0};c&&!i||(st.crc32=o.crc32,st.compressedSize=o.compressedSize,st.uncompressedSize=o.uncompressedSize);var T=0;c&&(T|=8),$||!k&&!e||(T|=2048);var O=0,tt=0;et&&(O|=16),u==="UNIX"?(tt=798,O|=function(H,ct){var vt=H;return H||(vt=ct?16893:33204),(65535&vt)<<16}(E.unixPermissions,et)):(tt=20,O|=function(H){return 63&(H||0)}(E.dosPermissions)),x=V.getUTCHours(),x<<=6,x|=V.getUTCMinutes(),x<<=5,x|=V.getUTCSeconds()/2,A=V.getUTCFullYear()-1980,A<<=4,A|=V.getUTCMonth()+1,A<<=5,A|=V.getUTCDate(),k&&(X=l(1,1)+l(_(U),4)+R,D+="up"+l(X.length,2)+X),e&&(M=l(1,1)+l(_(z),4)+s,D+="uc"+l(M.length,2)+M);var q="";return q+=`
\0`,q+=l(T,2),q+=N.magic,q+=l(x,2),q+=l(A,2),q+=l(st.crc32,4),q+=l(st.compressedSize,4),q+=l(st.uncompressedSize,4),q+=l(U.length,2),q+=l(D.length,2),{fileRecord:g.LOCAL_FILE_HEADER+q+U+D,dirRecord:g.CENTRAL_FILE_HEADER+l(tt,2)+q+l(z.length,2)+"\0\0\0\0"+l(O,4)+l(d,4)+U+D+z}}var n=m("../utils"),a=m("../stream/GenericWorker"),h=m("../utf8"),_=m("../crc32"),g=m("../signature");function y(o,c,i,d){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=c,this.zipPlatform=i,this.encodeFileName=d,this.streamFiles=o,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(y,a),y.prototype.push=function(o){var c=o.meta.percent||0,i=this.entriesCount,d=this._sources.length;this.accumulate?this.contentBuffer.push(o):(this.bytesWritten+=o.data.length,a.prototype.push.call(this,{data:o.data,meta:{currentFile:this.currentFile,percent:i?(c+100*(i-d-1))/i:100}}))},y.prototype.openedSource=function(o){this.currentSourceOffset=this.bytesWritten,this.currentFile=o.file.name;var c=this.streamFiles&&!o.file.dir;if(c){var i=r(o,c,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(o){this.accumulate=!1;var c=this.streamFiles&&!o.file.dir,i=r(o,c,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),c)this.push({data:function(d){return g.DATA_DESCRIPTOR+l(d.crc32,4)+l(d.compressedSize,4)+l(d.uncompressedSize,4)}(o),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var o=this.bytesWritten,c=0;c<this.dirRecords.length;c++)this.push({data:this.dirRecords[c],meta:{percent:100}});var i=this.bytesWritten-o,d=function(u,v,x,A,E){var N=n.transformTo("string",E(A));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(u,2)+l(u,2)+l(v,4)+l(x,4)+l(N.length,2)+N}(this.dirRecords.length,i,o,this.zipComment,this.encodeFileName);this.push({data:d,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(o){this._sources.push(o);var c=this;return o.on("data",function(i){c.processChunk(i)}),o.on("end",function(){c.closedSource(c.previous.streamInfo),c._sources.length?c.prepareNextSource():c.end()}),o.on("error",function(i){c.error(i)}),this},y.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(o){var c=this._sources;if(!a.prototype.error.call(this,o))return!1;for(var i=0;i<c.length;i++)try{c[i].error(o)}catch{}return!0},y.prototype.lock=function(){a.prototype.lock.call(this);for(var o=this._sources,c=0;c<o.length;c++)o[c].lock()},P.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(m,P,w){var l=m("../compressions"),r=m("./ZipFileWorker");w.generateWorker=function(n,a,h){var _=new r(a.streamFiles,h,a.platform,a.encodeFileName),g=0;try{n.forEach(function(y,o){g++;var c=function(v,x){var A=v||x,E=l[A];if(!E)throw new Error(A+" is not a valid compression method !");return E}(o.options.compression,a.compression),i=o.options.compressionOptions||a.compressionOptions||{},d=o.dir,u=o.date;o._compressWorker(c,i).withStreamInfo("file",{name:y,dir:d,date:u,comment:o.comment||"",unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions}).pipe(_)}),_.entriesCount=g}catch(y){_.error(y)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(m,P,w){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new l;for(var n in this)typeof this[n]!="function"&&(r[n]=this[n]);return r}}(l.prototype=m("./object")).loadAsync=m("./load"),l.support=m("./support"),l.defaults=m("./defaults"),l.version="3.10.1",l.loadAsync=function(r,n){return new l().loadAsync(r,n)},l.external=m("./external"),P.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(m,P,w){var l=m("./utils"),r=m("./external"),n=m("./utf8"),a=m("./zipEntries"),h=m("./stream/Crc32Probe"),_=m("./nodejsUtils");function g(y){return new r.Promise(function(o,c){var i=y.decompressed.getContentWorker().pipe(new h);i.on("error",function(d){c(d)}).on("end",function(){i.streamInfo.crc32!==y.decompressed.crc32?c(new Error("Corrupted zip : CRC32 mismatch")):o()}).resume()})}P.exports=function(y,o){var c=this;return o=l.extend(o||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),_.isNode&&_.isStream(y)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",y,!0,o.optimizedBinaryString,o.base64).then(function(i){var d=new a(o);return d.load(i),d}).then(function(i){var d=[r.Promise.resolve(i)],u=i.files;if(o.checkCRC32)for(var v=0;v<u.length;v++)d.push(g(u[v]));return r.Promise.all(d)}).then(function(i){for(var d=i.shift(),u=d.files,v=0;v<u.length;v++){var x=u[v],A=x.fileNameStr,E=l.resolve(x.fileNameStr);c.file(E,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:o.createFolders}),x.dir||(c.file(E).unsafeOriginalName=A)}return d.zipComment.length&&(c.comment=d.zipComment),c})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(m,P,w){var l=m("../utils"),r=m("../stream/GenericWorker");function n(a,h){r.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(h)}l.inherits(n,r),n.prototype._bindStream=function(a){var h=this;(this._stream=a).pause(),a.on("data",function(_){h.push({data:_,meta:{percent:0}})}).on("error",function(_){h.isPaused?this.generatedError=_:h.error(_)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},n.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},P.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(m,P,w){var l=m("readable-stream").Readable;function r(n,a,h){l.call(this,a),this._helper=n;var _=this;n.on("data",function(g,y){_.push(g)||_._helper.pause(),h&&h(y)}).on("error",function(g){_.emit("error",g)}).on("end",function(){_.push(null)})}m("../utils").inherits(r,l),r.prototype._read=function(){this._helper.resume()},P.exports=r},{"../utils":32,"readable-stream":16}],14:[function(m,P,w){P.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,r);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,r)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var r=new Buffer(l);return r.fill(0),r},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(m,P,w){function l(E,N,$){var U,R=n.getTypeOf(N),C=n.extend($||{},_);C.date=C.date||new Date,C.compression!==null&&(C.compression=C.compression.toUpperCase()),typeof C.unixPermissions=="string"&&(C.unixPermissions=parseInt(C.unixPermissions,8)),C.unixPermissions&&16384&C.unixPermissions&&(C.dir=!0),C.dosPermissions&&16&C.dosPermissions&&(C.dir=!0),C.dir&&(E=u(E)),C.createFolders&&(U=d(E))&&v.call(this,U,!0);var z=R==="string"&&C.binary===!1&&C.base64===!1;$&&$.binary!==void 0||(C.binary=!z),(N instanceof g&&N.uncompressedSize===0||C.dir||!N||N.length===0)&&(C.base64=!1,C.binary=!0,N="",C.compression="STORE",R="string");var s=null;s=N instanceof g||N instanceof a?N:c.isNode&&c.isStream(N)?new i(E,N):n.prepareContent(E,N,C.binary,C.optimizedBinaryString,C.base64);var k=new y(E,s,C);this.files[E]=k}var r=m("./utf8"),n=m("./utils"),a=m("./stream/GenericWorker"),h=m("./stream/StreamHelper"),_=m("./defaults"),g=m("./compressedObject"),y=m("./zipObject"),o=m("./generate"),c=m("./nodejsUtils"),i=m("./nodejs/NodejsStreamInputAdapter"),d=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var N=E.lastIndexOf("/");return 0<N?E.substring(0,N):""},u=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},v=function(E,N){return N=N!==void 0?N:_.createFolders,E=u(E),this.files[E]||l.call(this,E,null,{dir:!0,createFolders:N}),this.files[E]};function x(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var A={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var N,$,U;for(N in this.files)U=this.files[N],($=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&E($,U)},filter:function(E){var N=[];return this.forEach(function($,U){E($,U)&&N.push(U)}),N},file:function(E,N,$){if(arguments.length!==1)return E=this.root+E,l.call(this,E,N,$),this;if(x(E)){var U=E;return this.filter(function(C,z){return!z.dir&&U.test(C)})}var R=this.files[this.root+E];return R&&!R.dir?R:null},folder:function(E){if(!E)return this;if(x(E))return this.filter(function(R,C){return C.dir&&E.test(R)});var N=this.root+E,$=v.call(this,N),U=this.clone();return U.root=$.name,U},remove:function(E){E=this.root+E;var N=this.files[E];if(N||(E.slice(-1)!=="/"&&(E+="/"),N=this.files[E]),N&&!N.dir)delete this.files[E];else for(var $=this.filter(function(R,C){return C.name.slice(0,E.length)===E}),U=0;U<$.length;U++)delete this.files[$[U].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var N,$={};try{if(($=n.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=$.type.toLowerCase(),$.compression=$.compression.toUpperCase(),$.type==="binarystring"&&($.type="string"),!$.type)throw new Error("No output type specified.");n.checkSupport($.type),$.platform!=="darwin"&&$.platform!=="freebsd"&&$.platform!=="linux"&&$.platform!=="sunos"||($.platform="UNIX"),$.platform==="win32"&&($.platform="DOS");var U=$.comment||this.comment||"";N=o.generateWorker(this,$,U)}catch(R){(N=new a("error")).error(R)}return new h(N,$.type||"string",$.mimeType)},generateAsync:function(E,N){return this.generateInternalStream(E).accumulate(N)},generateNodeStream:function(E,N){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(N)}};P.exports=A},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(m,P,w){P.exports=m("stream")},{stream:void 0}],17:[function(m,P,w){var l=m("./DataReader");function r(n){l.call(this,n);for(var a=0;a<this.data.length;a++)n[a]=255&n[a]}m("../utils").inherits(r,l),r.prototype.byteAt=function(n){return this.data[this.zero+n]},r.prototype.lastIndexOfSignature=function(n){for(var a=n.charCodeAt(0),h=n.charCodeAt(1),_=n.charCodeAt(2),g=n.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===a&&this.data[y+1]===h&&this.data[y+2]===_&&this.data[y+3]===g)return y-this.zero;return-1},r.prototype.readAndCheckSignature=function(n){var a=n.charCodeAt(0),h=n.charCodeAt(1),_=n.charCodeAt(2),g=n.charCodeAt(3),y=this.readData(4);return a===y[0]&&h===y[1]&&_===y[2]&&g===y[3]},r.prototype.readData=function(n){if(this.checkOffset(n),n===0)return[];var a=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,a},P.exports=r},{"../utils":32,"./DataReader":18}],18:[function(m,P,w){var l=m("../utils");function r(n){this.data=n,this.length=n.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(n){this.checkIndex(this.index+n)},checkIndex:function(n){if(this.length<this.zero+n||n<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+n+"). Corrupted zip ?")},setIndex:function(n){this.checkIndex(n),this.index=n},skip:function(n){this.setIndex(this.index+n)},byteAt:function(){},readInt:function(n){var a,h=0;for(this.checkOffset(n),a=this.index+n-1;a>=this.index;a--)h=(h<<8)+this.byteAt(a);return this.index+=n,h},readString:function(n){return l.transformTo("string",this.readData(n))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var n=this.readInt(4);return new Date(Date.UTC(1980+(n>>25&127),(n>>21&15)-1,n>>16&31,n>>11&31,n>>5&63,(31&n)<<1))}},P.exports=r},{"../utils":32}],19:[function(m,P,w){var l=m("./Uint8ArrayReader");function r(n){l.call(this,n)}m("../utils").inherits(r,l),r.prototype.readData=function(n){this.checkOffset(n);var a=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,a},P.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(m,P,w){var l=m("./DataReader");function r(n){l.call(this,n)}m("../utils").inherits(r,l),r.prototype.byteAt=function(n){return this.data.charCodeAt(this.zero+n)},r.prototype.lastIndexOfSignature=function(n){return this.data.lastIndexOf(n)-this.zero},r.prototype.readAndCheckSignature=function(n){return n===this.readData(4)},r.prototype.readData=function(n){this.checkOffset(n);var a=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,a},P.exports=r},{"../utils":32,"./DataReader":18}],21:[function(m,P,w){var l=m("./ArrayReader");function r(n){l.call(this,n)}m("../utils").inherits(r,l),r.prototype.readData=function(n){if(this.checkOffset(n),n===0)return new Uint8Array(0);var a=this.data.subarray(this.zero+this.index,this.zero+this.index+n);return this.index+=n,a},P.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(m,P,w){var l=m("../utils"),r=m("../support"),n=m("./ArrayReader"),a=m("./StringReader"),h=m("./NodeBufferReader"),_=m("./Uint8ArrayReader");P.exports=function(g){var y=l.getTypeOf(g);return l.checkSupport(y),y!=="string"||r.uint8array?y==="nodebuffer"?new h(g):r.uint8array?new _(l.transformTo("uint8array",g)):new n(l.transformTo("array",g)):new a(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(m,P,w){w.LOCAL_FILE_HEADER="PK",w.CENTRAL_FILE_HEADER="PK",w.CENTRAL_DIRECTORY_END="PK",w.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",w.ZIP64_CENTRAL_DIRECTORY_END="PK",w.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(m,P,w){var l=m("./GenericWorker"),r=m("../utils");function n(a){l.call(this,"ConvertWorker to "+a),this.destType=a}r.inherits(n,l),n.prototype.processChunk=function(a){this.push({data:r.transformTo(this.destType,a.data),meta:a.meta})},P.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(m,P,w){var l=m("./GenericWorker"),r=m("../crc32");function n(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}m("../utils").inherits(n,l),n.prototype.processChunk=function(a){this.streamInfo.crc32=r(a.data,this.streamInfo.crc32||0),this.push(a)},P.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(m,P,w){var l=m("../utils"),r=m("./GenericWorker");function n(a){r.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}l.inherits(n,r),n.prototype.processChunk=function(a){if(a){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+a.data.length}r.prototype.processChunk.call(this,a)},P.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(m,P,w){var l=m("../utils"),r=m("./GenericWorker");function n(a){r.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(_){h.dataIsReady=!0,h.data=_,h.max=_&&_.length||0,h.type=l.getTypeOf(_),h.isPaused||h._tickAndRepeat()},function(_){h.error(_)})}l.inherits(n,r),n.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":a=this.data.substring(this.index,h);break;case"uint8array":a=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":a=this.data.slice(this.index,h)}return this.index=h,this.push({data:a,meta:{percent:this.max?this.index/this.max*100:0}})},P.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(m,P,w){function l(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,n){return this._listeners[r].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,n){if(this._listeners[r])for(var a=0;a<this._listeners[r].length;a++)this._listeners[r][a].call(this,n)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var n=this;return r.on("data",function(a){n.processChunk(a)}),r.on("end",function(){n.end()}),r.on("error",function(a){n.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var r=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,n){return this.extraStreamInfo[r]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},P.exports=l},{}],29:[function(m,P,w){var l=m("../utils"),r=m("./ConvertWorker"),n=m("./GenericWorker"),a=m("../base64"),h=m("../support"),_=m("../external"),g=null;if(h.nodestream)try{g=m("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(c,i){return new _.Promise(function(d,u){var v=[],x=c._internalType,A=c._outputType,E=c._mimeType;c.on("data",function(N,$){v.push(N),i&&i($)}).on("error",function(N){v=[],u(N)}).on("end",function(){try{var N=function($,U,R){switch($){case"blob":return l.newBlob(l.transformTo("arraybuffer",U),R);case"base64":return a.encode(U);default:return l.transformTo($,U)}}(A,function($,U){var R,C=0,z=null,s=0;for(R=0;R<U.length;R++)s+=U[R].length;switch($){case"string":return U.join("");case"array":return Array.prototype.concat.apply([],U);case"uint8array":for(z=new Uint8Array(s),R=0;R<U.length;R++)z.set(U[R],C),C+=U[R].length;return z;case"nodebuffer":return Buffer.concat(U);default:throw new Error("concat : unsupported type '"+$+"'")}}(x,v),E);d(N)}catch($){u($)}v=[]}).resume()})}function o(c,i,d){var u=i;switch(i){case"blob":case"arraybuffer":u="uint8array";break;case"base64":u="string"}try{this._internalType=u,this._outputType=i,this._mimeType=d,l.checkSupport(u),this._worker=c.pipe(new r(u)),c.lock()}catch(v){this._worker=new n("error"),this._worker.error(v)}}o.prototype={accumulate:function(c){return y(this,c)},on:function(c,i){var d=this;return c==="data"?this._worker.on(c,function(u){i.call(d,u.data,u.meta)}):this._worker.on(c,function(){l.delay(i,arguments,d)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(c){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},c)}},P.exports=o},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(m,P,w){if(w.base64=!0,w.array=!0,w.string=!0,w.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",w.nodebuffer=typeof Buffer<"u",w.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")w.blob=!1;else{var l=new ArrayBuffer(0);try{w.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(l),w.blob=r.getBlob("application/zip").size===0}catch{w.blob=!1}}}try{w.nodestream=!!m("readable-stream").Readable}catch{w.nodestream=!1}},{"readable-stream":16}],31:[function(m,P,w){for(var l=m("./utils"),r=m("./support"),n=m("./nodejsUtils"),a=m("./stream/GenericWorker"),h=new Array(256),_=0;_<256;_++)h[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;h[254]=h[254]=1;function g(){a.call(this,"utf-8 decode"),this.leftOver=null}function y(){a.call(this,"utf-8 encode")}w.utf8encode=function(o){return r.nodebuffer?n.newBufferFrom(o,"utf-8"):function(c){var i,d,u,v,x,A=c.length,E=0;for(v=0;v<A;v++)(64512&(d=c.charCodeAt(v)))==55296&&v+1<A&&(64512&(u=c.charCodeAt(v+1)))==56320&&(d=65536+(d-55296<<10)+(u-56320),v++),E+=d<128?1:d<2048?2:d<65536?3:4;for(i=r.uint8array?new Uint8Array(E):new Array(E),v=x=0;x<E;v++)(64512&(d=c.charCodeAt(v)))==55296&&v+1<A&&(64512&(u=c.charCodeAt(v+1)))==56320&&(d=65536+(d-55296<<10)+(u-56320),v++),d<128?i[x++]=d:(d<2048?i[x++]=192|d>>>6:(d<65536?i[x++]=224|d>>>12:(i[x++]=240|d>>>18,i[x++]=128|d>>>12&63),i[x++]=128|d>>>6&63),i[x++]=128|63&d);return i}(o)},w.utf8decode=function(o){return r.nodebuffer?l.transformTo("nodebuffer",o).toString("utf-8"):function(c){var i,d,u,v,x=c.length,A=new Array(2*x);for(i=d=0;i<x;)if((u=c[i++])<128)A[d++]=u;else if(4<(v=h[u]))A[d++]=65533,i+=v-1;else{for(u&=v===2?31:v===3?15:7;1<v&&i<x;)u=u<<6|63&c[i++],v--;1<v?A[d++]=65533:u<65536?A[d++]=u:(u-=65536,A[d++]=55296|u>>10&1023,A[d++]=56320|1023&u)}return A.length!==d&&(A.subarray?A=A.subarray(0,d):A.length=d),l.applyFromCharCode(A)}(o=l.transformTo(r.uint8array?"uint8array":"array",o))},l.inherits(g,a),g.prototype.processChunk=function(o){var c=l.transformTo(r.uint8array?"uint8array":"array",o.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var i=c;(c=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),c.set(i,this.leftOver.length)}else c=this.leftOver.concat(c);this.leftOver=null}var d=function(v,x){var A;for((x=x||v.length)>v.length&&(x=v.length),A=x-1;0<=A&&(192&v[A])==128;)A--;return A<0||A===0?x:A+h[v[A]]>x?A:x}(c),u=c;d!==c.length&&(r.uint8array?(u=c.subarray(0,d),this.leftOver=c.subarray(d,c.length)):(u=c.slice(0,d),this.leftOver=c.slice(d,c.length))),this.push({data:w.utf8decode(u),meta:o.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:w.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},w.Utf8DecodeWorker=g,l.inherits(y,a),y.prototype.processChunk=function(o){this.push({data:w.utf8encode(o.data),meta:o.meta})},w.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(m,P,w){var l=m("./support"),r=m("./base64"),n=m("./nodejsUtils"),a=m("./external");function h(i){return i}function _(i,d){for(var u=0;u<i.length;++u)d[u]=255&i.charCodeAt(u);return d}m("setimmediate"),w.newBlob=function(i,d){w.checkSupport("blob");try{return new Blob([i],{type:d})}catch{try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return u.append(i),u.getBlob(d)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(i,d,u){var v=[],x=0,A=i.length;if(A<=u)return String.fromCharCode.apply(null,i);for(;x<A;)d==="array"||d==="nodebuffer"?v.push(String.fromCharCode.apply(null,i.slice(x,Math.min(x+u,A)))):v.push(String.fromCharCode.apply(null,i.subarray(x,Math.min(x+u,A)))),x+=u;return v.join("")},stringifyByChar:function(i){for(var d="",u=0;u<i.length;u++)d+=String.fromCharCode(i[u]);return d},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,n.allocBuffer(1)).length===1}catch{return!1}}()}};function y(i){var d=65536,u=w.getTypeOf(i),v=!0;if(u==="uint8array"?v=g.applyCanBeUsed.uint8array:u==="nodebuffer"&&(v=g.applyCanBeUsed.nodebuffer),v)for(;1<d;)try{return g.stringifyByChunk(i,u,d)}catch{d=Math.floor(d/2)}return g.stringifyByChar(i)}function o(i,d){for(var u=0;u<i.length;u++)d[u]=i[u];return d}w.applyFromCharCode=y;var c={};c.string={string:h,array:function(i){return _(i,new Array(i.length))},arraybuffer:function(i){return c.string.uint8array(i).buffer},uint8array:function(i){return _(i,new Uint8Array(i.length))},nodebuffer:function(i){return _(i,n.allocBuffer(i.length))}},c.array={string:y,array:h,arraybuffer:function(i){return new Uint8Array(i).buffer},uint8array:function(i){return new Uint8Array(i)},nodebuffer:function(i){return n.newBufferFrom(i)}},c.arraybuffer={string:function(i){return y(new Uint8Array(i))},array:function(i){return o(new Uint8Array(i),new Array(i.byteLength))},arraybuffer:h,uint8array:function(i){return new Uint8Array(i)},nodebuffer:function(i){return n.newBufferFrom(new Uint8Array(i))}},c.uint8array={string:y,array:function(i){return o(i,new Array(i.length))},arraybuffer:function(i){return i.buffer},uint8array:h,nodebuffer:function(i){return n.newBufferFrom(i)}},c.nodebuffer={string:y,array:function(i){return o(i,new Array(i.length))},arraybuffer:function(i){return c.nodebuffer.uint8array(i).buffer},uint8array:function(i){return o(i,new Uint8Array(i.length))},nodebuffer:h},w.transformTo=function(i,d){if(d=d||"",!i)return d;w.checkSupport(i);var u=w.getTypeOf(d);return c[u][i](d)},w.resolve=function(i){for(var d=i.split("/"),u=[],v=0;v<d.length;v++){var x=d[v];x==="."||x===""&&v!==0&&v!==d.length-1||(x===".."?u.pop():u.push(x))}return u.join("/")},w.getTypeOf=function(i){return typeof i=="string"?"string":Object.prototype.toString.call(i)==="[object Array]"?"array":l.nodebuffer&&n.isBuffer(i)?"nodebuffer":l.uint8array&&i instanceof Uint8Array?"uint8array":l.arraybuffer&&i instanceof ArrayBuffer?"arraybuffer":void 0},w.checkSupport=function(i){if(!l[i.toLowerCase()])throw new Error(i+" is not supported by this platform")},w.MAX_VALUE_16BITS=65535,w.MAX_VALUE_32BITS=-1,w.pretty=function(i){var d,u,v="";for(u=0;u<(i||"").length;u++)v+="\\x"+((d=i.charCodeAt(u))<16?"0":"")+d.toString(16).toUpperCase();return v},w.delay=function(i,d,u){setImmediate(function(){i.apply(u||null,d||[])})},w.inherits=function(i,d){function u(){}u.prototype=d.prototype,i.prototype=new u},w.extend=function(){var i,d,u={};for(i=0;i<arguments.length;i++)for(d in arguments[i])Object.prototype.hasOwnProperty.call(arguments[i],d)&&u[d]===void 0&&(u[d]=arguments[i][d]);return u},w.prepareContent=function(i,d,u,v,x){return a.Promise.resolve(d).then(function(A){return l.blob&&(A instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(A))!==-1)&&typeof FileReader<"u"?new a.Promise(function(E,N){var $=new FileReader;$.onload=function(U){E(U.target.result)},$.onerror=function(U){N(U.target.error)},$.readAsArrayBuffer(A)}):A}).then(function(A){var E=w.getTypeOf(A);return E?(E==="arraybuffer"?A=w.transformTo("uint8array",A):E==="string"&&(x?A=r.decode(A):u&&v!==!0&&(A=function(N){return _(N,l.uint8array?new Uint8Array(N.length):new Array(N.length))}(A))),A):a.Promise.reject(new Error("Can't read the data of '"+i+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(m,P,w){var l=m("./reader/readerFor"),r=m("./utils"),n=m("./signature"),a=m("./zipEntry"),h=m("./support");function _(g){this.files=[],this.loadOptions=g}_.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(y)+", expected "+r.pretty(g)+")")}},isSignature:function(g,y){var o=this.reader.index;this.reader.setIndex(g);var c=this.reader.readString(4)===y;return this.reader.setIndex(o),c},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),y=h.uint8array?"uint8array":"array",o=r.transformTo(y,g);this.zipComment=this.loadOptions.decodeFileName(o)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,y,o,c=this.zip64EndOfCentralSize-44;0<c;)g=this.reader.readInt(2),y=this.reader.readInt(4),o=this.reader.readData(y),this.zip64ExtensibleData[g]={id:g,length:y,value:o}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,y;for(g=0;g<this.files.length;g++)y=this.files[g],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(g=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var y=g;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var o=this.centralDirOffset+this.centralDirSize;this.zip64&&(o+=20,o+=12+this.zip64EndOfCentralSize);var c=y-o;if(0<c)this.isSignature(y,n.CENTRAL_FILE_HEADER)||(this.reader.zero=c);else if(c<0)throw new Error("Corrupted zip: missing "+Math.abs(c)+" bytes.")},prepareReader:function(g){this.reader=l(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},P.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(m,P,w){var l=m("./reader/readerFor"),r=m("./utils"),n=m("./compressedObject"),a=m("./crc32"),h=m("./utf8"),_=m("./compressions"),g=m("./support");function y(o,c){this.options=o,this.loadOptions=c}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(o){var c,i;if(o.skip(22),this.fileNameLength=o.readInt(2),i=o.readInt(2),this.fileName=o.readData(this.fileNameLength),o.skip(i),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((c=function(d){for(var u in _)if(Object.prototype.hasOwnProperty.call(_,u)&&_[u].magic===d)return _[u];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,c,o.readData(this.compressedSize))},readCentralPart:function(o){this.versionMadeBy=o.readInt(2),o.skip(2),this.bitFlag=o.readInt(2),this.compressionMethod=o.readString(2),this.date=o.readDate(),this.crc32=o.readInt(4),this.compressedSize=o.readInt(4),this.uncompressedSize=o.readInt(4);var c=o.readInt(2);if(this.extraFieldsLength=o.readInt(2),this.fileCommentLength=o.readInt(2),this.diskNumberStart=o.readInt(2),this.internalFileAttributes=o.readInt(2),this.externalFileAttributes=o.readInt(4),this.localHeaderOffset=o.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");o.skip(c),this.readExtraFields(o),this.parseZIP64ExtraField(o),this.fileComment=o.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var o=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),o==0&&(this.dosPermissions=63&this.externalFileAttributes),o==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var o=l(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=o.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=o.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=o.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=o.readInt(4))}},readExtraFields:function(o){var c,i,d,u=o.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});o.index+4<u;)c=o.readInt(2),i=o.readInt(2),d=o.readData(i),this.extraFields[c]={id:c,length:i,value:d};o.setIndex(u)},handleUTF8:function(){var o=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var c=this.findExtraFieldUnicodePath();if(c!==null)this.fileNameStr=c;else{var i=r.transformTo(o,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var d=this.findExtraFieldUnicodeComment();if(d!==null)this.fileCommentStr=d;else{var u=r.transformTo(o,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(u)}}},findExtraFieldUnicodePath:function(){var o=this.extraFields[28789];if(o){var c=l(o.value);return c.readInt(1)!==1||a(this.fileName)!==c.readInt(4)?null:h.utf8decode(c.readData(o.length-5))}return null},findExtraFieldUnicodeComment:function(){var o=this.extraFields[25461];if(o){var c=l(o.value);return c.readInt(1)!==1||a(this.fileComment)!==c.readInt(4)?null:h.utf8decode(c.readData(o.length-5))}return null}},P.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(m,P,w){function l(c,i,d){this.name=c,this.dir=d.dir,this.date=d.date,this.comment=d.comment,this.unixPermissions=d.unixPermissions,this.dosPermissions=d.dosPermissions,this._data=i,this._dataBinary=d.binary,this.options={compression:d.compression,compressionOptions:d.compressionOptions}}var r=m("./stream/StreamHelper"),n=m("./stream/DataWorker"),a=m("./utf8"),h=m("./compressedObject"),_=m("./stream/GenericWorker");l.prototype={internalStream:function(c){var i=null,d="string";try{if(!c)throw new Error("No output type specified.");var u=(d=c.toLowerCase())==="string"||d==="text";d!=="binarystring"&&d!=="text"||(d="string"),i=this._decompressWorker();var v=!this._dataBinary;v&&!u&&(i=i.pipe(new a.Utf8EncodeWorker)),!v&&u&&(i=i.pipe(new a.Utf8DecodeWorker))}catch(x){(i=new _("error")).error(x)}return new r(i,d,"")},async:function(c,i){return this.internalStream(c).accumulate(i)},nodeStream:function(c,i){return this.internalStream(c||"nodebuffer").toNodejsStream(i)},_compressWorker:function(c,i){if(this._data instanceof h&&this._data.compression.magic===c.magic)return this._data.getCompressedWorker();var d=this._decompressWorker();return this._dataBinary||(d=d.pipe(new a.Utf8EncodeWorker)),h.createWorkerFrom(d,c,i)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof _?this._data:new n(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},o=0;o<g.length;o++)l.prototype[g[o]]=y;P.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(m,P,w){(function(l){var r,n,a=l.MutationObserver||l.WebKitMutationObserver;if(a){var h=0,_=new a(c),g=l.document.createTextNode("");_.observe(g,{characterData:!0}),r=function(){g.data=h=++h%2}}else if(l.setImmediate||l.MessageChannel===void 0)r="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var i=l.document.createElement("script");i.onreadystatechange=function(){c(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},l.document.documentElement.appendChild(i)}:function(){setTimeout(c,0)};else{var y=new l.MessageChannel;y.port1.onmessage=c,r=function(){y.port2.postMessage(0)}}var o=[];function c(){var i,d;n=!0;for(var u=o.length;u;){for(d=o,o=[],i=-1;++i<u;)d[i]();u=o.length}n=!1}P.exports=function(i){o.push(i)!==1||n||r()}}).call(this,typeof Ft<"u"?Ft:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(m,P,w){var l=m("immediate");function r(){}var n={},a=["REJECTED"],h=["FULFILLED"],_=["PENDING"];function g(u){if(typeof u!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,u!==r&&i(this,u)}function y(u,v,x){this.promise=u,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function o(u,v,x){l(function(){var A;try{A=v(x)}catch(E){return n.reject(u,E)}A===u?n.reject(u,new TypeError("Cannot resolve promise with itself")):n.resolve(u,A)})}function c(u){var v=u&&u.then;if(u&&(typeof u=="object"||typeof u=="function")&&typeof v=="function")return function(){v.apply(u,arguments)}}function i(u,v){var x=!1;function A($){x||(x=!0,n.reject(u,$))}function E($){x||(x=!0,n.resolve(u,$))}var N=d(function(){v(E,A)});N.status==="error"&&A(N.value)}function d(u,v){var x={};try{x.value=u(v),x.status="success"}catch(A){x.status="error",x.value=A}return x}(P.exports=g).prototype.finally=function(u){if(typeof u!="function")return this;var v=this.constructor;return this.then(function(x){return v.resolve(u()).then(function(){return x})},function(x){return v.resolve(u()).then(function(){throw x})})},g.prototype.catch=function(u){return this.then(null,u)},g.prototype.then=function(u,v){if(typeof u!="function"&&this.state===h||typeof v!="function"&&this.state===a)return this;var x=new this.constructor(r);return this.state!==_?o(x,this.state===h?u:v,this.outcome):this.queue.push(new y(x,u,v)),x},y.prototype.callFulfilled=function(u){n.resolve(this.promise,u)},y.prototype.otherCallFulfilled=function(u){o(this.promise,this.onFulfilled,u)},y.prototype.callRejected=function(u){n.reject(this.promise,u)},y.prototype.otherCallRejected=function(u){o(this.promise,this.onRejected,u)},n.resolve=function(u,v){var x=d(c,v);if(x.status==="error")return n.reject(u,x.value);var A=x.value;if(A)i(u,A);else{u.state=h,u.outcome=v;for(var E=-1,N=u.queue.length;++E<N;)u.queue[E].callFulfilled(v)}return u},n.reject=function(u,v){u.state=a,u.outcome=v;for(var x=-1,A=u.queue.length;++x<A;)u.queue[x].callRejected(v);return u},g.resolve=function(u){return u instanceof this?u:n.resolve(new this(r),u)},g.reject=function(u){var v=new this(r);return n.reject(v,u)},g.all=function(u){var v=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=u.length,A=!1;if(!x)return this.resolve([]);for(var E=new Array(x),N=0,$=-1,U=new this(r);++$<x;)R(u[$],$);return U;function R(C,z){v.resolve(C).then(function(s){E[z]=s,++N!==x||A||(A=!0,n.resolve(U,E))},function(s){A||(A=!0,n.reject(U,s))})}},g.race=function(u){var v=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=u.length,A=!1;if(!x)return this.resolve([]);for(var E=-1,N=new this(r);++E<x;)$=u[E],v.resolve($).then(function(U){A||(A=!0,n.resolve(N,U))},function(U){A||(A=!0,n.reject(N,U))});var $;return N}},{immediate:36}],38:[function(m,P,w){var l={};(0,m("./lib/utils/common").assign)(l,m("./lib/deflate"),m("./lib/inflate"),m("./lib/zlib/constants")),P.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(m,P,w){var l=m("./zlib/deflate"),r=m("./utils/common"),n=m("./utils/strings"),a=m("./zlib/messages"),h=m("./zlib/zstream"),_=Object.prototype.toString,g=0,y=-1,o=0,c=8;function i(u){if(!(this instanceof i))return new i(u);this.options=r.assign({level:y,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:o,to:""},u||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var x=l.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(x!==g)throw new Error(a[x]);if(v.header&&l.deflateSetHeader(this.strm,v.header),v.dictionary){var A;if(A=typeof v.dictionary=="string"?n.string2buf(v.dictionary):_.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(x=l.deflateSetDictionary(this.strm,A))!==g)throw new Error(a[x]);this._dict_set=!0}}function d(u,v){var x=new i(v);if(x.push(u,!0),x.err)throw x.msg||a[x.err];return x.result}i.prototype.push=function(u,v){var x,A,E=this.strm,N=this.options.chunkSize;if(this.ended)return!1;A=v===~~v?v:v===!0?4:0,typeof u=="string"?E.input=n.string2buf(u):_.call(u)==="[object ArrayBuffer]"?E.input=new Uint8Array(u):E.input=u,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new r.Buf8(N),E.next_out=0,E.avail_out=N),(x=l.deflate(E,A))!==1&&x!==g)return this.onEnd(x),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||A!==4&&A!==2)||(this.options.to==="string"?this.onData(n.buf2binstring(r.shrinkBuf(E.output,E.next_out))):this.onData(r.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&x!==1);return A===4?(x=l.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===g):A!==2||(this.onEnd(g),!(E.avail_out=0))},i.prototype.onData=function(u){this.chunks.push(u)},i.prototype.onEnd=function(u){u===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},w.Deflate=i,w.deflate=d,w.deflateRaw=function(u,v){return(v=v||{}).raw=!0,d(u,v)},w.gzip=function(u,v){return(v=v||{}).gzip=!0,d(u,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(m,P,w){var l=m("./zlib/inflate"),r=m("./utils/common"),n=m("./utils/strings"),a=m("./zlib/constants"),h=m("./zlib/messages"),_=m("./zlib/zstream"),g=m("./zlib/gzheader"),y=Object.prototype.toString;function o(i){if(!(this instanceof o))return new o(i);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},i||{});var d=this.options;d.raw&&0<=d.windowBits&&d.windowBits<16&&(d.windowBits=-d.windowBits,d.windowBits===0&&(d.windowBits=-15)),!(0<=d.windowBits&&d.windowBits<16)||i&&i.windowBits||(d.windowBits+=32),15<d.windowBits&&d.windowBits<48&&!(15&d.windowBits)&&(d.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var u=l.inflateInit2(this.strm,d.windowBits);if(u!==a.Z_OK)throw new Error(h[u]);this.header=new g,l.inflateGetHeader(this.strm,this.header)}function c(i,d){var u=new o(d);if(u.push(i,!0),u.err)throw u.msg||h[u.err];return u.result}o.prototype.push=function(i,d){var u,v,x,A,E,N,$=this.strm,U=this.options.chunkSize,R=this.options.dictionary,C=!1;if(this.ended)return!1;v=d===~~d?d:d===!0?a.Z_FINISH:a.Z_NO_FLUSH,typeof i=="string"?$.input=n.binstring2buf(i):y.call(i)==="[object ArrayBuffer]"?$.input=new Uint8Array(i):$.input=i,$.next_in=0,$.avail_in=$.input.length;do{if($.avail_out===0&&($.output=new r.Buf8(U),$.next_out=0,$.avail_out=U),(u=l.inflate($,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&R&&(N=typeof R=="string"?n.string2buf(R):y.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,u=l.inflateSetDictionary(this.strm,N)),u===a.Z_BUF_ERROR&&C===!0&&(u=a.Z_OK,C=!1),u!==a.Z_STREAM_END&&u!==a.Z_OK)return this.onEnd(u),!(this.ended=!0);$.next_out&&($.avail_out!==0&&u!==a.Z_STREAM_END&&($.avail_in!==0||v!==a.Z_FINISH&&v!==a.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=n.utf8border($.output,$.next_out),A=$.next_out-x,E=n.buf2string($.output,x),$.next_out=A,$.avail_out=U-A,A&&r.arraySet($.output,$.output,x,A,0),this.onData(E)):this.onData(r.shrinkBuf($.output,$.next_out)))),$.avail_in===0&&$.avail_out===0&&(C=!0)}while((0<$.avail_in||$.avail_out===0)&&u!==a.Z_STREAM_END);return u===a.Z_STREAM_END&&(v=a.Z_FINISH),v===a.Z_FINISH?(u=l.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===a.Z_OK):v!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!($.avail_out=0))},o.prototype.onData=function(i){this.chunks.push(i)},o.prototype.onEnd=function(i){i===a.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg},w.Inflate=o,w.inflate=c,w.inflateRaw=function(i,d){return(d=d||{}).raw=!0,c(i,d)},w.ungzip=c},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(m,P,w){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";w.assign=function(a){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var _=h.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var g in _)_.hasOwnProperty(g)&&(a[g]=_[g])}}return a},w.shrinkBuf=function(a,h){return a.length===h?a:a.subarray?a.subarray(0,h):(a.length=h,a)};var r={arraySet:function(a,h,_,g,y){if(h.subarray&&a.subarray)a.set(h.subarray(_,_+g),y);else for(var o=0;o<g;o++)a[y+o]=h[_+o]},flattenChunks:function(a){var h,_,g,y,o,c;for(h=g=0,_=a.length;h<_;h++)g+=a[h].length;for(c=new Uint8Array(g),h=y=0,_=a.length;h<_;h++)o=a[h],c.set(o,y),y+=o.length;return c}},n={arraySet:function(a,h,_,g,y){for(var o=0;o<g;o++)a[y+o]=h[_+o]},flattenChunks:function(a){return[].concat.apply([],a)}};w.setTyped=function(a){a?(w.Buf8=Uint8Array,w.Buf16=Uint16Array,w.Buf32=Int32Array,w.assign(w,r)):(w.Buf8=Array,w.Buf16=Array,w.Buf32=Array,w.assign(w,n))},w.setTyped(l)},{}],42:[function(m,P,w){var l=m("./common"),r=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var a=new l.Buf8(256),h=0;h<256;h++)a[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function _(g,y){if(y<65537&&(g.subarray&&n||!g.subarray&&r))return String.fromCharCode.apply(null,l.shrinkBuf(g,y));for(var o="",c=0;c<y;c++)o+=String.fromCharCode(g[c]);return o}a[254]=a[254]=1,w.string2buf=function(g){var y,o,c,i,d,u=g.length,v=0;for(i=0;i<u;i++)(64512&(o=g.charCodeAt(i)))==55296&&i+1<u&&(64512&(c=g.charCodeAt(i+1)))==56320&&(o=65536+(o-55296<<10)+(c-56320),i++),v+=o<128?1:o<2048?2:o<65536?3:4;for(y=new l.Buf8(v),i=d=0;d<v;i++)(64512&(o=g.charCodeAt(i)))==55296&&i+1<u&&(64512&(c=g.charCodeAt(i+1)))==56320&&(o=65536+(o-55296<<10)+(c-56320),i++),o<128?y[d++]=o:(o<2048?y[d++]=192|o>>>6:(o<65536?y[d++]=224|o>>>12:(y[d++]=240|o>>>18,y[d++]=128|o>>>12&63),y[d++]=128|o>>>6&63),y[d++]=128|63&o);return y},w.buf2binstring=function(g){return _(g,g.length)},w.binstring2buf=function(g){for(var y=new l.Buf8(g.length),o=0,c=y.length;o<c;o++)y[o]=g.charCodeAt(o);return y},w.buf2string=function(g,y){var o,c,i,d,u=y||g.length,v=new Array(2*u);for(o=c=0;o<u;)if((i=g[o++])<128)v[c++]=i;else if(4<(d=a[i]))v[c++]=65533,o+=d-1;else{for(i&=d===2?31:d===3?15:7;1<d&&o<u;)i=i<<6|63&g[o++],d--;1<d?v[c++]=65533:i<65536?v[c++]=i:(i-=65536,v[c++]=55296|i>>10&1023,v[c++]=56320|1023&i)}return _(v,c)},w.utf8border=function(g,y){var o;for((y=y||g.length)>g.length&&(y=g.length),o=y-1;0<=o&&(192&g[o])==128;)o--;return o<0||o===0?y:o+a[g[o]]>y?o:y}},{"./common":41}],43:[function(m,P,w){P.exports=function(l,r,n,a){for(var h=65535&l|0,_=l>>>16&65535|0,g=0;n!==0;){for(n-=g=2e3<n?2e3:n;_=_+(h=h+r[a++]|0)|0,--g;);h%=65521,_%=65521}return h|_<<16|0}},{}],44:[function(m,P,w){P.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(m,P,w){var l=function(){for(var r,n=[],a=0;a<256;a++){r=a;for(var h=0;h<8;h++)r=1&r?3988292384^r>>>1:r>>>1;n[a]=r}return n}();P.exports=function(r,n,a,h){var _=l,g=h+a;r^=-1;for(var y=h;y<g;y++)r=r>>>8^_[255&(r^n[y])];return-1^r}},{}],46:[function(m,P,w){var l,r=m("../utils/common"),n=m("./trees"),a=m("./adler32"),h=m("./crc32"),_=m("./messages"),g=0,y=4,o=0,c=-2,i=-1,d=4,u=2,v=8,x=9,A=286,E=30,N=19,$=2*A+1,U=15,R=3,C=258,z=C+R+1,s=42,k=113,e=1,D=2,X=3,M=4;function et(t,F){return t.msg=_[F],F}function V(t){return(t<<1)-(4<t?9:0)}function st(t){for(var F=t.length;0<=--F;)t[F]=0}function T(t){var F=t.state,B=F.pending;B>t.avail_out&&(B=t.avail_out),B!==0&&(r.arraySet(t.output,F.pending_buf,F.pending_out,B,t.next_out),t.next_out+=B,F.pending_out+=B,t.total_out+=B,t.avail_out-=B,F.pending-=B,F.pending===0&&(F.pending_out=0))}function O(t,F){n._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,F),t.block_start=t.strstart,T(t.strm)}function tt(t,F){t.pending_buf[t.pending++]=F}function q(t,F){t.pending_buf[t.pending++]=F>>>8&255,t.pending_buf[t.pending++]=255&F}function H(t,F){var B,p,f=t.max_chain_length,S=t.strstart,j=t.prev_length,L=t.nice_match,I=t.strstart>t.w_size-z?t.strstart-(t.w_size-z):0,Z=t.window,G=t.w_mask,W=t.prev,Q=t.strstart+C,lt=Z[S+j-1],rt=Z[S+j];t.prev_length>=t.good_match&&(f>>=2),L>t.lookahead&&(L=t.lookahead);do if(Z[(B=F)+j]===rt&&Z[B+j-1]===lt&&Z[B]===Z[S]&&Z[++B]===Z[S+1]){S+=2,B++;do;while(Z[++S]===Z[++B]&&Z[++S]===Z[++B]&&Z[++S]===Z[++B]&&Z[++S]===Z[++B]&&Z[++S]===Z[++B]&&Z[++S]===Z[++B]&&Z[++S]===Z[++B]&&Z[++S]===Z[++B]&&S<Q);if(p=C-(Q-S),S=Q-C,j<p){if(t.match_start=F,L<=(j=p))break;lt=Z[S+j-1],rt=Z[S+j]}}while((F=W[F&G])>I&&--f!=0);return j<=t.lookahead?j:t.lookahead}function ct(t){var F,B,p,f,S,j,L,I,Z,G,W=t.w_size;do{if(f=t.window_size-t.lookahead-t.strstart,t.strstart>=W+(W-z)){for(r.arraySet(t.window,t.window,W,W,0),t.match_start-=W,t.strstart-=W,t.block_start-=W,F=B=t.hash_size;p=t.head[--F],t.head[F]=W<=p?p-W:0,--B;);for(F=B=W;p=t.prev[--F],t.prev[F]=W<=p?p-W:0,--B;);f+=W}if(t.strm.avail_in===0)break;if(j=t.strm,L=t.window,I=t.strstart+t.lookahead,Z=f,G=void 0,G=j.avail_in,Z<G&&(G=Z),B=G===0?0:(j.avail_in-=G,r.arraySet(L,j.input,j.next_in,G,I),j.state.wrap===1?j.adler=a(j.adler,L,G,I):j.state.wrap===2&&(j.adler=h(j.adler,L,G,I)),j.next_in+=G,j.total_in+=G,G),t.lookahead+=B,t.lookahead+t.insert>=R)for(S=t.strstart-t.insert,t.ins_h=t.window[S],t.ins_h=(t.ins_h<<t.hash_shift^t.window[S+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[S+R-1])&t.hash_mask,t.prev[S&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=S,S++,t.insert--,!(t.lookahead+t.insert<R)););}while(t.lookahead<z&&t.strm.avail_in!==0)}function vt(t,F){for(var B,p;;){if(t.lookahead<z){if(ct(t),t.lookahead<z&&F===g)return e;if(t.lookahead===0)break}if(B=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,B=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),B!==0&&t.strstart-B<=t.w_size-z&&(t.match_length=H(t,B)),t.match_length>=R)if(p=n._tr_tally(t,t.strstart-t.match_start,t.match_length-R),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=R){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,B=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else p=n._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(p&&(O(t,!1),t.strm.avail_out===0))return e}return t.insert=t.strstart<R-1?t.strstart:R-1,F===y?(O(t,!0),t.strm.avail_out===0?X:M):t.last_lit&&(O(t,!1),t.strm.avail_out===0)?e:D}function at(t,F){for(var B,p,f;;){if(t.lookahead<z){if(ct(t),t.lookahead<z&&F===g)return e;if(t.lookahead===0)break}if(B=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,B=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=R-1,B!==0&&t.prev_length<t.max_lazy_match&&t.strstart-B<=t.w_size-z&&(t.match_length=H(t,B),t.match_length<=5&&(t.strategy===1||t.match_length===R&&4096<t.strstart-t.match_start)&&(t.match_length=R-1)),t.prev_length>=R&&t.match_length<=t.prev_length){for(f=t.strstart+t.lookahead-R,p=n._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-R),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=f&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,B=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=R-1,t.strstart++,p&&(O(t,!1),t.strm.avail_out===0))return e}else if(t.match_available){if((p=n._tr_tally(t,0,t.window[t.strstart-1]))&&O(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return e}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(p=n._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<R-1?t.strstart:R-1,F===y?(O(t,!0),t.strm.avail_out===0?X:M):t.last_lit&&(O(t,!1),t.strm.avail_out===0)?e:D}function ot(t,F,B,p,f){this.good_length=t,this.max_lazy=F,this.nice_length=B,this.max_chain=p,this.func=f}function gt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*$),this.dyn_dtree=new r.Buf16(2*(2*E+1)),this.bl_tree=new r.Buf16(2*(2*N+1)),st(this.dyn_ltree),st(this.dyn_dtree),st(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(U+1),this.heap=new r.Buf16(2*A+1),st(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*A+1),st(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ft(t){var F;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=u,(F=t.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?s:k,t.adler=F.wrap===2?0:1,F.last_flush=g,n._tr_init(F),o):et(t,c)}function bt(t){var F=ft(t);return F===o&&function(B){B.window_size=2*B.w_size,st(B.head),B.max_lazy_match=l[B.level].max_lazy,B.good_match=l[B.level].good_length,B.nice_match=l[B.level].nice_length,B.max_chain_length=l[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=R-1,B.match_available=0,B.ins_h=0}(t.state),F}function _t(t,F,B,p,f,S){if(!t)return c;var j=1;if(F===i&&(F=6),p<0?(j=0,p=-p):15<p&&(j=2,p-=16),f<1||x<f||B!==v||p<8||15<p||F<0||9<F||S<0||d<S)return et(t,c);p===8&&(p=9);var L=new gt;return(t.state=L).strm=t,L.wrap=j,L.gzhead=null,L.w_bits=p,L.w_size=1<<L.w_bits,L.w_mask=L.w_size-1,L.hash_bits=f+7,L.hash_size=1<<L.hash_bits,L.hash_mask=L.hash_size-1,L.hash_shift=~~((L.hash_bits+R-1)/R),L.window=new r.Buf8(2*L.w_size),L.head=new r.Buf16(L.hash_size),L.prev=new r.Buf16(L.w_size),L.lit_bufsize=1<<f+6,L.pending_buf_size=4*L.lit_bufsize,L.pending_buf=new r.Buf8(L.pending_buf_size),L.d_buf=1*L.lit_bufsize,L.l_buf=3*L.lit_bufsize,L.level=F,L.strategy=S,L.method=B,bt(t)}l=[new ot(0,0,0,0,function(t,F){var B=65535;for(B>t.pending_buf_size-5&&(B=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ct(t),t.lookahead===0&&F===g)return e;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var p=t.block_start+B;if((t.strstart===0||t.strstart>=p)&&(t.lookahead=t.strstart-p,t.strstart=p,O(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-z&&(O(t,!1),t.strm.avail_out===0))return e}return t.insert=0,F===y?(O(t,!0),t.strm.avail_out===0?X:M):(t.strstart>t.block_start&&(O(t,!1),t.strm.avail_out),e)}),new ot(4,4,8,4,vt),new ot(4,5,16,8,vt),new ot(4,6,32,32,vt),new ot(4,4,16,16,at),new ot(8,16,32,32,at),new ot(8,16,128,128,at),new ot(8,32,128,256,at),new ot(32,128,258,1024,at),new ot(32,258,258,4096,at)],w.deflateInit=function(t,F){return _t(t,F,v,15,8,0)},w.deflateInit2=_t,w.deflateReset=bt,w.deflateResetKeep=ft,w.deflateSetHeader=function(t,F){return t&&t.state?t.state.wrap!==2?c:(t.state.gzhead=F,o):c},w.deflate=function(t,F){var B,p,f,S;if(!t||!t.state||5<F||F<0)return t?et(t,c):c;if(p=t.state,!t.output||!t.input&&t.avail_in!==0||p.status===666&&F!==y)return et(t,t.avail_out===0?-5:c);if(p.strm=t,B=p.last_flush,p.last_flush=F,p.status===s)if(p.wrap===2)t.adler=0,tt(p,31),tt(p,139),tt(p,8),p.gzhead?(tt(p,(p.gzhead.text?1:0)+(p.gzhead.hcrc?2:0)+(p.gzhead.extra?4:0)+(p.gzhead.name?8:0)+(p.gzhead.comment?16:0)),tt(p,255&p.gzhead.time),tt(p,p.gzhead.time>>8&255),tt(p,p.gzhead.time>>16&255),tt(p,p.gzhead.time>>24&255),tt(p,p.level===9?2:2<=p.strategy||p.level<2?4:0),tt(p,255&p.gzhead.os),p.gzhead.extra&&p.gzhead.extra.length&&(tt(p,255&p.gzhead.extra.length),tt(p,p.gzhead.extra.length>>8&255)),p.gzhead.hcrc&&(t.adler=h(t.adler,p.pending_buf,p.pending,0)),p.gzindex=0,p.status=69):(tt(p,0),tt(p,0),tt(p,0),tt(p,0),tt(p,0),tt(p,p.level===9?2:2<=p.strategy||p.level<2?4:0),tt(p,3),p.status=k);else{var j=v+(p.w_bits-8<<4)<<8;j|=(2<=p.strategy||p.level<2?0:p.level<6?1:p.level===6?2:3)<<6,p.strstart!==0&&(j|=32),j+=31-j%31,p.status=k,q(p,j),p.strstart!==0&&(q(p,t.adler>>>16),q(p,65535&t.adler)),t.adler=1}if(p.status===69)if(p.gzhead.extra){for(f=p.pending;p.gzindex<(65535&p.gzhead.extra.length)&&(p.pending!==p.pending_buf_size||(p.gzhead.hcrc&&p.pending>f&&(t.adler=h(t.adler,p.pending_buf,p.pending-f,f)),T(t),f=p.pending,p.pending!==p.pending_buf_size));)tt(p,255&p.gzhead.extra[p.gzindex]),p.gzindex++;p.gzhead.hcrc&&p.pending>f&&(t.adler=h(t.adler,p.pending_buf,p.pending-f,f)),p.gzindex===p.gzhead.extra.length&&(p.gzindex=0,p.status=73)}else p.status=73;if(p.status===73)if(p.gzhead.name){f=p.pending;do{if(p.pending===p.pending_buf_size&&(p.gzhead.hcrc&&p.pending>f&&(t.adler=h(t.adler,p.pending_buf,p.pending-f,f)),T(t),f=p.pending,p.pending===p.pending_buf_size)){S=1;break}S=p.gzindex<p.gzhead.name.length?255&p.gzhead.name.charCodeAt(p.gzindex++):0,tt(p,S)}while(S!==0);p.gzhead.hcrc&&p.pending>f&&(t.adler=h(t.adler,p.pending_buf,p.pending-f,f)),S===0&&(p.gzindex=0,p.status=91)}else p.status=91;if(p.status===91)if(p.gzhead.comment){f=p.pending;do{if(p.pending===p.pending_buf_size&&(p.gzhead.hcrc&&p.pending>f&&(t.adler=h(t.adler,p.pending_buf,p.pending-f,f)),T(t),f=p.pending,p.pending===p.pending_buf_size)){S=1;break}S=p.gzindex<p.gzhead.comment.length?255&p.gzhead.comment.charCodeAt(p.gzindex++):0,tt(p,S)}while(S!==0);p.gzhead.hcrc&&p.pending>f&&(t.adler=h(t.adler,p.pending_buf,p.pending-f,f)),S===0&&(p.status=103)}else p.status=103;if(p.status===103&&(p.gzhead.hcrc?(p.pending+2>p.pending_buf_size&&T(t),p.pending+2<=p.pending_buf_size&&(tt(p,255&t.adler),tt(p,t.adler>>8&255),t.adler=0,p.status=k)):p.status=k),p.pending!==0){if(T(t),t.avail_out===0)return p.last_flush=-1,o}else if(t.avail_in===0&&V(F)<=V(B)&&F!==y)return et(t,-5);if(p.status===666&&t.avail_in!==0)return et(t,-5);if(t.avail_in!==0||p.lookahead!==0||F!==g&&p.status!==666){var L=p.strategy===2?function(I,Z){for(var G;;){if(I.lookahead===0&&(ct(I),I.lookahead===0)){if(Z===g)return e;break}if(I.match_length=0,G=n._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,G&&(O(I,!1),I.strm.avail_out===0))return e}return I.insert=0,Z===y?(O(I,!0),I.strm.avail_out===0?X:M):I.last_lit&&(O(I,!1),I.strm.avail_out===0)?e:D}(p,F):p.strategy===3?function(I,Z){for(var G,W,Q,lt,rt=I.window;;){if(I.lookahead<=C){if(ct(I),I.lookahead<=C&&Z===g)return e;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=R&&0<I.strstart&&(W=rt[Q=I.strstart-1])===rt[++Q]&&W===rt[++Q]&&W===rt[++Q]){lt=I.strstart+C;do;while(W===rt[++Q]&&W===rt[++Q]&&W===rt[++Q]&&W===rt[++Q]&&W===rt[++Q]&&W===rt[++Q]&&W===rt[++Q]&&W===rt[++Q]&&Q<lt);I.match_length=C-(lt-Q),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=R?(G=n._tr_tally(I,1,I.match_length-R),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(G=n._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),G&&(O(I,!1),I.strm.avail_out===0))return e}return I.insert=0,Z===y?(O(I,!0),I.strm.avail_out===0?X:M):I.last_lit&&(O(I,!1),I.strm.avail_out===0)?e:D}(p,F):l[p.level].func(p,F);if(L!==X&&L!==M||(p.status=666),L===e||L===X)return t.avail_out===0&&(p.last_flush=-1),o;if(L===D&&(F===1?n._tr_align(p):F!==5&&(n._tr_stored_block(p,0,0,!1),F===3&&(st(p.head),p.lookahead===0&&(p.strstart=0,p.block_start=0,p.insert=0))),T(t),t.avail_out===0))return p.last_flush=-1,o}return F!==y?o:p.wrap<=0?1:(p.wrap===2?(tt(p,255&t.adler),tt(p,t.adler>>8&255),tt(p,t.adler>>16&255),tt(p,t.adler>>24&255),tt(p,255&t.total_in),tt(p,t.total_in>>8&255),tt(p,t.total_in>>16&255),tt(p,t.total_in>>24&255)):(q(p,t.adler>>>16),q(p,65535&t.adler)),T(t),0<p.wrap&&(p.wrap=-p.wrap),p.pending!==0?o:1)},w.deflateEnd=function(t){var F;return t&&t.state?(F=t.state.status)!==s&&F!==69&&F!==73&&F!==91&&F!==103&&F!==k&&F!==666?et(t,c):(t.state=null,F===k?et(t,-3):o):c},w.deflateSetDictionary=function(t,F){var B,p,f,S,j,L,I,Z,G=F.length;if(!t||!t.state||(S=(B=t.state).wrap)===2||S===1&&B.status!==s||B.lookahead)return c;for(S===1&&(t.adler=a(t.adler,F,G,0)),B.wrap=0,G>=B.w_size&&(S===0&&(st(B.head),B.strstart=0,B.block_start=0,B.insert=0),Z=new r.Buf8(B.w_size),r.arraySet(Z,F,G-B.w_size,B.w_size,0),F=Z,G=B.w_size),j=t.avail_in,L=t.next_in,I=t.input,t.avail_in=G,t.next_in=0,t.input=F,ct(B);B.lookahead>=R;){for(p=B.strstart,f=B.lookahead-(R-1);B.ins_h=(B.ins_h<<B.hash_shift^B.window[p+R-1])&B.hash_mask,B.prev[p&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=p,p++,--f;);B.strstart=p,B.lookahead=R-1,ct(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=R-1,B.match_available=0,t.next_in=L,t.input=I,t.avail_in=j,B.wrap=S,o},w.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(m,P,w){P.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(m,P,w){P.exports=function(l,r){var n,a,h,_,g,y,o,c,i,d,u,v,x,A,E,N,$,U,R,C,z,s,k,e,D;n=l.state,a=l.next_in,e=l.input,h=a+(l.avail_in-5),_=l.next_out,D=l.output,g=_-(r-l.avail_out),y=_+(l.avail_out-257),o=n.dmax,c=n.wsize,i=n.whave,d=n.wnext,u=n.window,v=n.hold,x=n.bits,A=n.lencode,E=n.distcode,N=(1<<n.lenbits)-1,$=(1<<n.distbits)-1;t:do{x<15&&(v+=e[a++]<<x,x+=8,v+=e[a++]<<x,x+=8),U=A[v&N];e:for(;;){if(v>>>=R=U>>>24,x-=R,(R=U>>>16&255)===0)D[_++]=65535&U;else{if(!(16&R)){if(!(64&R)){U=A[(65535&U)+(v&(1<<R)-1)];continue e}if(32&R){n.mode=12;break t}l.msg="invalid literal/length code",n.mode=30;break t}C=65535&U,(R&=15)&&(x<R&&(v+=e[a++]<<x,x+=8),C+=v&(1<<R)-1,v>>>=R,x-=R),x<15&&(v+=e[a++]<<x,x+=8,v+=e[a++]<<x,x+=8),U=E[v&$];r:for(;;){if(v>>>=R=U>>>24,x-=R,!(16&(R=U>>>16&255))){if(!(64&R)){U=E[(65535&U)+(v&(1<<R)-1)];continue r}l.msg="invalid distance code",n.mode=30;break t}if(z=65535&U,x<(R&=15)&&(v+=e[a++]<<x,(x+=8)<R&&(v+=e[a++]<<x,x+=8)),o<(z+=v&(1<<R)-1)){l.msg="invalid distance too far back",n.mode=30;break t}if(v>>>=R,x-=R,(R=_-g)<z){if(i<(R=z-R)&&n.sane){l.msg="invalid distance too far back",n.mode=30;break t}if(k=u,(s=0)===d){if(s+=c-R,R<C){for(C-=R;D[_++]=u[s++],--R;);s=_-z,k=D}}else if(d<R){if(s+=c+d-R,(R-=d)<C){for(C-=R;D[_++]=u[s++],--R;);if(s=0,d<C){for(C-=R=d;D[_++]=u[s++],--R;);s=_-z,k=D}}}else if(s+=d-R,R<C){for(C-=R;D[_++]=u[s++],--R;);s=_-z,k=D}for(;2<C;)D[_++]=k[s++],D[_++]=k[s++],D[_++]=k[s++],C-=3;C&&(D[_++]=k[s++],1<C&&(D[_++]=k[s++]))}else{for(s=_-z;D[_++]=D[s++],D[_++]=D[s++],D[_++]=D[s++],2<(C-=3););C&&(D[_++]=D[s++],1<C&&(D[_++]=D[s++]))}break}}break}}while(a<h&&_<y);a-=C=x>>3,v&=(1<<(x-=C<<3))-1,l.next_in=a,l.next_out=_,l.avail_in=a<h?h-a+5:5-(a-h),l.avail_out=_<y?y-_+257:257-(_-y),n.hold=v,n.bits=x}},{}],49:[function(m,P,w){var l=m("../utils/common"),r=m("./adler32"),n=m("./crc32"),a=m("./inffast"),h=m("./inftrees"),_=1,g=2,y=0,o=-2,c=1,i=852,d=592;function u(s){return(s>>>24&255)+(s>>>8&65280)+((65280&s)<<8)+((255&s)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(s){var k;return s&&s.state?(k=s.state,s.total_in=s.total_out=k.total=0,s.msg="",k.wrap&&(s.adler=1&k.wrap),k.mode=c,k.last=0,k.havedict=0,k.dmax=32768,k.head=null,k.hold=0,k.bits=0,k.lencode=k.lendyn=new l.Buf32(i),k.distcode=k.distdyn=new l.Buf32(d),k.sane=1,k.back=-1,y):o}function A(s){var k;return s&&s.state?((k=s.state).wsize=0,k.whave=0,k.wnext=0,x(s)):o}function E(s,k){var e,D;return s&&s.state?(D=s.state,k<0?(e=0,k=-k):(e=1+(k>>4),k<48&&(k&=15)),k&&(k<8||15<k)?o:(D.window!==null&&D.wbits!==k&&(D.window=null),D.wrap=e,D.wbits=k,A(s))):o}function N(s,k){var e,D;return s?(D=new v,(s.state=D).window=null,(e=E(s,k))!==y&&(s.state=null),e):o}var $,U,R=!0;function C(s){if(R){var k;for($=new l.Buf32(512),U=new l.Buf32(32),k=0;k<144;)s.lens[k++]=8;for(;k<256;)s.lens[k++]=9;for(;k<280;)s.lens[k++]=7;for(;k<288;)s.lens[k++]=8;for(h(_,s.lens,0,288,$,0,s.work,{bits:9}),k=0;k<32;)s.lens[k++]=5;h(g,s.lens,0,32,U,0,s.work,{bits:5}),R=!1}s.lencode=$,s.lenbits=9,s.distcode=U,s.distbits=5}function z(s,k,e,D){var X,M=s.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new l.Buf8(M.wsize)),D>=M.wsize?(l.arraySet(M.window,k,e-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(D<(X=M.wsize-M.wnext)&&(X=D),l.arraySet(M.window,k,e-D,X,M.wnext),(D-=X)?(l.arraySet(M.window,k,e-D,D,0),M.wnext=D,M.whave=M.wsize):(M.wnext+=X,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=X))),0}w.inflateReset=A,w.inflateReset2=E,w.inflateResetKeep=x,w.inflateInit=function(s){return N(s,15)},w.inflateInit2=N,w.inflate=function(s,k){var e,D,X,M,et,V,st,T,O,tt,q,H,ct,vt,at,ot,gt,ft,bt,_t,t,F,B,p,f=0,S=new l.Buf8(4),j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!s||!s.state||!s.output||!s.input&&s.avail_in!==0)return o;(e=s.state).mode===12&&(e.mode=13),et=s.next_out,X=s.output,st=s.avail_out,M=s.next_in,D=s.input,V=s.avail_in,T=e.hold,O=e.bits,tt=V,q=st,F=y;t:for(;;)switch(e.mode){case c:if(e.wrap===0){e.mode=13;break}for(;O<16;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(2&e.wrap&&T===35615){S[e.check=0]=255&T,S[1]=T>>>8&255,e.check=n(e.check,S,2,0),O=T=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&T)<<8)+(T>>8))%31){s.msg="incorrect header check",e.mode=30;break}if((15&T)!=8){s.msg="unknown compression method",e.mode=30;break}if(O-=4,t=8+(15&(T>>>=4)),e.wbits===0)e.wbits=t;else if(t>e.wbits){s.msg="invalid window size",e.mode=30;break}e.dmax=1<<t,s.adler=e.check=1,e.mode=512&T?10:12,O=T=0;break;case 2:for(;O<16;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(e.flags=T,(255&e.flags)!=8){s.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){s.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=T>>8&1),512&e.flags&&(S[0]=255&T,S[1]=T>>>8&255,e.check=n(e.check,S,2,0)),O=T=0,e.mode=3;case 3:for(;O<32;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}e.head&&(e.head.time=T),512&e.flags&&(S[0]=255&T,S[1]=T>>>8&255,S[2]=T>>>16&255,S[3]=T>>>24&255,e.check=n(e.check,S,4,0)),O=T=0,e.mode=4;case 4:for(;O<16;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}e.head&&(e.head.xflags=255&T,e.head.os=T>>8),512&e.flags&&(S[0]=255&T,S[1]=T>>>8&255,e.check=n(e.check,S,2,0)),O=T=0,e.mode=5;case 5:if(1024&e.flags){for(;O<16;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}e.length=T,e.head&&(e.head.extra_len=T),512&e.flags&&(S[0]=255&T,S[1]=T>>>8&255,e.check=n(e.check,S,2,0)),O=T=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(V<(H=e.length)&&(H=V),H&&(e.head&&(t=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Array(e.head.extra_len)),l.arraySet(e.head.extra,D,M,H,t)),512&e.flags&&(e.check=n(e.check,D,H,M)),V-=H,M+=H,e.length-=H),e.length))break t;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(V===0)break t;for(H=0;t=D[M+H++],e.head&&t&&e.length<65536&&(e.head.name+=String.fromCharCode(t)),t&&H<V;);if(512&e.flags&&(e.check=n(e.check,D,H,M)),V-=H,M+=H,t)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(V===0)break t;for(H=0;t=D[M+H++],e.head&&t&&e.length<65536&&(e.head.comment+=String.fromCharCode(t)),t&&H<V;);if(512&e.flags&&(e.check=n(e.check,D,H,M)),V-=H,M+=H,t)break t}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;O<16;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(T!==(65535&e.check)){s.msg="header crc mismatch",e.mode=30;break}O=T=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),s.adler=e.check=0,e.mode=12;break;case 10:for(;O<32;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}s.adler=e.check=u(T),O=T=0,e.mode=11;case 11:if(e.havedict===0)return s.next_out=et,s.avail_out=st,s.next_in=M,s.avail_in=V,e.hold=T,e.bits=O,2;s.adler=e.check=1,e.mode=12;case 12:if(k===5||k===6)break t;case 13:if(e.last){T>>>=7&O,O-=7&O,e.mode=27;break}for(;O<3;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}switch(e.last=1&T,O-=1,3&(T>>>=1)){case 0:e.mode=14;break;case 1:if(C(e),e.mode=20,k!==6)break;T>>>=2,O-=2;break t;case 2:e.mode=17;break;case 3:s.msg="invalid block type",e.mode=30}T>>>=2,O-=2;break;case 14:for(T>>>=7&O,O-=7&O;O<32;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if((65535&T)!=(T>>>16^65535)){s.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&T,O=T=0,e.mode=15,k===6)break t;case 15:e.mode=16;case 16:if(H=e.length){if(V<H&&(H=V),st<H&&(H=st),H===0)break t;l.arraySet(X,D,M,H,et),V-=H,M+=H,st-=H,et+=H,e.length-=H;break}e.mode=12;break;case 17:for(;O<14;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(e.nlen=257+(31&T),T>>>=5,O-=5,e.ndist=1+(31&T),T>>>=5,O-=5,e.ncode=4+(15&T),T>>>=4,O-=4,286<e.nlen||30<e.ndist){s.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;O<3;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}e.lens[j[e.have++]]=7&T,T>>>=3,O-=3}for(;e.have<19;)e.lens[j[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,B={bits:e.lenbits},F=h(0,e.lens,0,19,e.lencode,0,e.work,B),e.lenbits=B.bits,F){s.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;ot=(f=e.lencode[T&(1<<e.lenbits)-1])>>>16&255,gt=65535&f,!((at=f>>>24)<=O);){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(gt<16)T>>>=at,O-=at,e.lens[e.have++]=gt;else{if(gt===16){for(p=at+2;O<p;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(T>>>=at,O-=at,e.have===0){s.msg="invalid bit length repeat",e.mode=30;break}t=e.lens[e.have-1],H=3+(3&T),T>>>=2,O-=2}else if(gt===17){for(p=at+3;O<p;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}O-=at,t=0,H=3+(7&(T>>>=at)),T>>>=3,O-=3}else{for(p=at+7;O<p;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}O-=at,t=0,H=11+(127&(T>>>=at)),T>>>=7,O-=7}if(e.have+H>e.nlen+e.ndist){s.msg="invalid bit length repeat",e.mode=30;break}for(;H--;)e.lens[e.have++]=t}}if(e.mode===30)break;if(e.lens[256]===0){s.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,B={bits:e.lenbits},F=h(_,e.lens,0,e.nlen,e.lencode,0,e.work,B),e.lenbits=B.bits,F){s.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,B={bits:e.distbits},F=h(g,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,B),e.distbits=B.bits,F){s.msg="invalid distances set",e.mode=30;break}if(e.mode=20,k===6)break t;case 20:e.mode=21;case 21:if(6<=V&&258<=st){s.next_out=et,s.avail_out=st,s.next_in=M,s.avail_in=V,e.hold=T,e.bits=O,a(s,q),et=s.next_out,X=s.output,st=s.avail_out,M=s.next_in,D=s.input,V=s.avail_in,T=e.hold,O=e.bits,e.mode===12&&(e.back=-1);break}for(e.back=0;ot=(f=e.lencode[T&(1<<e.lenbits)-1])>>>16&255,gt=65535&f,!((at=f>>>24)<=O);){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(ot&&!(240&ot)){for(ft=at,bt=ot,_t=gt;ot=(f=e.lencode[_t+((T&(1<<ft+bt)-1)>>ft)])>>>16&255,gt=65535&f,!(ft+(at=f>>>24)<=O);){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}T>>>=ft,O-=ft,e.back+=ft}if(T>>>=at,O-=at,e.back+=at,e.length=gt,ot===0){e.mode=26;break}if(32&ot){e.back=-1,e.mode=12;break}if(64&ot){s.msg="invalid literal/length code",e.mode=30;break}e.extra=15&ot,e.mode=22;case 22:if(e.extra){for(p=e.extra;O<p;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}e.length+=T&(1<<e.extra)-1,T>>>=e.extra,O-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;ot=(f=e.distcode[T&(1<<e.distbits)-1])>>>16&255,gt=65535&f,!((at=f>>>24)<=O);){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(!(240&ot)){for(ft=at,bt=ot,_t=gt;ot=(f=e.distcode[_t+((T&(1<<ft+bt)-1)>>ft)])>>>16&255,gt=65535&f,!(ft+(at=f>>>24)<=O);){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}T>>>=ft,O-=ft,e.back+=ft}if(T>>>=at,O-=at,e.back+=at,64&ot){s.msg="invalid distance code",e.mode=30;break}e.offset=gt,e.extra=15&ot,e.mode=24;case 24:if(e.extra){for(p=e.extra;O<p;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}e.offset+=T&(1<<e.extra)-1,T>>>=e.extra,O-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){s.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(st===0)break t;if(H=q-st,e.offset>H){if((H=e.offset-H)>e.whave&&e.sane){s.msg="invalid distance too far back",e.mode=30;break}ct=H>e.wnext?(H-=e.wnext,e.wsize-H):e.wnext-H,H>e.length&&(H=e.length),vt=e.window}else vt=X,ct=et-e.offset,H=e.length;for(st<H&&(H=st),st-=H,e.length-=H;X[et++]=vt[ct++],--H;);e.length===0&&(e.mode=21);break;case 26:if(st===0)break t;X[et++]=e.length,st--,e.mode=21;break;case 27:if(e.wrap){for(;O<32;){if(V===0)break t;V--,T|=D[M++]<<O,O+=8}if(q-=st,s.total_out+=q,e.total+=q,q&&(s.adler=e.check=e.flags?n(e.check,X,q,et-q):r(e.check,X,q,et-q)),q=st,(e.flags?T:u(T))!==e.check){s.msg="incorrect data check",e.mode=30;break}O=T=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;O<32;){if(V===0)break t;V--,T+=D[M++]<<O,O+=8}if(T!==(4294967295&e.total)){s.msg="incorrect length check",e.mode=30;break}O=T=0}e.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return o}return s.next_out=et,s.avail_out=st,s.next_in=M,s.avail_in=V,e.hold=T,e.bits=O,(e.wsize||q!==s.avail_out&&e.mode<30&&(e.mode<27||k!==4))&&z(s,s.output,s.next_out,q-s.avail_out)?(e.mode=31,-4):(tt-=s.avail_in,q-=s.avail_out,s.total_in+=tt,s.total_out+=q,e.total+=q,e.wrap&&q&&(s.adler=e.check=e.flags?n(e.check,X,q,s.next_out-q):r(e.check,X,q,s.next_out-q)),s.data_type=e.bits+(e.last?64:0)+(e.mode===12?128:0)+(e.mode===20||e.mode===15?256:0),(tt==0&&q===0||k===4)&&F===y&&(F=-5),F)},w.inflateEnd=function(s){if(!s||!s.state)return o;var k=s.state;return k.window&&(k.window=null),s.state=null,y},w.inflateGetHeader=function(s,k){var e;return s&&s.state&&2&(e=s.state).wrap?((e.head=k).done=!1,y):o},w.inflateSetDictionary=function(s,k){var e,D=k.length;return s&&s.state?(e=s.state).wrap!==0&&e.mode!==11?o:e.mode===11&&r(1,k,D,0)!==e.check?-3:z(s,k,D,D)?(e.mode=31,-4):(e.havedict=1,y):o},w.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(m,P,w){var l=m("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];P.exports=function(_,g,y,o,c,i,d,u){var v,x,A,E,N,$,U,R,C,z=u.bits,s=0,k=0,e=0,D=0,X=0,M=0,et=0,V=0,st=0,T=0,O=null,tt=0,q=new l.Buf16(16),H=new l.Buf16(16),ct=null,vt=0;for(s=0;s<=15;s++)q[s]=0;for(k=0;k<o;k++)q[g[y+k]]++;for(X=z,D=15;1<=D&&q[D]===0;D--);if(D<X&&(X=D),D===0)return c[i++]=20971520,c[i++]=20971520,u.bits=1,0;for(e=1;e<D&&q[e]===0;e++);for(X<e&&(X=e),s=V=1;s<=15;s++)if(V<<=1,(V-=q[s])<0)return-1;if(0<V&&(_===0||D!==1))return-1;for(H[1]=0,s=1;s<15;s++)H[s+1]=H[s]+q[s];for(k=0;k<o;k++)g[y+k]!==0&&(d[H[g[y+k]]++]=k);if($=_===0?(O=ct=d,19):_===1?(O=r,tt-=257,ct=n,vt-=257,256):(O=a,ct=h,-1),s=e,N=i,et=k=T=0,A=-1,E=(st=1<<(M=X))-1,_===1&&852<st||_===2&&592<st)return 1;for(;;){for(U=s-et,C=d[k]<$?(R=0,d[k]):d[k]>$?(R=ct[vt+d[k]],O[tt+d[k]]):(R=96,0),v=1<<s-et,e=x=1<<M;c[N+(T>>et)+(x-=v)]=U<<24|R<<16|C|0,x!==0;);for(v=1<<s-1;T&v;)v>>=1;if(v!==0?(T&=v-1,T+=v):T=0,k++,--q[s]==0){if(s===D)break;s=g[y+d[k]]}if(X<s&&(T&E)!==A){for(et===0&&(et=X),N+=e,V=1<<(M=s-et);M+et<D&&!((V-=q[M+et])<=0);)M++,V<<=1;if(st+=1<<M,_===1&&852<st||_===2&&592<st)return 1;c[A=T&E]=X<<24|M<<16|N-i|0}}return T!==0&&(c[N+T]=s-et<<24|64<<16|0),u.bits=X,0}},{"../utils/common":41}],51:[function(m,P,w){P.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(m,P,w){var l=m("../utils/common"),r=0,n=1;function a(f){for(var S=f.length;0<=--S;)f[S]=0}var h=0,_=29,g=256,y=g+1+_,o=30,c=19,i=2*y+1,d=15,u=16,v=7,x=256,A=16,E=17,N=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(y+2));a(z);var s=new Array(2*o);a(s);var k=new Array(512);a(k);var e=new Array(256);a(e);var D=new Array(_);a(D);var X,M,et,V=new Array(o);function st(f,S,j,L,I){this.static_tree=f,this.extra_bits=S,this.extra_base=j,this.elems=L,this.max_length=I,this.has_stree=f&&f.length}function T(f,S){this.dyn_tree=f,this.max_code=0,this.stat_desc=S}function O(f){return f<256?k[f]:k[256+(f>>>7)]}function tt(f,S){f.pending_buf[f.pending++]=255&S,f.pending_buf[f.pending++]=S>>>8&255}function q(f,S,j){f.bi_valid>u-j?(f.bi_buf|=S<<f.bi_valid&65535,tt(f,f.bi_buf),f.bi_buf=S>>u-f.bi_valid,f.bi_valid+=j-u):(f.bi_buf|=S<<f.bi_valid&65535,f.bi_valid+=j)}function H(f,S,j){q(f,j[2*S],j[2*S+1])}function ct(f,S){for(var j=0;j|=1&f,f>>>=1,j<<=1,0<--S;);return j>>>1}function vt(f,S,j){var L,I,Z=new Array(d+1),G=0;for(L=1;L<=d;L++)Z[L]=G=G+j[L-1]<<1;for(I=0;I<=S;I++){var W=f[2*I+1];W!==0&&(f[2*I]=ct(Z[W]++,W))}}function at(f){var S;for(S=0;S<y;S++)f.dyn_ltree[2*S]=0;for(S=0;S<o;S++)f.dyn_dtree[2*S]=0;for(S=0;S<c;S++)f.bl_tree[2*S]=0;f.dyn_ltree[2*x]=1,f.opt_len=f.static_len=0,f.last_lit=f.matches=0}function ot(f){8<f.bi_valid?tt(f,f.bi_buf):0<f.bi_valid&&(f.pending_buf[f.pending++]=f.bi_buf),f.bi_buf=0,f.bi_valid=0}function gt(f,S,j,L){var I=2*S,Z=2*j;return f[I]<f[Z]||f[I]===f[Z]&&L[S]<=L[j]}function ft(f,S,j){for(var L=f.heap[j],I=j<<1;I<=f.heap_len&&(I<f.heap_len&&gt(S,f.heap[I+1],f.heap[I],f.depth)&&I++,!gt(S,L,f.heap[I],f.depth));)f.heap[j]=f.heap[I],j=I,I<<=1;f.heap[j]=L}function bt(f,S,j){var L,I,Z,G,W=0;if(f.last_lit!==0)for(;L=f.pending_buf[f.d_buf+2*W]<<8|f.pending_buf[f.d_buf+2*W+1],I=f.pending_buf[f.l_buf+W],W++,L===0?H(f,I,S):(H(f,(Z=e[I])+g+1,S),(G=$[Z])!==0&&q(f,I-=D[Z],G),H(f,Z=O(--L),j),(G=U[Z])!==0&&q(f,L-=V[Z],G)),W<f.last_lit;);H(f,x,S)}function _t(f,S){var j,L,I,Z=S.dyn_tree,G=S.stat_desc.static_tree,W=S.stat_desc.has_stree,Q=S.stat_desc.elems,lt=-1;for(f.heap_len=0,f.heap_max=i,j=0;j<Q;j++)Z[2*j]!==0?(f.heap[++f.heap_len]=lt=j,f.depth[j]=0):Z[2*j+1]=0;for(;f.heap_len<2;)Z[2*(I=f.heap[++f.heap_len]=lt<2?++lt:0)]=1,f.depth[I]=0,f.opt_len--,W&&(f.static_len-=G[2*I+1]);for(S.max_code=lt,j=f.heap_len>>1;1<=j;j--)ft(f,Z,j);for(I=Q;j=f.heap[1],f.heap[1]=f.heap[f.heap_len--],ft(f,Z,1),L=f.heap[1],f.heap[--f.heap_max]=j,f.heap[--f.heap_max]=L,Z[2*I]=Z[2*j]+Z[2*L],f.depth[I]=(f.depth[j]>=f.depth[L]?f.depth[j]:f.depth[L])+1,Z[2*j+1]=Z[2*L+1]=I,f.heap[1]=I++,ft(f,Z,1),2<=f.heap_len;);f.heap[--f.heap_max]=f.heap[1],function(rt,pt){var zt,yt,Ct,ut,$t,Mt,Et=pt.dyn_tree,Yt=pt.max_code,le=pt.stat_desc.static_tree,de=pt.stat_desc.has_stree,ue=pt.stat_desc.extra_bits,Kt=pt.stat_desc.extra_base,Pt=pt.stat_desc.max_length,Nt=0;for(ut=0;ut<=d;ut++)rt.bl_count[ut]=0;for(Et[2*rt.heap[rt.heap_max]+1]=0,zt=rt.heap_max+1;zt<i;zt++)Pt<(ut=Et[2*Et[2*(yt=rt.heap[zt])+1]+1]+1)&&(ut=Pt,Nt++),Et[2*yt+1]=ut,Yt<yt||(rt.bl_count[ut]++,$t=0,Kt<=yt&&($t=ue[yt-Kt]),Mt=Et[2*yt],rt.opt_len+=Mt*(ut+$t),de&&(rt.static_len+=Mt*(le[2*yt+1]+$t)));if(Nt!==0){do{for(ut=Pt-1;rt.bl_count[ut]===0;)ut--;rt.bl_count[ut]--,rt.bl_count[ut+1]+=2,rt.bl_count[Pt]--,Nt-=2}while(0<Nt);for(ut=Pt;ut!==0;ut--)for(yt=rt.bl_count[ut];yt!==0;)Yt<(Ct=rt.heap[--zt])||(Et[2*Ct+1]!==ut&&(rt.opt_len+=(ut-Et[2*Ct+1])*Et[2*Ct],Et[2*Ct+1]=ut),yt--)}}(f,S),vt(Z,lt,f.bl_count)}function t(f,S,j){var L,I,Z=-1,G=S[1],W=0,Q=7,lt=4;for(G===0&&(Q=138,lt=3),S[2*(j+1)+1]=65535,L=0;L<=j;L++)I=G,G=S[2*(L+1)+1],++W<Q&&I===G||(W<lt?f.bl_tree[2*I]+=W:I!==0?(I!==Z&&f.bl_tree[2*I]++,f.bl_tree[2*A]++):W<=10?f.bl_tree[2*E]++:f.bl_tree[2*N]++,Z=I,lt=(W=0)===G?(Q=138,3):I===G?(Q=6,3):(Q=7,4))}function F(f,S,j){var L,I,Z=-1,G=S[1],W=0,Q=7,lt=4;for(G===0&&(Q=138,lt=3),L=0;L<=j;L++)if(I=G,G=S[2*(L+1)+1],!(++W<Q&&I===G)){if(W<lt)for(;H(f,I,f.bl_tree),--W!=0;);else I!==0?(I!==Z&&(H(f,I,f.bl_tree),W--),H(f,A,f.bl_tree),q(f,W-3,2)):W<=10?(H(f,E,f.bl_tree),q(f,W-3,3)):(H(f,N,f.bl_tree),q(f,W-11,7));Z=I,lt=(W=0)===G?(Q=138,3):I===G?(Q=6,3):(Q=7,4)}}a(V);var B=!1;function p(f,S,j,L){q(f,(h<<1)+(L?1:0),3),function(I,Z,G,W){ot(I),tt(I,G),tt(I,~G),l.arraySet(I.pending_buf,I.window,Z,G,I.pending),I.pending+=G}(f,S,j)}w._tr_init=function(f){B||(function(){var S,j,L,I,Z,G=new Array(d+1);for(I=L=0;I<_-1;I++)for(D[I]=L,S=0;S<1<<$[I];S++)e[L++]=I;for(e[L-1]=I,I=Z=0;I<16;I++)for(V[I]=Z,S=0;S<1<<U[I];S++)k[Z++]=I;for(Z>>=7;I<o;I++)for(V[I]=Z<<7,S=0;S<1<<U[I]-7;S++)k[256+Z++]=I;for(j=0;j<=d;j++)G[j]=0;for(S=0;S<=143;)z[2*S+1]=8,S++,G[8]++;for(;S<=255;)z[2*S+1]=9,S++,G[9]++;for(;S<=279;)z[2*S+1]=7,S++,G[7]++;for(;S<=287;)z[2*S+1]=8,S++,G[8]++;for(vt(z,y+1,G),S=0;S<o;S++)s[2*S+1]=5,s[2*S]=ct(S,5);X=new st(z,$,g+1,y,d),M=new st(s,U,0,o,d),et=new st(new Array(0),R,0,c,v)}(),B=!0),f.l_desc=new T(f.dyn_ltree,X),f.d_desc=new T(f.dyn_dtree,M),f.bl_desc=new T(f.bl_tree,et),f.bi_buf=0,f.bi_valid=0,at(f)},w._tr_stored_block=p,w._tr_flush_block=function(f,S,j,L){var I,Z,G=0;0<f.level?(f.strm.data_type===2&&(f.strm.data_type=function(W){var Q,lt=4093624447;for(Q=0;Q<=31;Q++,lt>>>=1)if(1&lt&&W.dyn_ltree[2*Q]!==0)return r;if(W.dyn_ltree[18]!==0||W.dyn_ltree[20]!==0||W.dyn_ltree[26]!==0)return n;for(Q=32;Q<g;Q++)if(W.dyn_ltree[2*Q]!==0)return n;return r}(f)),_t(f,f.l_desc),_t(f,f.d_desc),G=function(W){var Q;for(t(W,W.dyn_ltree,W.l_desc.max_code),t(W,W.dyn_dtree,W.d_desc.max_code),_t(W,W.bl_desc),Q=c-1;3<=Q&&W.bl_tree[2*C[Q]+1]===0;Q--);return W.opt_len+=3*(Q+1)+5+5+4,Q}(f),I=f.opt_len+3+7>>>3,(Z=f.static_len+3+7>>>3)<=I&&(I=Z)):I=Z=j+5,j+4<=I&&S!==-1?p(f,S,j,L):f.strategy===4||Z===I?(q(f,2+(L?1:0),3),bt(f,z,s)):(q(f,4+(L?1:0),3),function(W,Q,lt,rt){var pt;for(q(W,Q-257,5),q(W,lt-1,5),q(W,rt-4,4),pt=0;pt<rt;pt++)q(W,W.bl_tree[2*C[pt]+1],3);F(W,W.dyn_ltree,Q-1),F(W,W.dyn_dtree,lt-1)}(f,f.l_desc.max_code+1,f.d_desc.max_code+1,G+1),bt(f,f.dyn_ltree,f.dyn_dtree)),at(f),L&&ot(f)},w._tr_tally=function(f,S,j){return f.pending_buf[f.d_buf+2*f.last_lit]=S>>>8&255,f.pending_buf[f.d_buf+2*f.last_lit+1]=255&S,f.pending_buf[f.l_buf+f.last_lit]=255&j,f.last_lit++,S===0?f.dyn_ltree[2*j]++:(f.matches++,S--,f.dyn_ltree[2*(e[j]+g+1)]++,f.dyn_dtree[2*O(S)]++),f.last_lit===f.lit_bufsize-1},w._tr_align=function(f){q(f,2,3),H(f,x,z),function(S){S.bi_valid===16?(tt(S,S.bi_buf),S.bi_buf=0,S.bi_valid=0):8<=S.bi_valid&&(S.pending_buf[S.pending++]=255&S.bi_buf,S.bi_buf>>=8,S.bi_valid-=8)}(f)}},{"../utils/common":41}],53:[function(m,P,w){P.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(m,P,w){(function(l){(function(r,n){if(!r.setImmediate){var a,h,_,g,y=1,o={},c=!1,i=r.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(r);d=d&&d.setTimeout?d:r,a={}.toString.call(r.process)==="[object process]"?function(A){process.nextTick(function(){v(A)})}:function(){if(r.postMessage&&!r.importScripts){var A=!0,E=r.onmessage;return r.onmessage=function(){A=!1},r.postMessage("","*"),r.onmessage=E,A}}()?(g="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",x,!1):r.attachEvent("onmessage",x),function(A){r.postMessage(g+A,"*")}):r.MessageChannel?((_=new MessageChannel).port1.onmessage=function(A){v(A.data)},function(A){_.port2.postMessage(A)}):i&&"onreadystatechange"in i.createElement("script")?(h=i.documentElement,function(A){var E=i.createElement("script");E.onreadystatechange=function(){v(A),E.onreadystatechange=null,h.removeChild(E),E=null},h.appendChild(E)}):function(A){setTimeout(v,0,A)},d.setImmediate=function(A){typeof A!="function"&&(A=new Function(""+A));for(var E=new Array(arguments.length-1),N=0;N<E.length;N++)E[N]=arguments[N+1];var $={callback:A,args:E};return o[y]=$,a(y),y++},d.clearImmediate=u}function u(A){delete o[A]}function v(A){if(c)setTimeout(v,0,A);else{var E=o[A];if(E){c=!0;try{(function(N){var $=N.callback,U=N.args;switch(U.length){case 0:$();break;case 1:$(U[0]);break;case 2:$(U[0],U[1]);break;case 3:$(U[0],U[1],U[2]);break;default:$.apply(n,U)}})(E)}finally{u(A),c=!1}}}}function x(A){A.source===r&&typeof A.data=="string"&&A.data.indexOf(g)===0&&v(+A.data.slice(g.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof Ft<"u"?Ft:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(oe);var rr=oe.exports;const sr=Ae(rr);function nr(){async function nt(r){return new Promise((n,a)=>{try{const h=it(r),_=document.createElement("div");_.innerHTML=h,_.style.position="absolute",_.style.left="-9999px",_.style.top="-9999px",document.body.appendChild(_);const g={margin:[10,10,10,10],filename:`caso_${r.caseCode||r.id}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};Ee().from(_).set(g).toPdf().get("pdf").then(y=>{const o=y.output("blob");document.body.removeChild(_),n(o)}).catch(y=>{document.body.removeChild(_),a(y)})}catch(h){a(h)}})}function it(r){var h,_,g;const n=new Date().toLocaleDateString("es-CO"),a=r.receivedAt?new Date(r.receivedAt).toLocaleDateString("es-CO"):"N/A";return`
      <!DOCTYPE html>
      <html lang="es">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Informe Caso ${r.caseCode||r.id}</title>
        <style>
          * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
          }
          
          body {
            font-family: Arial, sans-serif;
            background: white;
            color: #333;
            line-height: 1.4;
            padding: 20mm;
            font-size: 12px;
          }
          
          .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
          }
          
          .logo {
            height: 40px;
            max-width: 150px;
            object-fit: contain;
          }
          
          .title-section {
            flex: 1;
            text-align: center;
          }
          
          .title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
          }
          
          .subtitle {
            font-size: 14px;
            font-weight: 600;
            color: #666;
          }
          
          .date {
            font-size: 10px;
            color: #666;
            white-space: nowrap;
          }
          
          .info-section {
            margin-bottom: 20px;
          }
          
          .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
          }
          
          .info-item {
            border: 1px solid #ddd;
            padding: 8px;
            background-color: #f9f9f9;
          }
          
          .info-label {
            font-weight: bold;
            color: #555;
            font-size: 10px;
            text-transform: uppercase;
          }
          
          .info-value {
            font-size: 11px;
            margin-top: 3px;
          }
          
          .tests-section {
            margin-bottom: 20px;
          }
          
          .test-item {
            background-color: #f0f0f0;
            padding: 5px 8px;
            margin: 2px 0;
            border-radius: 3px;
            font-size: 10px;
            font-family: monospace;
          }
          
          .status-section {
            margin-bottom: 20px;
          }
          
          .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
          }
          
          .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 9px;
            color: #666;
            border-top: 1px solid #ddd;
            padding-top: 10px;
          }
          
          @media print {
            body { padding: 0; }
            @page { margin: 15mm; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <img src="/images/logo/Baner-udea.png" alt="Logo Universidad de Antioquia" class="logo" />
          <div class="title-section">
            <div class="title">INFORME DE CASO PATOLÓGICO</div>
            <div class="subtitle">Hospital Universitario Alma Mater de Antioquia</div>
          </div>
          <div class="date">${n}</div>
        </div>
        
        <div class="info-section">
          <div class="info-grid">
            <div class="info-item">
              <div class="info-label">Código del Caso</div>
              <div class="info-value">${r.caseCode||r.id}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Fecha de Recepción</div>
              <div class="info-value">${a}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Paciente</div>
              <div class="info-value">${((h=r.patient)==null?void 0:h.fullName)||"N/A"}</div>
            </div>
            <div class="info-item">
              <div class="info-label">DNI</div>
              <div class="info-value">${((_=r.patient)==null?void 0:_.dni)||"N/A"}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Entidad</div>
              <div class="info-value">${r.entity||"N/A"}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Patólogo</div>
              <div class="info-value">${r.pathologist||"No asignado"}</div>
            </div>
          </div>
        </div>
        
        <div class="tests-section">
          <div class="info-label" style="margin-bottom: 8px;">PRUEBAS SOLICITADAS</div>
          ${((g=r.tests)==null?void 0:g.map(y=>`<div class="test-item">${y}</div>`).join(""))||'<div class="test-item">No hay pruebas registradas</div>'}
        </div>
        
        <div class="status-section">
          <div class="info-label" style="margin-bottom: 8px;">ESTADO ACTUAL</div>
          <div class="status-badge" style="background-color: ${m(r.status)}; color: white;">
            ${r.status||"N/A"}
          </div>
        </div>
        
        <div class="footer">
          <div>Informe generado automáticamente por el sistema</div>
          <div>Fecha de generación: ${new Date().toLocaleString("es-CO")}</div>
        </div>
      </body>
      </html>
    `}function m(r){switch(r){case"Completado":return"#10b981";case"Por firmar":return"#f59e0b";case"En proceso":return"#3b82f6";case"Por entregar":return"#f97316";case"Requiere cambios":return"#ef4444";default:return"#6b7280"}}async function P(r,n,a){try{const h=new sr,_=h.folder("informes_pdf");for(let c=0;c<r.length;c++){if(a&&a())return;const i=r[c];try{const d=await nt(i),u=`caso_${i.caseCode||i.id}.pdf`;_==null||_.file(u,d);const v=c+1,x=r.length;n&&n(v,x)}catch{}}if(a&&a())return;const g=await h.generateAsync({type:"blob"}),y=URL.createObjectURL(g),o=document.createElement("a");o.href=y,o.download=`informes_casos_${new Date().toISOString().split("T")[0]}.zip`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(y)}catch(h){throw h}}async function w(r,n="selected"){try{const a=r.map(i=>{var d,u,v;return{"ID Caso":i.id,"Tipo de Muestra":i.sampleType,Paciente:((d=i.patient)==null?void 0:d.fullName)||"N/A",DNI:((u=i.patient)==null?void 0:u.dni)||"N/A",Entidad:i.entity||"N/A",Médico:i.requester||"N/A",Estado:i.status||"N/A","Fecha Recepción":i.receivedAt||"N/A","Fecha Entrega":i.deliveredAt||"",Pruebas:((v=i.tests)==null?void 0:v.join(", "))||"N/A"}}),h=await re(()=>import("./xlsx-D_0l8YDs.js"),[]),_=h.utils.json_to_sheet(a),g=h.utils.book_new(),y=n==="selected"?"Casos Seleccionados":"Casos Filtrados";h.utils.book_append_sheet(g,_,y);const c=`casos_${n==="selected"?"seleccionados":"filtrados"}_${new Date().toISOString().split("T")[0]}.xlsx`;h.writeFile(g,c)}catch(a){throw a}}function l(r){try{if(r.length===0)return;const n={multipleCases:!0,cases:r.map((a,h)=>{var _,g,y,o,c,i,d,u,v,x,A,E,N,$,U,R,C,z,s,k,e,D,X,M;return{sampleId:a.caseCode||a.id,patient:{document:((_=a.patient)==null?void 0:_.dni)||"",fullName:((g=a.patient)==null?void 0:g.fullName)||"",age:((y=a.patient)==null?void 0:y.age)||"",gender:((o=a.patient)==null?void 0:o.sex)||"",entity:a.entity||""},caseDetails:{CasoCode:a.caseCode||a.id||"",fecha_creacion:a.receivedAt||"",fecha_entrega:a.deliveredAt||"",patologo_asignado:a.pathologist?{nombre:a.pathologist}:void 0,medico_solicitante:a.requester?{nombre:a.requester}:void 0,entidad_info:a.entity?{nombre:a.entity}:void 0,muestras:Array.isArray(a.subsamples)?a.subsamples.map(et=>({region_cuerpo:et.bodyRegion,pruebas:Array.isArray(et.tests)?et.tests.map(V=>({id:V.id,nombre:V.name||V.id})):[]})):[],paciente:{codigo:((c=a.patient)==null?void 0:c.id)||"",nombre:((i=a.patient)==null?void 0:i.fullName)||"",edad:((d=a.patient)==null?void 0:d.age)||0,sexo:((u=a.patient)==null?void 0:u.sex)||"",entidad_info:a.entity?{codigo:"",nombre:a.entity}:void 0,tipo_atencion:"",cedula:((v=a.patient)==null?void 0:v.dni)||"",observaciones:"",fecha_actualizacion:new Date().toISOString()},servicio:void 0,estado:a.status||"",fecha_ingreso:a.receivedAt||"",fecha_firma:a.deliveredAt||null,fecha_actualizacion:new Date().toISOString(),observaciones_generales:"",is_active:!0,actualizado_por:"sistema"},sections:{method:((x=a.result)==null?void 0:x.method)||"",macro:((A=a.result)==null?void 0:A.macro)||"",micro:((E=a.result)==null?void 0:E.micro)||"",diagnosis:((N=a.result)==null?void 0:N.diagnosis)||""},diagnosis:{cie10:($=a.result)!=null&&$.diagnostico_cie10?{primary:a.result.diagnostico_cie10,formatted:(U=a.result.diagnostico_cie10)!=null&&U.codigo&&((R=a.result.diagnostico_cie10)!=null&&R.nombre)?`${a.result.diagnostico_cie10.codigo} - ${a.result.diagnostico_cie10.nombre}`:""}:void 0,cieo:(C=a.result)!=null&&C.diagnostico_cieo?{primary:a.result.diagnostico_cieo,formatted:(z=a.result.diagnostico_cieo)!=null&&z.codigo&&((s=a.result.diagnostico_cieo)!=null&&s.nombre)?`${a.result.diagnostico_cieo.codigo} - ${a.result.diagnostico_cieo.nombre}`:""}:void 0,formatted:(e=(k=a.result)==null?void 0:k.diagnostico_cie10)!=null&&e.codigo&&((X=(D=a.result)==null?void 0:D.diagnostico_cie10)!=null&&X.nombre)?`${a.result.diagnostico_cie10.codigo} - ${a.result.diagnostico_cie10.nombre}`:((M=a.result)==null?void 0:M.diagnosis)||""},generatedAt:new Date().toISOString()}}),generatedAt:new Date().toISOString()};console.log("Payload creado:",n),localStorage.setItem("results_preview_payload",JSON.stringify(n)),window.location.href="/results/preview"}catch(n){throw console.error("Error preparando previsualización:",n),n}}return{generateCasePDF:nt,downloadMultiplePDFs:P,exportCasesToExcel:w,previewMultipleCases:l}}const ir={class:"overflow-hidden rounded-xl border border-gray-200 bg-white"},ar={key:0,class:"bg-blue-50 border-b border-blue-200 px-4 py-3"},or={class:"flex items-center justify-between"},lr={class:"flex items-center gap-3"},dr={class:"text-sm font-medium text-blue-800"},ur={class:"flex items-center gap-2"},cr=["disabled"],fr={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},hr={class:"hidden lg:block max-w-full overflow-x-auto custom-scrollbar"},pr={class:"min-w-full text-base"},mr={class:"border-b border-gray-200 bg-gray-50"},gr={class:"px-2 py-2 text-center w-12"},vr={class:"flex items-center justify-center"},_r=["onClick"],yr={key:0},br={class:"divide-y divide-gray-200"},wr=["onClick"],xr={class:"px-2 py-3 text-center"},kr={class:"flex items-center justify-center"},Cr={class:"px-1 py-3 text-center"},Sr={class:"font-medium text-gray-800"},Ar={class:"px-2 py-3 text-center"},Er={class:"text-gray-800 text-sm"},zr={class:"text-gray-500 text-xs"},Ir={class:"px-2 py-3 text-center"},Dr={class:"text-gray-800 text-sm"},Or={class:"text-gray-500 text-xs"},Tr={class:"px-3 py-3 text-center"},Br={class:"flex flex-wrap gap-1 justify-center max-w-full"},Rr=["title"],Pr={class:"truncate test-code"},$r={key:0,class:"ml-1 inline-flex items-center justify-center w-4 h-4 rounded-full bg-blue-100 text-blue-600 text-[10px] font-bold flex-shrink-0"},Nr=["title"],Fr={class:"px-2 py-3 text-center"},jr={class:"px-2 py-3 text-center"},Lr={class:"text-gray-800 text-sm"},Ur={class:"px-2 py-3 text-center"},Mr={key:0,class:"text-gray-800 text-sm"},Vr={key:1,class:"text-gray-400 text-sm"},Zr={class:"px-2 py-3 text-center"},Wr={class:"flex gap-1 justify-center min-w-[120px]"},Hr=["onClick"],qr=["onClick"],Gr=["onClick"],Yr=["onClick","title"],Kr={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xr={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Jr={key:0},Qr=["colspan"],ts={class:"text-gray-500 text-sm"},es={class:"lg:hidden"},rs={class:"space-y-3 p-4"},ss=["onClick"],ns={class:"flex items-start justify-between mb-3"},is={class:"flex items-center gap-3 flex-1 min-w-0"},as={class:"flex items-center gap-2 mb-2"},os={class:"font-semibold text-gray-800 text-sm truncate"},ls={class:"text-gray-600 text-xs"},ds={class:"text-gray-500 text-xs"},us={class:"flex-shrink-0 ml-3"},cs={class:"grid grid-cols-2 gap-3 mb-3 text-xs"},fs={class:"text-gray-800 font-medium"},hs={class:"text-gray-800 font-medium"},ps={class:"text-gray-800 font-medium"},ms={key:0},gs={class:"text-gray-800 font-medium"},vs={class:"mb-3"},_s={class:"grid grid-cols-3 gap-1"},ys=["title"],bs={class:"truncate test-code"},ws={key:0,class:"ml-1 inline-flex items-center justify-center w-4 h-4 rounded-full bg-blue-100 text-blue-600 text-[10px] font-bold flex-shrink-0"},xs=["title"],ks={class:"flex gap-1 pt-2 border-t border-gray-100"},Cs=["onClick"],Ss=["onClick"],As=["onClick"],Es=["onClick"],zs={key:0,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Is={key:1,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ds={key:0,class:"text-center py-8"},Os={class:"flex flex-col items-center space-y-2"},Ts={class:"text-center"},Bs={class:"text-gray-500 text-sm font-medium"},Rs={class:"px-4 sm:px-5 py-4 border-t border-gray-200 bg-gray-50"},Ps={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},$s={class:"flex items-center gap-2 text-sm text-gray-500"},Ns=["value"],Fs=["value"],js={class:"flex items-center justify-center gap-2"},Ls=["disabled"],Us={class:"flex items-center gap-1 text-sm text-gray-500"},Ms={class:"font-medium"},Vs={class:"hidden sm:inline"},Zs={class:"sm:hidden"},Ws=["disabled"],Hs=Rt({__name:"CasesTable",props:{cases:{},selectedIds:{},isAllSelected:{type:Boolean},columns:{},sortKey:{},sortOrder:{},currentPage:{},totalPages:{},itemsPerPage:{},totalItems:{},noResultsMessage:{}},emits:["sort","show-details","edit","validate","perform","update-items-per-page","prev-page","next-page","toggle-select","toggle-select-all","clear-selection"],setup(nt,{emit:it}){const m=nt,P=it,w=pe();function l(){P("toggle-select-all")}function r(C){P("toggle-select",C)}function n(){P("clear-selection")}const a=C=>!C||C.trim()===""?(console.error("ERROR: Checking selection for empty case ID!"),!1):m.selectedIds.includes(C),{exportCasesToExcel:h,previewMultipleCases:_}=nr(),g=xt(!1);function y(){if(m.selectedIds.length!==0)try{const C=m.cases.filter(z=>m.selectedIds.includes(z.id));if(C.length===0)return;_(C)}catch{alert("Error al abrir la previsualización. Por favor, intente nuevamente.")}}async function o(){if(m.selectedIds.length!==0)try{const C=m.cases.filter(z=>m.selectedIds.includes(z.id));if(C.length===0)return;g.value=!0,await h(C,"selected")}catch{alert("Error al exportar a Excel. Por favor, intente nuevamente.")}finally{g.value=!1}}function c(){}function i(C){const z=(C==null?void 0:C.caseCode)||(C==null?void 0:C.id)||"";z&&(P("edit",C),w.push(`/cases/edit/${z}`))}function d(C){const z=(C==null?void 0:C.caseCode)||(C==null?void 0:C.id)||"";z&&(P("perform",C),w.push(`/results/perform?case=${z}&auto=1`))}function u(C){const z=(C==null?void 0:C.caseCode)||(C==null?void 0:C.id)||"";z&&(P("validate",C),w.push(`/results/sign?case=${z}&auto=1`))}function v(C){return C?new Date(C).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"}function x(C){const z=C.match(/^\d{6}/);return z?z[0]:C.split(" ")[0]}function A(C){const z={};return C.forEach(s=>{const k=x(s);z[k]=(z[k]||0)+1}),Object.entries(z).map(([s,k])=>({code:s,count:k}))}function E(C,z,s){const k=x(z),D=C.filter(et=>x(et)===k).map(et=>et.includes(" - ")?et.split(" - ").slice(1).join(" - "):et).filter(Boolean),X=Array.from(new Set(D));return`${X.length?X.join(", "):`Código ${k}`} • ${s} vez${s>1?"es":""}`}function N(C){if(!C.receivedAt)return 0;const z=new Date(C.receivedAt),s=C.deliveredAt?new Date(C.deliveredAt):new Date,k=Math.abs(s.getTime()-z.getTime());return Math.ceil(k/(1e3*60*60*24))}function $(C){const z=N(C);return C.status==="Requiere cambios"?"Requiere cambios":z>6&&C.status!=="Completado"?"URGENTE":C.status}function U(C){const z=N(C);return C.status==="Requiere cambios"||z>6&&C.status!=="Completado"?"bg-red-50 text-red-700 font-semibold":C.status==="Por firmar"?"bg-yellow-50 text-yellow-700":C.status==="Por entregar"?"bg-orange-50 text-orange-700":C.status==="En proceso"?"bg-blue-50 text-blue-700":C.status==="Completado"?"bg-green-50 text-green-700":""}function R(C){return N(C)>6&&C.status!=="Completado"?"bg-red-50 text-red-700":"bg-brand-50 text-brand-700"}return(C,z)=>(K(),J("div",ir,[C.selectedIds.length>0?(K(),J("div",ar,[b("div",or,[b("div",lr,[b("span",dr,Y(C.selectedIds.length)+" caso"+Y(C.selectedIds.length>1?"s":"")+" seleccionado"+Y(C.selectedIds.length>1?"s":""),1),b("button",{onClick:n,class:"text-sm text-blue-600 hover:text-blue-800 underline"}," Deseleccionar todo ")]),b("div",ur,[b("button",{onClick:y,class:"inline-flex items-center gap-2 px-3 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium"},[...z[5]||(z[5]=[b("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),kt(" Previsualizar PDFs ",-1)])]),b("button",{onClick:o,disabled:g.value,class:"inline-flex items-center gap-2 px-3 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"},[g.value?(K(),J("svg",fr,[...z[6]||(z[6]=[b("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),b("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(K(),Ut(mt(ne),{key:1,class:"w-4 h-4"})),kt(" "+Y(g.value?"Generando Excel...":"Exportar Excel Seleccionados"),1)],8,cr),b("button",{onClick:c,class:"inline-flex items-center gap-2 px-3 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium"},[...z[7]||(z[7]=[b("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),kt(" Marcar como entregados ",-1)])])])])])):dt("",!0),b("div",hr,[b("table",pr,[b("thead",null,[b("tr",mr,[b("th",gr,[b("div",vr,[ht(Zt,{"model-value":m.isAllSelected,id:`select-all-${m.selectedIds.length}-${m.cases.length}`,label:"","onUpdate:modelValue":l},null,8,["model-value","id"])])]),(K(!0),J(Ot,null,Tt(m.columns,s=>(K(),J("th",{key:s.key,class:Dt(["px-2 py-2 text-center text-gray-700",s.class])},[b("button",{class:"flex items-center gap-1 font-medium text-gray-600 text-sm hover:text-gray-700 justify-center w-full",onClick:k=>C.$emit("sort",s.key)},[kt(Y(s.label)+" ",1),C.sortKey===s.key?(K(),J("span",yr,Y(C.sortOrder==="asc"?"▲":"▼"),1)):dt("",!0)],8,_r)],2))),128))])]),b("tbody",br,[(K(!0),J(Ot,null,Tt(m.cases,(s,k)=>(K(),J("tr",{key:`case-${s.id}-${k}`,class:"hover:bg-gray-50",onClick:e=>r(s.id)},[b("td",xr,[b("div",kr,[ht(Zt,{"model-value":a(s.id),id:`case-${s.id}-${m.selectedIds.includes(s.id)}`,label:"","onUpdate:modelValue":()=>r(s.id),onClick:z[0]||(z[0]=St(()=>{},["stop"]))},null,8,["model-value","id","onUpdate:modelValue"])])]),b("td",Cr,[b("span",Sr,Y(s.caseCode||s.id),1)]),b("td",Ar,[b("div",null,[b("p",Er,Y(s.patient.fullName),1),b("p",zr,Y(s.patient.dni),1)])]),b("td",Ir,[b("p",Dr,Y(s.entity),1),b("p",Or,Y(s.pathologist||"No asignado"),1)]),b("td",Tr,[b("div",Br,[(K(!0),J(Ot,null,Tt(A(s.tests).slice(0,6),(e,D)=>(K(),J("span",{key:D,class:"test-badge inline-flex items-center justify-center bg-gray-100 text-gray-700 font-mono text-xs px-2 py-1 rounded border text-nowrap relative min-w-0 flex-shrink-0",title:E(s.tests,e.code,e.count)},[b("span",Pr,Y(x(e.code)),1),e.count>1?(K(),J("span",$r,Y(e.count),1)):dt("",!0)],8,Rr))),128)),A(s.tests).length>6?(K(),J("span",{key:0,class:"inline-flex items-center justify-center bg-blue-50 text-blue-600 font-mono text-xs px-2 py-1 rounded border",title:`${A(s.tests).length-6} pruebas más`}," +"+Y(A(s.tests).length-6),9,Nr)):dt("",!0)])]),b("td",Fr,[b("span",{class:Dt(["inline-flex items-center justify-center rounded-full px-3 py-1 text-xs font-medium w-full",U(s)])},Y($(s)),3),s.receivedAt?(K(),J("p",{key:0,class:Dt(["text-xs font-medium px-2 py-0.5 rounded-full inline-block mt-1",R(s)])},Y(N(s))+" días ",3)):dt("",!0)]),b("td",jr,[b("p",Lr,Y(v(s.receivedAt)),1)]),b("td",Ur,[s.deliveredAt?(K(),J("p",Mr,Y(v(s.deliveredAt)),1)):(K(),J("p",Vr,"Pendiente"))]),b("td",Zr,[b("div",Wr,[b("button",{class:"p-1.5 rounded-md hover:bg-gray-100 text-gray-600",onClick:St(e=>C.$emit("show-details",s),["stop"]),title:"Ver detalles"},[ht(mt(Qt),{class:"w-4 h-4"})],8,Hr),b("button",{class:"p-1.5 rounded-md hover:bg-gray-100 text-gray-600",onClick:St(e=>i(s),["stop"]),title:"Editar caso"},[ht(mt(Xt),{class:"w-4 h-4"})],8,qr),s.status==="En proceso"?(K(),J("button",{key:0,class:"p-1.5 rounded-md hover:bg-gray-100 text-gray-600",onClick:St(e=>d(s),["stop"]),title:"Realizar resultados"},[...z[8]||(z[8]=[b("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)])],8,Gr)):dt("",!0),["Por firmar","Requiere cambios"].includes(s.status)?(K(),J("button",{key:1,class:"p-1.5 rounded-md hover:bg-gray-100 text-gray-600",onClick:St(e=>u(s),["stop"]),title:s.status==="Por firmar"?"Realizar validación del informe":"Validar"},[s.status==="Por firmar"?(K(),J("svg",Kr,[...z[9]||(z[9]=[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"},null,-1)])])):(K(),J("svg",Xr,[...z[10]||(z[10]=[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])]))],8,Yr)):dt("",!0)])])],8,wr))),128)),m.cases.length===0?(K(),J("tr",Jr,[b("td",{colspan:m.columns.length+1,class:"px-5 py-8 text-center"},[b("p",ts,Y(C.noResultsMessage),1)],8,Qr)])):dt("",!0)])])]),b("div",es,[b("div",rs,[(K(!0),J(Ot,null,Tt(m.cases,(s,k)=>(K(),J("div",{key:`case-mobile-${s.id}-${k}`,class:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",onClick:e=>r(s.id)},[b("div",ns,[b("div",is,[ht(Zt,{"model-value":a(s.id),id:`case-mobile-${s.id}-${m.selectedIds.includes(s.id)}`,label:"","onUpdate:modelValue":()=>r(s.id),onClick:z[1]||(z[1]=St(()=>{},["stop"]))},null,8,["model-value","id","onUpdate:modelValue"]),b("div",null,[b("div",as,[b("h4",os,Y(s.caseCode||s.id),1)]),b("p",ls,Y(s.patient.fullName),1),b("p",ds,Y(s.patient.dni),1)])]),b("div",us,[b("span",{class:Dt(["inline-flex items-center justify-center rounded-full px-2 py-1 text-xs font-medium",U(s)])},Y($(s)),3)])]),b("div",cs,[b("div",null,[z[11]||(z[11]=b("p",{class:"text-gray-500"},"Entidad",-1)),b("p",fs,Y(s.entity),1)]),b("div",null,[z[12]||(z[12]=b("p",{class:"text-gray-500"},"Patólogo",-1)),b("p",hs,Y(s.pathologist||"No asignado"),1)]),b("div",null,[z[13]||(z[13]=b("p",{class:"text-gray-500"},"Fecha recepción",-1)),b("p",ps,Y(v(s.receivedAt)),1)]),b("div",null,[z[14]||(z[14]=b("p",{class:"text-gray-500"},"Días transcurridos",-1)),b("p",{class:Dt(["text-gray-800 font-medium",R(s)])},Y(N(s))+" días ",3)]),s.deliveredAt?(K(),J("div",ms,[z[15]||(z[15]=b("p",{class:"text-gray-500"},"Fecha entrega",-1)),b("p",gs,Y(v(s.deliveredAt)),1)])):dt("",!0)]),b("div",vs,[z[16]||(z[16]=b("p",{class:"text-gray-500 text-xs mb-2"},"Pruebas",-1)),b("div",_s,[(K(!0),J(Ot,null,Tt(A(s.tests).slice(0,6),(e,D)=>(K(),J("span",{key:D,class:"test-badge inline-flex items-center justify-center bg-gray-100 text-gray-700 font-mono text-xs px-2 py-1 rounded border relative min-w-0 flex-shrink-0",title:E(s.tests,e.code,e.count)},[b("span",bs,Y(x(e.code)),1),e.count>1?(K(),J("span",ws,Y(e.count),1)):dt("",!0)],8,ys))),128)),A(s.tests).length>6?(K(),J("span",{key:0,class:"inline-flex items-center justify-center bg-blue-50 text-blue-600 font-mono text-xs px-2 py-1 rounded border",title:`${A(s.tests).length-6} pruebas más`}," +"+Y(A(s.tests).length-6),9,xs)):dt("",!0)])]),b("div",ks,[b("button",{class:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors text-xs font-medium",onClick:St(e=>C.$emit("show-details",s),["stop"])},[ht(mt(Qt),{class:"w-3 h-3"}),z[17]||(z[17]=kt(" Ver detalles ",-1))],8,Cs),b("button",{class:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors text-xs font-medium",onClick:St(e=>i(s),["stop"])},[ht(mt(Xt),{class:"w-3 h-3"}),z[18]||(z[18]=kt(" Editar ",-1))],8,Ss),s.status==="En proceso"?(K(),J("button",{key:0,class:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors text-xs font-medium",onClick:St(e=>d(s),["stop"])},[...z[19]||(z[19]=[b("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),kt(" Realizar ",-1)])],8,As)):dt("",!0),["Por firmar","Requiere cambios"].includes(s.status)?(K(),J("button",{key:1,class:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors text-xs font-medium",onClick:St(e=>u(s),["stop"])},[s.status==="Por firmar"?(K(),J("svg",zs,[...z[20]||(z[20]=[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"},null,-1)])])):(K(),J("svg",Is,[...z[21]||(z[21]=[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])),z[22]||(z[22]=kt(" Validar ",-1))],8,Es)):dt("",!0)])],8,ss))),128)),m.cases.length===0?(K(),J("div",Ds,[b("div",Os,[z[23]||(z[23]=b("svg",{class:"w-12 h-12 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[b("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),b("div",Ts,[b("p",Bs,Y(C.noResultsMessage),1)])])])):dt("",!0)])]),b("div",Rs,[b("div",Ps,[b("div",$s,[z[29]||(z[29]=b("span",null,"Mostrando",-1)),b("select",{value:C.itemsPerPage,onChange:z[2]||(z[2]=s=>{var k;return C.$emit("update-items-per-page",Number((k=s.target)==null?void 0:k.value))}),class:"h-8 rounded-lg border border-gray-300 bg-white px-2 py-1 text-sm text-gray-700"},[z[24]||(z[24]=b("option",{value:5},"5",-1)),z[25]||(z[25]=b("option",{value:10},"10",-1)),z[26]||(z[26]=b("option",{value:20},"20",-1)),z[27]||(z[27]=b("option",{value:50},"50",-1)),z[28]||(z[28]=b("option",{value:100},"100",-1)),b("option",{value:C.totalItems},"Todos",8,Fs)],40,Ns),b("span",null,"de "+Y(C.totalItems)+" resultados",1)]),b("div",js,[b("button",{onClick:z[3]||(z[3]=s=>C.$emit("prev-page")),disabled:C.currentPage===1,class:"px-3 py-1.5 border rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors"},[...z[30]||(z[30]=[b("span",{class:"hidden sm:inline"},"Anterior",-1),b("span",{class:"sm:hidden"},"←",-1)])],8,Ls),b("div",Us,[z[31]||(z[31]=b("span",{class:"hidden sm:inline"},"Página",-1)),b("span",Ms,Y(C.currentPage),1),z[32]||(z[32]=b("span",{class:"hidden sm:inline"},"de",-1)),b("span",Vs,Y(C.totalPages),1),b("span",Zs,"/ "+Y(C.totalPages),1)]),b("button",{onClick:z[4]||(z[4]=s=>C.$emit("next-page")),disabled:C.currentPage===C.totalPages,class:"px-3 py-1.5 border rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors"},[...z[33]||(z[33]=[b("span",{class:"hidden sm:inline"},"Siguiente",-1),b("span",{class:"sm:hidden"},"→",-1)])],8,Ws)])])])]))}}),ii=Gt(Hs,[["__scopeId","data-v-48ece4bf"]]),qs={class:"relative bg-white w-full max-w-4xl rounded-t-2xl sm:rounded-2xl shadow-2xl h-[85vh] sm:h-auto sm:max-h-[90vh] overflow-y-auto overflow-x-hidden"},Gs={class:"sticky top-0 z-10 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl flex items-center justify-between"},Ys={class:"p-6 space-y-6"},Ks={class:"grid grid-cols-2 gap-4 bg-gray-50 rounded-xl p-4"},Xs={class:"text-base font-medium text-gray-900"},Js={class:"text-base font-medium text-gray-900"},Qs={class:"text-base font-medium text-gray-900"},tn={class:"text-base font-medium text-gray-900"},en={class:"text-base font-medium text-gray-900"},rn={class:"text-base font-medium text-gray-900"},sn={class:"text-base font-medium text-gray-900 capitalize"},nn={class:"text-base font-medium text-gray-900"},an={class:"grid grid-cols-3 gap-4 bg-gray-50 rounded-xl p-4"},on={class:"text-base font-medium text-gray-900"},ln={class:"text-base font-medium text-gray-900"},dn={class:"text-base font-medium text-gray-900"},un={class:"bg-gray-50 rounded-xl p-4 space-y-3"},cn={key:0,class:"space-y-3"},fn={class:"flex items-center justify-between mb-2"},hn={class:"text-sm font-medium text-gray-900"},pn={class:"flex flex-wrap gap-2"},mn=["title"],gn={key:0,class:"absolute -top-1 -right-1 inline-flex items-center justify-center w-4 h-4 rounded-full bg-blue-100 text-blue-600 text-[10px] font-bold"},vn={key:1,class:"text-sm text-gray-500"},_n={key:0,class:"bg-gray-50 rounded-xl p-4 space-y-3"},yn={key:0,class:"border border-gray-200 rounded-lg p-3 bg-white"},bn={class:"text-sm font-medium text-gray-900 break-words"},wn={key:1,class:"border border-gray-200 rounded-lg p-3 bg-white"},xn={class:"text-sm text-gray-800 break-words"},kn={key:2,class:"border border-gray-200 rounded-lg p-3 bg-white"},Cn={class:"text-sm text-gray-800 break-words"},Sn={key:3,class:"border border-gray-200 rounded-lg p-3 bg-white"},An={class:"text-sm text-gray-800 break-words"},En={key:1,class:"bg-gray-50 rounded-xl p-4 space-y-3"},zn={key:0,class:"border border-gray-200 rounded-lg p-3 bg-white"},In={class:"flex items-center gap-2 mb-2"},Dn={class:"text-sm font-mono text-gray-600"},On={class:"text-sm text-gray-800"},Tn={key:1,class:"border border-gray-200 rounded-lg p-3 bg-white"},Bn={class:"flex items-center gap-2 mb-2"},Rn={class:"text-sm font-mono text-gray-600"},Pn={class:"text-sm text-gray-800"},$n={class:"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 rounded-b-2xl flex flex-col sm:flex-row sm:justify-between gap-3"},Nn={class:"flex gap-2"},Fn={class:"flex gap-2 justify-end"},ai=Rt({__name:"CaseDetailsModal",props:{caseItem:{}},emits:["close","edit","preview"],setup(nt){function it(r){return r?new Date(r).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"}const{isExpanded:m,isMobileOpen:P,isHovered:w}=Ce(),l=It(()=>m.value&&!P.value||!m.value&&w.value?"left-0 lg:left-72":"left-0 lg:left-20");return(r,n)=>(K(),Ut(me,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:At(()=>{var a,h,_,g,y,o,c,i,d,u,v,x,A,E,N,$,U,R,C,z,s;return[r.caseItem?(K(),J("div",{key:0,class:Dt(["fixed right-0 bottom-0 z-[9999] flex items-end sm:items-center justify-center p-2 sm:p-4 bg-black/40","top-16",l.value]),onClick:n[4]||(n[4]=St(k=>r.$emit("close"),["self"]))},[b("div",qs,[b("div",Gs,[n[5]||(n[5]=b("h3",{class:"text-xl font-semibold text-gray-900"},"Detalles del Caso",-1)),b("button",{onClick:n[0]||(n[0]=k=>r.$emit("close")),class:"text-gray-400 hover:text-gray-600"},"✕")]),b("div",Ys,[b("div",Ks,[b("div",null,[n[6]||(n[6]=b("p",{class:"text-sm text-gray-500"},"Código del Caso",-1)),b("p",Xs,Y(((a=r.caseItem)==null?void 0:a.caseCode)||((h=r.caseItem)==null?void 0:h.id)||"N/A"),1)]),b("div",null,[n[7]||(n[7]=b("p",{class:"text-sm text-gray-500"},"Estado",-1)),b("p",Js,Y(((_=r.caseItem)==null?void 0:_.status)||"N/A"),1)]),b("div",null,[n[8]||(n[8]=b("p",{class:"text-sm text-gray-500"},"Nombre del Paciente",-1)),b("p",Qs,Y(((y=(g=r.caseItem)==null?void 0:g.patient)==null?void 0:y.fullName)||"N/A"),1)]),b("div",null,[n[9]||(n[9]=b("p",{class:"text-sm text-gray-500"},"Cédula",-1)),b("p",tn,Y(((c=(o=r.caseItem)==null?void 0:o.patient)==null?void 0:c.dni)||"N/A"),1)]),b("div",null,[n[10]||(n[10]=b("p",{class:"text-sm text-gray-500"},"Edad",-1)),b("p",en,Y((d=(i=r.caseItem)==null?void 0:i.patient)!=null&&d.age?`${r.caseItem.patient.age} años`:"No especificada"),1)]),b("div",null,[n[11]||(n[11]=b("p",{class:"text-sm text-gray-500"},"Sexo",-1)),b("p",rn,Y(((v=(u=r.caseItem)==null?void 0:u.patient)==null?void 0:v.sex)||"No especificado"),1)]),b("div",null,[n[12]||(n[12]=b("p",{class:"text-sm text-gray-500"},"Tipo de Atención",-1)),b("p",sn,Y(((A=(x=r.caseItem)==null?void 0:x.patient)==null?void 0:A.attentionType)||"N/A"),1)]),b("div",null,[n[13]||(n[13]=b("p",{class:"text-sm text-gray-500"},"Entidad",-1)),b("p",nn,Y(((N=(E=r.caseItem)==null?void 0:E.patient)==null?void 0:N.entity)||"No especificada"),1)])]),b("div",an,[b("div",null,[n[14]||(n[14]=b("p",{class:"text-sm text-gray-500"},"Fecha de Creación",-1)),b("p",on,Y(($=r.caseItem)!=null&&$.receivedAt?it(r.caseItem.receivedAt):"N/A"),1)]),b("div",null,[n[15]||(n[15]=b("p",{class:"text-sm text-gray-500"},"Fecha de Entrega",-1)),b("p",ln,Y((U=r.caseItem)!=null&&U.deliveredAt?it(r.caseItem.deliveredAt):"Pendiente"),1)]),b("div",null,[n[16]||(n[16]=b("p",{class:"text-sm text-gray-500"},"Patólogo Asignado",-1)),b("p",dn,Y(((R=r.caseItem)==null?void 0:R.pathologist)||"Sin asignar"),1)])]),b("div",un,[n[18]||(n[18]=b("h5",{class:"text-sm font-medium text-gray-700"},"Muestras y Pruebas",-1)),(C=r.caseItem)!=null&&C.subsamples&&r.caseItem.subsamples.length?(K(),J("div",cn,[(K(!0),J(Ot,null,Tt(r.caseItem.subsamples,(k,e)=>(K(),J("div",{key:e,class:"border border-gray-200 rounded-lg p-3 bg-white"},[b("div",fn,[n[17]||(n[17]=b("p",{class:"text-sm text-gray-600"},"Región del cuerpo",-1)),b("p",hn,Y(k.bodyRegion||"No especificada"),1)]),b("div",pn,[(K(!0),J(Ot,null,Tt(k.tests,(D,X)=>(K(),J("span",{key:X,class:"relative inline-flex items-center justify-center bg-gray-100 text-gray-700 font-mono text-xs pl-2 pr-6 py-0.5 rounded border text-nowrap",title:D.name&&D.name!==D.id?D.name:""},[kt(Y(D.id)+" - "+Y(D.name||D.id)+" ",1),D.quantity>1?(K(),J("span",gn,Y(D.quantity),1)):dt("",!0)],8,mn))),128))])]))),128))])):(K(),J("div",vn,"Sin muestras registradas"))]),(z=r.caseItem)!=null&&z.result&&(r.caseItem.result.method||r.caseItem.result.macro||r.caseItem.result.micro||r.caseItem.result.diagnosis)?(K(),J("div",_n,[n[23]||(n[23]=b("h5",{class:"text-sm font-medium text-gray-700"},"Resultado del Informe",-1)),r.caseItem.result.method?(K(),J("div",yn,[n[19]||(n[19]=b("div",{class:"mb-2"},[b("p",{class:"text-sm text-gray-600"},"Método")],-1)),b("p",bn,Y(r.caseItem.result.method),1)])):dt("",!0),r.caseItem.result.macro?(K(),J("div",wn,[n[20]||(n[20]=b("div",{class:"mb-2"},[b("p",{class:"text-sm text-gray-600"},"Resultado Macroscópico")],-1)),b("p",xn,Y(r.caseItem.result.macro),1)])):dt("",!0),r.caseItem.result.micro?(K(),J("div",kn,[n[21]||(n[21]=b("div",{class:"mb-2"},[b("p",{class:"text-sm text-gray-600"},"Resultado Microscópico")],-1)),b("p",Cn,Y(r.caseItem.result.micro),1)])):dt("",!0),r.caseItem.result.diagnosis?(K(),J("div",Sn,[n[22]||(n[22]=b("div",{class:"mb-2"},[b("p",{class:"text-sm text-gray-600"},"Diagnóstico")],-1)),b("p",An,Y(r.caseItem.result.diagnosis),1)])):dt("",!0)])):dt("",!0),(s=r.caseItem)!=null&&s.result&&(r.caseItem.result.diagnostico_cie10||r.caseItem.result.diagnostico_cieo)?(K(),J("div",En,[n[26]||(n[26]=b("h5",{class:"text-sm font-medium text-gray-700"},"Diagnósticos Clasificados",-1)),r.caseItem.result.diagnostico_cie10?(K(),J("div",zn,[b("div",In,[n[24]||(n[24]=b("span",{class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"}," CIE-10 ",-1)),b("span",Dn,Y(r.caseItem.result.diagnostico_cie10.codigo),1)]),b("p",On,Y(r.caseItem.result.diagnostico_cie10.nombre),1)])):dt("",!0),r.caseItem.result.diagnostico_cieo?(K(),J("div",Tn,[b("div",Bn,[n[25]||(n[25]=b("span",{class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"}," CIE-O ",-1)),b("span",Rn,Y(r.caseItem.result.diagnostico_cieo.codigo),1)]),b("p",Pn,Y(r.caseItem.result.diagnostico_cieo.nombre),1)])):dt("",!0)])):dt("",!0)]),b("div",$n,[b("div",Nn,[ht(ze,{text:"Previsualizar Informe",onClick:n[1]||(n[1]=k=>r.$emit("preview",r.caseItem))})]),b("div",Fn,[ht(Jt,{variant:"secondary",text:"Cerrar",onAction:n[2]||(n[2]=k=>r.$emit("close"))}),ht(Jt,{text:"Editar Caso",onAction:n[3]||(n[3]=k=>r.$emit("edit",r.caseItem))})])])])],2)):dt("",!0)]}),_:1}))}}),jn=ae.ENDPOINTS.CASES;async function Ln(nt={}){const it=[];let m=0;const P=1e3;for(;;){const w={skip:m,limit:P,...nt},l=await ie.get(`${jn}/`,{params:w});if(!l||l.length===0||(it.push(...l),l.length<P))break;m+=P}return it}async function Un(){return await ie.get(`${ae.ENDPOINTS.TESTS}/`)}function wt(nt){return(nt||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim()}function Ht(nt){return nt?new Date(nt).toISOString().split("T")[0]:""}function qt(nt){if(!nt)return"";const[it,m,P]=nt.split("/");return!it||!m||!P?"":`${P}-${m.padStart(2,"0")}-${it.padStart(2,"0")}`}function oi(){const nt=xt([]),it=xt(!1),m=xt(null),P=Lt(),w=Ie(),l=xt({searchQuery:"",searchPathologist:"",dateFrom:P.dateFrom,dateTo:P.dateTo,selectedEntity:"",selectedStatus:"",selectedTest:""}),r=xt("caseCode"),n=xt("desc"),a=xt(1),h=xt(10),_=xt([]),g=xt(null);async function y(){it.value=!0,m.value=null;try{const s=new Map;try{(await Un()).forEach(D=>{D.isActive!==!1&&s.set(D.pruebaCode,D.pruebasName)})}catch{}const k=await Ln();nt.value=k.map(e=>o(e,s))}catch{m.value="Error al cargar los casos",nt.value=[]}finally{it.value=!1}}function o(s,k){var tt,q,H,ct,vt,at,ot,gt,ft,bt,_t,t,F,B,p,f,S,j,L,I,Z,G,W,Q,lt;const e=rt=>rt?typeof rt=="string"?rt:rt!=null&&rt.$date?rt.$date:"":"",D=typeof s._id=="string"?s._id:((tt=s._id)==null?void 0:tt.$oid)||s.CasoCode||s.caso_code||`case-${Math.random().toString(36).substr(2,9)}`,X=e(s.fecha_creacion),M=e(s.fecha_entrega)||e(s.fecha_firma)||e((q=s.resultado)==null?void 0:q.fecha_resultado),et=[],V=[];Array.isArray(s.muestras)&&s.muestras.forEach(rt=>{var zt;const pt=[];(zt=rt.pruebas)==null||zt.forEach(yt=>{const Ct=yt.id||"",ut=yt.nombre||k.get(Ct)||"";Ct&&et.push(ut?`${Ct} - ${ut}`:Ct),pt.push({id:Ct,name:ut||Ct,quantity:yt.cantidad||1})}),V.push({bodyRegion:rt.region_cuerpo||"",tests:pt})});const T=(rt=>{const pt=String(rt||"").toLowerCase();return pt.includes("firmar")?"Por firmar":pt.includes("entregar")?"Por entregar":pt.includes("complet")?"Completado":pt.includes("cambio")?"Requiere cambios":pt.includes("pend")||!pt?"En proceso":rt||"En proceso"})(s.estado),O=T==="Por entregar"?"":M;return{id:D,caseCode:s.CasoCode||s.caso_code||D,sampleType:((ct=(H=s.muestras)==null?void 0:H[0])==null?void 0:ct.region_cuerpo)||((vt=s.paciente)==null?void 0:vt.tipo_atencion)||"",patient:{id:((at=s.paciente)==null?void 0:at.codigo)||D,dni:((ot=s.paciente)==null?void 0:ot.cedula)||"",fullName:((gt=s.paciente)==null?void 0:gt.nombre)||"",sex:((ft=s.paciente)==null?void 0:ft.sexo)||"",age:Number(((bt=s.paciente)==null?void 0:bt.edad)||0),entity:((t=(_t=s.paciente)==null?void 0:_t.entidad_info)==null?void 0:t.nombre)||"",attentionType:((F=s.paciente)==null?void 0:F.tipo_atencion)||"",notes:((B=s.paciente)==null?void 0:B.observaciones)||"",createdAt:e(s.fecha_creacion),updatedAt:e(s.fecha_actualizacion)},entity:((f=(p=s.paciente)==null?void 0:p.entidad_info)==null?void 0:f.nombre)||"",requester:typeof s.medico_solicitante=="string"?s.medico_solicitante:((S=s.medico_solicitante)==null?void 0:S.nombre)||"",status:T,receivedAt:X,deliveredAt:O,tests:et,pathologist:((j=s.patologo_asignado)==null?void 0:j.nombre)||"",notes:s.observaciones_generales||"",servicio:s.servicio||"",result:{method:((L=s.resultado)==null?void 0:L.metodo)||"",macro:((I=s.resultado)==null?void 0:I.resultado_macro)||"",micro:((Z=s.resultado)==null?void 0:Z.resultado_micro)||"",diagnosis:((G=s.resultado)==null?void 0:G.diagnostico)||"",resultDate:e((W=s.resultado)==null?void 0:W.fecha_resultado),diagnostico_cie10:((Q=s.resultado)==null?void 0:Q.diagnostico_cie10)||null,diagnostico_cieo:((lt=s.resultado)==null?void 0:lt.diagnostico_cieo)||null},subsamples:V}}const c=It(()=>{let s=nt.value;if(l.value.searchQuery){const k=wt(l.value.searchQuery);s=s.filter(e=>wt(e.id).includes(k)||wt(e.caseCode||"").includes(k)||wt(e.patient.dni).includes(k)||wt(e.patient.fullName).includes(k))}if(l.value.searchPathologist){const k=wt(l.value.searchPathologist);s=s.filter(e=>wt(e.pathologist||"").includes(k))}if(l.value.dateFrom){const k=qt(l.value.dateFrom);s=s.filter(e=>!!e.receivedAt&&Ht(e.receivedAt)>=k)}if(l.value.dateTo){const k=qt(l.value.dateTo);s=s.filter(e=>!!e.receivedAt&&Ht(e.receivedAt)<=k)}if(l.value.selectedEntity){const k=wt(l.value.selectedEntity);s=s.filter(e=>wt(e.entity).includes(k))}if(l.value.selectedStatus){const k=wt(l.value.selectedStatus);s=s.filter(e=>wt(e.status).includes(k))}if(l.value.selectedTest){const k=wt(l.value.selectedTest);s=s.filter(e=>e.tests.some(D=>wt(D).includes(k)))}return s=[...s].sort((k,e)=>{let D=k[r.value],X=e[r.value];return(r.value==="receivedAt"||r.value==="deliveredAt")&&(D=new Date(D),X=new Date(X)),D<X?n.value==="asc"?-1:1:D>X?n.value==="asc"?1:-1:0}),s}),i=It(()=>Math.ceil(c.value.length/h.value)||1),d=It(()=>{const s=(a.value-1)*h.value,k=s+h.value;return c.value.slice(s,k)}),u=It(()=>d.value.length===0?!1:d.value.every(s=>_.value.includes(s.id)));function v(){if(u.value)_.value=_.value.filter(s=>!d.value.some(k=>k.id===s));else{const s=d.value.map(k=>k.id);_.value=[...new Set([..._.value,...s])]}}function x(s){if(!s||s.trim()==="")return;const k=_.value.indexOf(s);k===-1?_.value.push(s):_.value.splice(k,1)}function A(s){r.value===s?n.value=n.value==="asc"?"desc":"asc":(r.value=s,n.value="asc")}function E(s,k){nt.value=nt.value.map(e=>{if(k.includes(e.id)){let D=s;return s==="en-proceso"&&(D="En proceso"),s==="por-firmar"&&(D="Por firmar"),s==="por-entregar"&&(D="Por entregar"),s==="completado"&&(D="Completado"),s==="requiere-cambios"&&(D="Requiere cambios"),{...e,status:D}}return e}),_.value=[]}function N(s){g.value=s}function $(){g.value=null}function U(s){var e;const k=nt.value.findIndex(D=>D.id===s.id);k!==-1&&(nt.value[k].status="Validado"),((e=g.value)==null?void 0:e.id)===s.id&&(g.value.status="Validado")}function R(s){var e;const k=nt.value.findIndex(D=>D.id===s.id);k!==-1&&nt.value[k].status==="Por firmar"&&(nt.value[k].status="Completado"),((e=g.value)==null?void 0:e.id)===s.id&&g.value.status==="Por firmar"&&(g.value.status="Completado")}function C(){const s=Lt();l.value={searchQuery:"",searchPathologist:"",dateFrom:s.dateFrom,dateTo:s.dateTo,selectedEntity:"",selectedStatus:"",selectedTest:""}}Bt(l,()=>{a.value=1},{deep:!0}),Bt(h,()=>{a.value=1});const z=s=>{y()};return Bt(()=>w.needsRefresh,s=>{s&&y().then(()=>{w.markRefreshed()})}),Bt(()=>w.lastUpdate,()=>{y()}),ee(()=>{y(),window.addEventListener("case-created",z)}),ge(()=>{window.removeEventListener("case-created",z)}),{cases:nt,isLoading:it,error:m,filters:l,sortKey:r,sortOrder:n,currentPage:a,itemsPerPage:h,selectedCaseIds:_,selectedCase:g,filteredCases:c,paginatedCases:d,totalPages:i,isAllSelected:u,loadCases:y,toggleSelectAll:v,toggleSelect:x,sortBy:A,applyBulkAction:E,showDetails:N,closeDetails:$,validateCase:U,markAsCompleted:R,clearFilters:C,toYYYYMMDD:Ht,ddmmyyyyToISO:qt,getDefaultDateRange:Lt}}function li(){async function nt(it){const m=it.map(r=>({"ID Caso":r.id,"Tipo de Muestra":r.sampleType,Paciente:r.patient.fullName,DNI:r.patient.dni,Entidad:r.entity,Médico:r.requester,Estado:r.status,"Fecha Recepción":r.receivedAt,"Fecha Entrega":r.deliveredAt||"",Pruebas:r.tests.join(", ")})),P=await re(()=>import("./xlsx-D_0l8YDs.js"),[]),w=P.utils.json_to_sheet(m),l=P.utils.book_new();P.utils.book_append_sheet(l,w,"Casos"),P.writeFile(l,"cases.xlsx")}return{exportCasesToExcel:nt}}export{ii as C,si as _,Wt as a,ni as b,ai as c,li as d,oi as u};
