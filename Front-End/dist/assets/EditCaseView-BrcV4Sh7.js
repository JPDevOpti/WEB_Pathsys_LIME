import{d as Be,r as p,G as Ge,c as ze,k as Pe,o as We,b as _,e as m,h as e,q as Ve,g as P,i as ke,f as g,u as s,I as Je,j as J,t as c,J as Ae,F as Ne,l as Me,H as Qe,w as re,v as Xe,K as xo}from"./index-CAHFE_9E.js";import{b as ho}from"./PathologistList.vue_vue_type_style_index_0_scoped_45f5ffeb_lang-FwbajLSj.js";import{_ as yo,C as Ke}from"./DiseaseList.vue_vue_type_style_index_0_scoped_2e8ef3ac_lang-CSxq79ax.js";/* empty css                                                                   */import{_ as D,a as Ze}from"./SearchButton.vue_vue_type_script_setup_true_lang-y2wCoroa.js";import{F as Se}from"./FormSelect-Dz8sviG5.js";import{_ as De,a as eo}from"./Notification.vue_vue_type_script_setup_true_lang-Dr_eoe6-.js";import{_ as Ee,a as oo}from"./ClearButton.vue_vue_type_script_setup_true_lang-iqMnWNPk.js";import{u as Co,B as ko,_ as wo,a as zo,p as fe}from"./BodyRegionList-BxiVbBtb.js";import{P as Po}from"./PathologistList-CbsQJHAr.js";import{E as to}from"./EntityList-gIDUOf46.js";import{T as Vo}from"./TestList-BA4OK-D1.js";import{u as ao}from"./useNotifications-DFiSmdMU.js";import{c as we}from"./casesApi.service-DwGpQD03.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ao={class:"space-y-4"},So={key:0,class:"bg-gray-50 rounded-lg border border-gray-200"},Eo={class:"px-4 pt-4 pb-4"},qo={class:"flex flex-col sm:flex-row gap-3 sm:gap-4 items-stretch sm:items-end"},$o={class:"flex-1"},No={key:0,class:"mt-1 text-xs text-red-600"},Mo={class:"flex gap-2 sm:gap-3"},Bo={key:0,class:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg"},jo={class:"flex items-center"},Uo={class:"text-sm text-red-600"},To={key:1,class:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg"},Lo={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 text-sm"},Fo={class:"text-green-800 font-mono"},Oo={class:"text-green-800 break-words"},Ro={class:"text-green-800 font-mono"},Io={class:"text-green-800"},Yo={class:"text-green-800 break-words"},Ho={class:"text-green-800 break-words"},Ko={key:1,class:"bg-blue-50 border border-blue-200 rounded-lg p-6 text-center"},Go={key:2,class:"space-y-6"},Wo={class:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6"},Jo={class:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6"},Qo={class:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6"},Xo={class:"max-w-md"},Zo={key:0,class:"space-y-4"},Do={class:"space-y-6"},et={class:"font-medium text-gray-700 mb-4"},ot={class:"mb-4"},tt={class:"space-y-3"},at={class:"flex items-center justify-between"},nt={class:"space-y-2"},it={class:"flex-1 min-w-0"},st={class:"w-full sm:w-24"},lt={class:"flex items-end justify-center sm:w-10 pb-1"},rt={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},dt={class:"relative p-4 sm:p-5 bg-white border border-gray-200 rounded-lg shadow-sm"},ut={class:"space-y-4"},ct={class:"text-center pb-3 border-b border-gray-200"},mt={class:"font-mono font-bold text-2xl text-gray-900"},pt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},gt={class:"space-y-2 text-sm"},vt={class:"text-gray-900 font-semibold"},bt={class:"text-gray-900 font-mono font-semibold"},ft={class:"text-gray-900 font-semibold"},_t={class:"text-gray-900 font-semibold"},xt={class:"text-gray-900 font-semibold"},ht={class:"text-gray-900 font-semibold"},yt={class:"space-y-2 text-sm"},Ct={class:"text-gray-900 font-semibold"},kt={class:"text-gray-900 font-semibold"},wt={class:"text-gray-900 font-semibold"},zt={class:"text-gray-900 font-semibold"},Pt={key:0},Vt={class:"text-gray-900"},At={class:"space-y-3"},St={class:"flex items-center justify-between mb-2"},Et={class:"font-medium text-gray-900 text-sm"},qt={class:"text-sm text-gray-500"},$t={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm"},Nt={class:"text-gray-900"},Mt={class:"text-gray-900"},Bt={key:0},jt={key:1,class:"text-gray-400"},Ut=Be({__name:"EditCaseForm",props:{caseCodeProp:{}},emits:["case-updated"],setup(_e,{emit:pe}){const B=_e,de=pe,{notification:C,showSuccess:ee,showError:G,closeNotification:Y}=ao(),$=Co(),{createEmptySubSample:F}=$,V=p(!1),j=p(null),A=p(null),U=p(!1),x=p(null),z=p(null),O=p(!1),r=p(0),ge=p(""),T=p(""),ie=p(!1),R=p(""),L=p(!1),v=p(null),n=Ge({pacienteCedula:"",fechaIngreso:"",medicoSolicitante:"",servicio:"",entidadPaciente:"",tipoAtencionPaciente:"",numeroMuestras:"0",muestras:[],observaciones:"",estado:"",patologoAsignado:""}),xe=[{value:"ambulatorio",label:"Ambulatorio"},{value:"hospitalizado",label:"Hospitalizado"}],he=[{value:"En proceso",label:"En proceso"},{value:"Por firmar",label:"Por firmar"},{value:"Por entregar",label:"Por entregar"},{value:"Completado",label:"Completado"},{value:"cancelado",label:"Cancelado"}],ve=ze(()=>n.fechaIngreso.trim()!==""&&n.entidadPaciente.trim()!==""&&n.tipoAtencionPaciente!==""&&n.estado!==""&&n.numeroMuestras!==""),qe=t=>{if(!t)return"";const o=String(t).toLowerCase();return o.includes("ambulator")?"ambulatorio":o.includes("hospital")?"hospitalizado":""},$e=t=>{if(!t)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const o=new Date(t);return isNaN(o.getTime())?"":o.toISOString().split("T")[0]},ye=t=>{if(!t)return"";const o=new Set(["cabeza","cuello","cara","cuero_cabelludo","oreja","nariz","boca","lengua","garganta","tiroides","torax","mama_derecha","mama_izquierda","pulmon_derecho","pulmon_izquierdo","corazon","mediastino","abdomen","estomago","intestino_delgado","intestino_grueso","colon","recto","higado","vesicula_biliar","pancreas","bazo","rinon_derecho","rinon_izquierdo","vejiga","utero","ovario_derecho","ovario_izquierdo","prostata","testiculo_derecho","testiculo_izquierdo","brazo_derecho","brazo_izquierdo","antebrazo_derecho","antebrazo_izquierdo","mano_derecha","mano_izquierda","dedo_derecho","dedo_izquierdo","muslo_derecho","muslo_izquierdo","pierna_derecha","pierna_izquierda","pie_derecho","pie_izquierdo","dedo_pie_derecho","dedo_pie_izquierdo","piel_cabeza","piel_torax","piel_abdomen","piel_brazo","piel_pierna","piel_espalda","piel_gluteo","ganglio_cervical","ganglio_axilar","ganglio_inguinal","ganglio_mediastinico","ganglio_abdominal","otro","no_especificado"]),u=String(t).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"_").replace(/[-]+/g,"_").replace(/__+/g,"_").trim(),f={piel_de_torax:"piel_torax",piel_de_abdomen:"piel_abdomen",piel_de_brazo:"piel_brazo",piel_de_pierna:"piel_pierna",piel_de_espalda:"piel_espalda",piel_de_gluteo:"piel_gluteo"};if(u in f)return f[u];const k=u.replace(/^el_/,"").replace(/^la_/,"").replace(/^los_/,"").replace(/^las_/,"").replace(/_de_/g,"_").replace(/_del_/g,"_");if(o.has(u))return u;if(o.has(k))return k;const i=I=>k.includes(I),h=i("derech")?"derecho":i("izqu")?"izquierdo":"";return i("torax")?"torax":i("mama")?h==="izquierdo"?"mama_izquierda":"mama_derecha":i("pulmon")?h==="izquierdo"?"pulmon_izquierdo":"pulmon_derecho":i("rinon")?h==="izquierdo"?"rinon_izquierdo":"rinon_derecho":i("ovario")?h==="izquierdo"?"ovario_izquierdo":"ovario_derecho":i("testiculo")?h==="izquierdo"?"testiculo_izquierdo":"testiculo_derecho":i("brazo")?h==="izquierdo"?"brazo_izquierdo":"brazo_derecho":i("antebrazo")?h==="izquierdo"?"antebrazo_izquierdo":"antebrazo_derecho":i("mano")?h==="izquierdo"?"mano_izquierda":"mano_derecha":i("muslo")?h==="izquierdo"?"muslo_izquierdo":"muslo_derecho":i("pierna")?h==="izquierdo"?"pierna_izquierda":"pierna_derecha":i("pie")?h==="izquierdo"?"pie_izquierdo":"pie_derecho":i("dedo_pie")?h==="izquierdo"?"dedo_pie_izquierdo":"dedo_pie_derecho":i("abdomen")?"abdomen":i("colon")?"colon":i("recto")?"recto":i("higado")?"higado":i("vesicula")?"vesicula_biliar":i("pancreas")?"pancreas":i("bazo")?"bazo":i("vejiga")?"vejiga":i("utero")?"utero":i("prostata")?"prostata":i("intestino_delgado")?"intestino_delgado":i("intestino_grueso")?"intestino_grueso":i("ganglio")&&i("cervical")?"ganglio_cervical":i("ganglio")&&i("axilar")?"ganglio_axilar":i("ganglio")&&i("inguinal")?"ganglio_inguinal":i("ganglio")&&i("mediastinico")?"ganglio_mediastinico":i("ganglio")&&i("abdominal")?"ganglio_abdominal":"no_especificado"},Ce=async()=>{var t;if(B.caseCodeProp){V.value=!0;try{const o=await we.getCaseByCode(B.caseCodeProp);await Q(o)}catch(o){console.error("=== ERROR AL CARGAR CASO ==="),console.error("Error completo:",o),console.error("Mensaje:",o.message),console.error("Response:",(t=o.response)==null?void 0:t.data),G("Error al cargar los datos del caso",o.message||"Error desconocido")}finally{V.value=!1}}},l=async()=>{var u,f,k,i,h,I,d,E,w,N,M,oe,te,ae,ne;const t=B.caseCodeProp||((u=v.value)==null?void 0:u.CasoCode);if(!ve.value){if(O.value){O.value=!1;return}G("Datos incompletos","Por favor complete todos los campos requeridos");return}if(!t){G("Caso no identificado","Debe buscar un caso primero para poder editar sus datos");return}const o=n.pacienteCedula||((k=(f=v.value)==null?void 0:f.paciente)==null?void 0:k.cedula);if(!o){G("Información incompleta","No se encontró información del paciente para este caso");return}V.value=!0;try{const W=(()=>{var q,Z,Te,Le,Fe,Oe,Re,Ie,Ye;if((q=S.value)!=null&&q.codigo&&((Z=S.value)!=null&&Z.nombre))return{codigo:S.value.codigo,nombre:S.value.nombre};const y=((Te=v.value)==null?void 0:Te.entidad_info)||((Fe=(Le=v.value)==null?void 0:Le.paciente)==null?void 0:Fe.entidad_info);if(y!=null&&y.codigo&&(y!=null&&y.nombre))return{codigo:y.codigo,nombre:y.nombre};if(n.entidadPaciente){const He=((Oe=S.value)==null?void 0:Oe.nombre)||((Ye=(Ie=(Re=v.value)==null?void 0:Re.paciente)==null?void 0:Ie.entidad_info)==null?void 0:Ye.nombre)||"";if(He)return{codigo:n.entidadPaciente,nombre:He}}})(),se=y=>({ambulatorio:"Ambulatorio",hospitalizado:"Hospitalizado"})[y]||y,le={estado:n.estado,medico_solicitante:n.medicoSolicitante?{nombre:n.medicoSolicitante}:void 0,servicio:n.servicio||void 0,observaciones_generales:n.observaciones,muestras:n.muestras.map(y=>({region_cuerpo:y.regionCuerpo,pruebas:y.pruebas.filter(q=>String(q.code).trim()!=="").map(q=>({id:q.code,nombre:q.nombre||q.code,cantidad:q.cantidad||1}))})),patologo_asignado:n.patologoAsignado?{codigo:n.patologoAsignado,nombre:((i=ue.value)==null?void 0:i.nombre)||""}:void 0,entidad_info:W,paciente:{codigo:((h=x.value)==null?void 0:h.codigo)||o,cedula:o,nombre:((I=x.value)==null?void 0:I.nombre)||"",edad:((d=x.value)==null?void 0:d.edad)||0,sexo:((E=x.value)==null?void 0:E.sexo)||"",entidad_info:W||{codigo:n.entidadPaciente,nombre:((w=S.value)==null?void 0:w.nombre)||""},tipo_atencion:se(n.tipoAtencionPaciente),observaciones:((N=x.value)==null?void 0:N.observaciones)||""}},K=await we.updateCase(t,le),X=(()=>{var q;const y=String(((q=x.value)==null?void 0:q.sexo)||"").toLowerCase();return y.startsWith("m")?"masculino":y.startsWith("f")?"femenino":""})(),me={numeroCedula:o,nombrePaciente:String(((M=x.value)==null?void 0:M.nombre)||""),sexo:X,edad:String(((oe=x.value)==null?void 0:oe.edad)||""),entidad:String(((te=S.value)==null?void 0:te.nombre)||((ne=(ae=v.value)==null?void 0:ae.entidad_info)==null?void 0:ne.nombre)||""),entidadCodigo:n.entidadPaciente,tipoAtencion:n.tipoAtencionPaciente,observaciones:""};try{await fe.updatePatient(o,me)}catch(y){throw console.error("Error al actualizar paciente (coherencia):",y),new Error("El caso se actualizó, pero falló la actualización del paciente")}A.value=K,de("case-updated",K),ee("¡Caso Actualizado Exitosamente!",""),co()}catch(W){console.error("Error al actualizar caso:",W),G("Error al actualizar el caso",W.message||"Error desconocido")}finally{V.value=!1}},a=t=>/^\d{4}-\d{5}$/.test(t),b=()=>{R.value="",L.value=!1,v.value=null},H=async()=>{if(!T.value.trim()){R.value="Por favor ingrese un código de caso";return}if(!a(T.value)){R.value="El código debe tener el formato YYYY-NNNNN";return}ie.value=!0,R.value="",L.value=!1;try{const t=await we.getCaseByCode(T.value);t?(v.value=t,L.value=!0,await Q(t)):(R.value=`No se encontró un caso con el código ${T.value}`,L.value=!1,v.value=null)}catch(t){console.error("Error al buscar caso:",t),t.message.includes("404")||t.message.includes("No encontrado")?R.value="No se encontró un caso con el código especificado.":R.value="Error al buscar el caso. Verifique el código e intente nuevamente.",L.value=!1,v.value=null}finally{ie.value=!1}},Q=async t=>{var o,u,f,k,i,h,I,d,E,w,N,M,oe,te,ae,ne,W,se,le;try{ge.value=t.codigo||t.code||T.value||B.caseCodeProp||"",v.value=t,L.value=!0;const K={pacienteCedula:((o=t.paciente)==null?void 0:o.cedula)||((u=t.paciente)==null?void 0:u.numeroCedula)||t.cedula_paciente||"",fechaIngreso:$e(t.fecha_creacion||t.fechaCreacion||((f=t.fecha_creacion)==null?void 0:f.$date)||""),medicoSolicitante:((k=t.medico_solicitante)==null?void 0:k.nombre)||t.medico_solicitante||t.medicoSolicitante||"",servicio:t.servicio||t.servicio||"",entidadPaciente:((i=t.entidad_info)==null?void 0:i.codigo)||((I=(h=t.paciente)==null?void 0:h.entidad_info)==null?void 0:I.codigo)||t.entidadPaciente||t.entidad_codigo||"",tipoAtencionPaciente:qe(((d=t.paciente)==null?void 0:d.tipo_atencion)||t.tipo_atencion||t.tipoAtencionPaciente||""),estado:t.estado||t.estado||"En proceso",patologoAsignado:((E=t.patologo_asignado)==null?void 0:E.codigo)||"",numeroMuestras:(((w=t.muestras)==null?void 0:w.length)||t.numeroMuestras||1).toString(),muestras:(()=>{const X=t.muestras||t.muestras||[];return X&&X.length>0?X.map((me,y)=>({numero:y+1,regionCuerpo:ye(me.region_cuerpo||me.regionCuerpo||""),pruebas:(()=>{const q=me.pruebas||me.tests||[];return q&&q.length>0?q.map(Z=>({code:Z.id||Z.code||Z.codigo||"",cantidad:Z.cantidad||1,nombre:Z.nombre||Z.name||""})):[{code:"",cantidad:1,nombre:""}]})()})):[F(1)]})(),observaciones:t.observaciones_generales||t.observaciones||t.observacionesGenerales||""};Object.assign(n,K),j.value={...K},x.value={nombre:((N=t.paciente)==null?void 0:N.nombre)||((M=t.paciente)==null?void 0:M.nombrePaciente)||t.nombre_paciente||"",cedula:((oe=t.paciente)==null?void 0:oe.cedula)||(t==null?void 0:t.numeroCedula)||t.cedula_paciente||K.pacienteCedula||"",edad:((te=t.paciente)==null?void 0:te.edad)||t.edad_paciente||0,sexo:((ae=t.paciente)==null?void 0:ae.sexo)||t.sexo_paciente||""},(ne=t.patologo_asignado)!=null&&ne.codigo?ue.value={codigo:t.patologo_asignado.codigo,nombre:t.patologo_asignado.nombre||""}:ue.value=null,(W=t.entidad_info)!=null&&W.codigo?S.value={codigo:t.entidad_info.codigo,nombre:t.entidad_info.nombre}:(le=(se=t.paciente)==null?void 0:se.entidad_info)!=null&&le.codigo?S.value={codigo:t.paciente.entidad_info.codigo,nombre:t.paciente.entidad_info.nombre}:S.value=null,U.value=!0}catch(K){console.error("Error al mapear datos del caso:",K),G("Error al cargar datos del caso",K.message||"Error desconocido")}},be=()=>{O.value=!0,T.value="",R.value="",L.value=!1,v.value=null,Object.assign(n,{pacienteCedula:"",fechaIngreso:"",medicoSolicitante:"",servicio:"",entidadPaciente:"",tipoAtencionPaciente:"",estado:"",numeroMuestras:"1",muestras:[F(1)],observaciones:"",patologoAsignado:""}),x.value={nombre:"",cedula:"",edad:0,sexo:"",entidad:"",tipoAtencion:""},ue.value=null,S.value=null,j.value=null,U.value=!1,ge.value="",A.value=null,Y(),r.value++},S=p(null),no=t=>{t&&t.codigo?S.value={codigo:t.codigo,nombre:t.nombre}:S.value=null},ue=p(null),io=t=>{t?ue.value={codigo:t.documento,nombre:t.nombre}:ue.value=null},so=t=>{const o=parseInt(t);if(!(isNaN(o)||o<1))if(n.numeroMuestras=t,o>n.muestras.length)for(;n.muestras.length<o;)n.muestras.push(F(n.muestras.length+1));else o<n.muestras.length&&(n.muestras=n.muestras.slice(0,o))},lo=t=>{t>=0&&t<n.muestras.length&&n.muestras[t].pruebas.push({code:"",cantidad:1,nombre:""})},ro=(t,o)=>{if(t>=0&&t<n.muestras.length){const u=n.muestras[t];u.pruebas.length>1&&o>=0&&o<u.pruebas.length&&u.pruebas.splice(o,1)}},uo=(t,o,u)=>{if(u&&t>=0&&t<n.muestras.length){const f=n.muestras[t];o>=0&&o<f.pruebas.length&&(f.pruebas[o].code=u.pruebaCode||u.code,f.pruebas[o].nombre=u.pruebasName||u.nombre)}},co=()=>{Object.assign(n,{pacienteCedula:"",fechaIngreso:"",medicoSolicitante:"",servicio:"",entidadPaciente:"",tipoAtencionPaciente:"",estado:"",numeroMuestras:"1",muestras:[F(1)],observaciones:"",patologoAsignado:""}),T.value="",R.value="",L.value=!1,j.value=null,U.value=!1},ce=t=>{var k,i,h,I,d,E,w,N,M,oe,te,ae,ne,W,se,le,K;const o=A.value||{},u=v.value||{},f=x.value||{};switch(t){case"nombre":return((k=o.paciente)==null?void 0:k.nombre)||((i=u.paciente)==null?void 0:i.nombre)||f.nombre||"N/A";case"cedula":return((h=o.paciente)==null?void 0:h.cedula)||((I=u.paciente)==null?void 0:I.cedula)||f.cedula||"N/A";case"edad":{const X=((d=o.paciente)==null?void 0:d.edad)??((E=u.paciente)==null?void 0:E.edad)??f.edad;return X!=null?String(X):"N/A"}case"sexo":return((w=o.paciente)==null?void 0:w.sexo)||((N=u.paciente)==null?void 0:N.sexo)||f.sexo||"N/A";case"entidad":return((M=o.entidad_info)==null?void 0:M.nombre)||((te=(oe=o.paciente)==null?void 0:oe.entidad_info)==null?void 0:te.nombre)||((ae=u.entidad_info)==null?void 0:ae.nombre)||((W=(ne=u.paciente)==null?void 0:ne.entidad_info)==null?void 0:W.nombre)||f.entidad||((se=S.value)==null?void 0:se.nombre)||""||"N/A";case"tipoAtencion":return((le=o.paciente)==null?void 0:le.tipo_atencion)||o.tipo_atencion||((K=u.paciente)==null?void 0:K.tipo_atencion)||u.tipo_atencion||f.tipoAtencion||"N/A";default:return"N/A"}},mo=()=>{var t,o;return((o=(t=A.value)==null?void 0:t.muestras)==null?void 0:o.length)||n.muestras.length},je=()=>{const t=A.value||{};return t.observaciones_generales||t.observaciones||t.observacionesGenerales||n.observaciones||""},po=()=>{var t;return((t=A.value)==null?void 0:t.muestras)||n.muestras},Ue=t=>t.pruebas&&t.pruebas.length||0,go=t=>(t.pruebas||[]).map(o=>{const u=o.id||o.codigo||o.code||"",f=o.nombre||o.name||"";return`${u||f||"Sin código"} (${o.cantidad||1})`}).join(", "),vo=()=>{var u,f,k;const t=A.value||{},o=v.value||{};return((u=t.medico_solicitante)==null?void 0:u.nombre)||((f=t.medicoSolicitante)==null?void 0:f.nombre)||((k=o.medico_solicitante)==null?void 0:k.nombre)||o.medicoSolicitante||"No especificado"},bo=()=>{const t=A.value||{},o=v.value||{};return t.servicio||o.servicio||n.servicio||"No especificado"},fo=()=>{var t,o;return ge.value||((t=A.value)==null?void 0:t.codigo)||((o=A.value)==null?void 0:o.code)||T.value||B.caseCodeProp||"N/A"};Pe(()=>B.caseCodeProp,t=>{t&&Ce()},{immediate:!0}),Pe(()=>C.visible,async t=>{t&&(await Xe(),z.value&&z.value.scrollIntoView({behavior:"smooth",block:"center"}))});const _o=()=>{O.value=!0,Y()};return We(()=>{B.caseCodeProp&&Ce()}),(t,o)=>{var u,f,k,i,h,I;return m(),_("div",Ao,[e("form",{class:"space-y-4",onSubmit:Ve(l,["prevent"])},[t.caseCodeProp?P("",!0):(m(),_("div",So,[e("div",Eo,[o[18]||(o[18]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center"},[e("svg",{class:"w-4 h-4 mr-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})]),ke(" Buscar Caso para Editar ")],-1)),e("div",qo,[e("div",$o,[g(s(D),{modelValue:T.value,"onUpdate:modelValue":[o[0]||(o[0]=d=>T.value=d),b],type:"text",placeholder:"Ej: 2025-00001",maxlength:"10",autocomplete:"off",disabled:ie.value,onKeydown:Je(Ve(H,["prevent"]),["enter"])},null,8,["modelValue","disabled","onKeydown"]),T.value&&!a(T.value)?(m(),_("div",No," El código debe tener el formato YYYY-NNNNN (Ejemplo: 2025-00001) ")):P("",!0)]),e("div",Mo,[g(s(Ze),{text:"Buscar","loading-text":"Buscando...",loading:ie.value,onClick:H,size:"md",variant:"primary"},null,8,["loading"]),L.value?(m(),J(s(Ee),{key:0,text:"Limpiar",onClick:be})):P("",!0)])]),R.value?(m(),_("div",Bo,[e("div",jo,[o[10]||(o[10]=e("svg",{class:"w-5 h-5 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e("p",Uo,c(R.value),1)])])):P("",!0),L.value&&v.value?(m(),_("div",To,[o[17]||(o[17]=Ae('<div class="flex items-center justify-between mb-3"><div class="flex items-center"><svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><h4 class="text-sm font-semibold text-green-800">Caso Encontrado y Cargado</h4></div></div>',1)),e("div",Lo,[e("div",null,[o[11]||(o[11]=e("span",{class:"font-medium text-green-700"},"Código:",-1)),e("p",Fo,c(v.value.CasoCode||"N/A"),1)]),e("div",null,[o[12]||(o[12]=e("span",{class:"font-medium text-green-700"},"Paciente:",-1)),e("p",Oo,c(((u=v.value.paciente)==null?void 0:u.nombre)||"N/A"),1)]),e("div",null,[o[13]||(o[13]=e("span",{class:"font-medium text-green-700"},"Cédula:",-1)),e("p",Ro,c(((f=v.value.paciente)==null?void 0:f.cedula)||"N/A"),1)]),e("div",null,[o[14]||(o[14]=e("span",{class:"font-medium text-green-700"},"Estado:",-1)),e("p",Io,c(v.value.estado||"N/A"),1)]),e("div",null,[o[15]||(o[15]=e("span",{class:"font-medium text-green-700"},"Entidad:",-1)),e("p",Yo,c(((k=v.value.entidad_info)==null?void 0:k.nombre)||((h=(i=v.value.paciente)==null?void 0:i.entidad_info)==null?void 0:h.nombre)||"N/A"),1)]),e("div",null,[o[16]||(o[16]=e("span",{class:"font-medium text-green-700"},"Tipo de Atención:",-1)),e("p",Ho,c(((I=v.value.paciente)==null?void 0:I.tipo_atencion)||"N/A"),1)])])])):P("",!0)])])),!L.value&&!s(C).visible?(m(),_("div",Ko,[...o[19]||(o[19]=[Ae('<div class="flex flex-col items-center space-y-3"><svg class="w-12 h-12 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><h3 class="text-lg font-medium text-blue-800">Busque un caso para editar</h3><p class="text-blue-600 text-sm">Ingrese el código del caso en el campo de búsqueda arriba para comenzar a editar</p></div>',1)])])):P("",!0),L.value?(m(),_("div",Go,[e("div",Wo,[g(s(D),{modelValue:n.medicoSolicitante,"onUpdate:modelValue":o[1]||(o[1]=d=>n.medicoSolicitante=d),label:"Médico Solicitante",placeholder:"Médico que solicita el estudio",required:!1,"max-length":100},null,8,["modelValue"]),g(s(D),{modelValue:n.servicio,"onUpdate:modelValue":o[2]||(o[2]=d=>n.servicio=d),label:"Servicio",placeholder:"Procedencia del caso",required:!1,"max-length":100},null,8,["modelValue"])]),e("div",Jo,[(m(),J(s(to),{key:"entity-"+r.value,modelValue:n.entidadPaciente,"onUpdate:modelValue":o[3]||(o[3]=d=>n.entidadPaciente=d),label:"Entidad del Paciente",placeholder:"Buscar entidad...",required:!0,"auto-load":!0,onEntitySelected:no},null,8,["modelValue"])),(m(),J(s(Se),{key:"tipoAtencion-"+r.value+"-"+n.tipoAtencionPaciente,modelValue:n.tipoAtencionPaciente,"onUpdate:modelValue":o[4]||(o[4]=d=>n.tipoAtencionPaciente=d),label:"Tipo de Atención",placeholder:"Seleccione el tipo de atención",required:!0,options:xe},null,8,["modelValue"]))]),e("div",Qo,[g(s(D),{modelValue:n.numeroMuestras,"onUpdate:modelValue":o[5]||(o[5]=d=>n.numeroMuestras=d),label:"Número de Muestras",type:"number",min:1,max:99,required:!0,onInput:so},null,8,["modelValue"]),g(s(D),{modelValue:n.fechaIngreso,"onUpdate:modelValue":o[6]||(o[6]=d=>n.fechaIngreso=d),label:"Fecha de creación",type:"date",required:!0},null,8,["modelValue"]),(m(),J(s(Se),{key:"estado-"+r.value,modelValue:n.estado,"onUpdate:modelValue":o[7]||(o[7]=d=>n.estado=d),label:"Estado del Caso",placeholder:"Seleccione el estado",required:!0,options:he},null,8,["modelValue"]))]),e("div",Xo,[(m(),J(s(Po),{key:"pathologist-"+r.value,modelValue:n.patologoAsignado,"onUpdate:modelValue":o[8]||(o[8]=d=>n.patologoAsignado=d),label:"Patólogo Asignado",placeholder:"Buscar patólogo...",required:!1,"auto-load":!0,onPathologistSelected:io},null,8,["modelValue"]))]),n.muestras.length>0?(m(),_("div",Zo,[o[21]||(o[21]=e("h3",{class:"text-lg font-semibold text-gray-800 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})]),ke(" Información de Submuestras ")],-1)),e("div",Do,[(m(!0),_(Ne,null,Me(n.muestras,(d,E)=>(m(),_("div",{key:d.numero+"-"+r.value,class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},[e("h4",et," Submuestra "+c(d.numero),1),e("div",ot,[(m(),J(s(ko),{key:"region-"+E+"-"+r.value,modelValue:d.regionCuerpo,"onUpdate:modelValue":w=>d.regionCuerpo=w,label:`Región del Cuerpo - Submuestra ${d.numero}`,placeholder:"Buscar región del cuerpo...",required:!0,"help-text":"Seleccione la región anatómica de donde proviene la muestra"},null,8,["modelValue","onUpdate:modelValue","label"]))]),e("div",tt,[e("div",at,[o[20]||(o[20]=e("label",{class:"block text-sm font-medium text-gray-700"},[ke(" Pruebas a Realizar "),e("span",{class:"text-red-500"},"*")],-1)),g(s(wo),{text:"Agregar Prueba",onClick:w=>lo(E)},null,8,["onClick"])]),e("div",nt,[(m(!0),_(Ne,null,Me(d.pruebas,(w,N)=>(m(),_("div",{key:N+"-"+r.value,class:"flex flex-col sm:flex-row gap-2 sm:gap-3 items-end"},[e("div",it,[(m(),J(s(Vo),{key:"test-"+E+"-"+N+"-"+r.value,modelValue:w.code,"onUpdate:modelValue":M=>w.code=M,label:`Prueba ${N+1}`,placeholder:`Buscar y seleccionar prueba ${N+1}...`,required:!0,"auto-load":!0,onTestSelected:M=>uo(E,N,M)},null,8,["modelValue","onUpdate:modelValue","label","placeholder","onTestSelected"]))]),e("div",st,[g(s(D),{modelValue:w.cantidad,"onUpdate:modelValue":M=>w.cantidad=M,modelModifiers:{number:!0},label:"Cantidad",type:"number",min:1,max:10,placeholder:"Cantidad"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",lt,[d.pruebas.length>1?(m(),J(s(zo),{key:0,onClick:M=>ro(E,N),title:"Eliminar prueba"},null,8,["onClick"])):P("",!0)])]))),128))])])]))),128))])])):P("",!0),g(s(De),{modelValue:n.observaciones,"onUpdate:modelValue":o[9]||(o[9]=d=>n.observaciones=d),label:"Observaciones del Caso",placeholder:"Observaciones adicionales sobre el caso o procedimiento...",rows:3,"max-length":500,"show-counter":!0,"help-text":"Información adicional relevante para el procesamiento del caso"},null,8,["modelValue"]),e("div",rt,[g(s(Ee),{onClick:be,disabled:V.value},null,8,["disabled"]),g(s(oo),{text:"Guardar Cambios",onClick:l,disabled:V.value||!ve.value,loading:V.value},null,8,["disabled","loading"])])])):P("",!0),s(C).visible?(m(),_("div",{key:3,ref_key:"notificationContainer",ref:z},[g(eo,{visible:s(C).visible,type:s(C).type,title:s(C).title,message:s(C).message,inline:!0,"auto-close":!1,onClose:_o},Qe({_:2},[s(C).type==="success"&&A.value?{name:"content",fn:re(()=>[e("div",dt,[e("div",ut,[e("div",ct,[e("p",mt,c(fo()),1)]),e("div",pt,[e("div",null,[o[28]||(o[28]=e("h4",{class:"font-semibold text-gray-800 mb-3 text-base"},"Información del Paciente",-1)),e("div",gt,[e("div",null,[o[22]||(o[22]=e("span",{class:"text-gray-500 font-medium"},"Nombre:",-1)),e("p",vt,c(ce("nombre")),1)]),e("div",null,[o[23]||(o[23]=e("span",{class:"text-gray-500 font-medium"},"Cédula:",-1)),e("p",bt,c(ce("cedula")),1)]),e("div",null,[o[24]||(o[24]=e("span",{class:"text-gray-500 font-medium"},"Edad:",-1)),e("p",ft,c(ce("edad"))+" años",1)]),e("div",null,[o[25]||(o[25]=e("span",{class:"text-gray-500 font-medium"},"Sexo:",-1)),e("p",_t,c(ce("sexo")),1)]),e("div",null,[o[26]||(o[26]=e("span",{class:"text-gray-500 font-medium"},"Entidad:",-1)),e("p",xt,c(ce("entidad")),1)]),e("div",null,[o[27]||(o[27]=e("span",{class:"text-gray-500 font-medium"},"Tipo de Atención:",-1)),e("p",ht,c(ce("tipoAtencion")),1)])])]),e("div",null,[o[34]||(o[34]=e("h4",{class:"font-semibold text-gray-800 mb-3 text-base"},"Detalles del Caso",-1)),e("div",yt,[e("div",null,[o[29]||(o[29]=e("span",{class:"text-gray-500 font-medium"},"Estado:",-1)),e("p",Ct,c(A.value.estado||"Pendiente"),1)]),e("div",null,[o[30]||(o[30]=e("span",{class:"text-gray-500 font-medium"},"Médico Solicitante:",-1)),e("p",kt,c(vo()),1)]),e("div",null,[o[31]||(o[31]=e("span",{class:"text-gray-500 font-medium"},"Servicio:",-1)),e("p",wt,c(bo()),1)]),e("div",null,[o[32]||(o[32]=e("span",{class:"text-gray-500 font-medium"},"Número de Submuestras:",-1)),e("p",zt,c(mo()),1)]),je()?(m(),_("div",Pt,[o[33]||(o[33]=e("span",{class:"text-gray-500 font-medium"},"Observaciones:",-1)),e("p",Vt,c(je()),1)])):P("",!0)])])]),e("div",null,[o[37]||(o[37]=e("h4",{class:"font-semibold text-gray-800 mb-3 text-base"},"Submuestras Actualizadas",-1)),e("div",At,[(m(!0),_(Ne,null,Me(po(),(d,E)=>{var w;return m(),_("div",{key:E,class:"border border-gray-200 rounded-lg p-3 bg-gray-50"},[e("div",St,[e("span",Et,"Submuestra "+c(E+1),1),e("span",qt,c(Ue(d))+" prueba"+c(Ue(d)!==1?"s":""),1)]),e("div",$t,[e("div",null,[o[35]||(o[35]=e("span",{class:"text-gray-500 font-medium"},"Región:",-1)),e("p",Nt,c(d.regionCuerpo||"Sin especificar"),1)]),e("div",null,[o[36]||(o[36]=e("span",{class:"text-gray-500 font-medium"},"Pruebas:",-1)),e("div",Mt,[((w=d.pruebas)==null?void 0:w.length)>0?(m(),_("span",Bt,c(go(d)),1)):(m(),_("span",jt,"Sin pruebas"))])])])])}),128))])])])])]),key:"0"}:void 0]),1032,["visible","type","title","message"])],512)):P("",!0)],32)])}}}),Tt={class:"space-y-4"},Lt={key:0,class:"bg-gray-50 rounded-lg border border-gray-200"},Ft={class:"px-4 pt-4 pb-4"},Ot={class:"flex flex-col sm:flex-row gap-3 sm:gap-4 items-stretch sm:items-end"},Rt={class:"flex-1"},It={class:"flex gap-2 sm:gap-3"},Yt={key:0,class:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg"},Ht={class:"flex items-center"},Kt={class:"text-sm text-red-600"},Gt={key:1,class:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg"},Wt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 text-sm"},Jt={class:"text-green-800 break-words"},Qt={class:"text-green-800 font-mono"},Xt={class:"text-green-800"},Zt={class:"text-green-800"},Dt={class:"text-green-800 break-words"},ea={class:"text-green-800 break-words"},oa={key:1,class:"bg-blue-50 border border-blue-200 rounded-lg p-6 text-center"},ta={key:2,class:"space-y-6"},aa={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},na={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},ia={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm"},sa={class:"space-y-4"},la={class:"mb-4 pb-3 border-b border-gray-100"},ra={class:"text-xl font-bold text-gray-900 mb-2"},da={class:"text-gray-600"},ua={class:"font-mono font-bold text-gray-800 ml-1"},ca={class:"space-y-4"},ma={class:"grid grid-cols-3 gap-6 text-sm"},pa={class:"text-gray-800 font-semibold"},ga={class:"text-gray-800 font-semibold"},va={class:"text-gray-800 font-semibold"},ba={class:"text-sm"},fa={class:"text-gray-800 font-semibold break-words"},_a=Be({__name:"EditPatientForm",props:{caseCodeProp:{}},emits:["patient-updated"],setup(_e,{emit:pe}){const B=_e,de=pe,{notification:C,showNotification:ee,closeNotification:G}=ao(),Y=p(!1),$=p(null),F=p(null),V=p(null),j=p(""),A=p(!1),U=p(""),x=p(!1),z=p(null),O=p(null),r=Ge({numeroCedula:"",nombrePaciente:"",sexo:"",edad:"",entidad:"",entidadCodigo:"",tipoAtencion:"",observaciones:""}),ge=[{value:"masculino",label:"Masculino"},{value:"femenino",label:"Femenino"}],T=[{value:"ambulatorio",label:"Ambulatorio"},{value:"hospitalizado",label:"Hospitalizado"}],ie=ze(()=>r.nombrePaciente.trim()!==""&&r.sexo!==""&&r.edad.trim()!==""&&r.entidadCodigo&&r.tipoAtencion!==""),R=ze(()=>r.entidadCodigo?"":"La entidad es obligatoria"),L=async()=>{await Xe(),F.value&&F.value.scrollIntoView({behavior:"smooth",block:"center"})},v=l=>{var a,b,H,Q,be,S;return{numeroCedula:l.cedula,nombrePaciente:l.nombre,sexo:((a=l.sexo)==null?void 0:a.toLowerCase())==="masculino"?"masculino":((b=l.sexo)==null?void 0:b.toLowerCase())==="femenino"?"femenino":"",edad:String(l.edad),entidad:((H=l.entidad_info)==null?void 0:H.nombre)||"",entidadCodigo:((Q=l.entidad_info)==null?void 0:Q.id)||"",tipoAtencion:((be=l.tipo_atencion)==null?void 0:be.toLowerCase())==="ambulatorio"?"ambulatorio":((S=l.tipo_atencion)==null?void 0:S.toLowerCase())==="hospitalizado"?"hospitalizado":"",observaciones:l.observaciones||""}},n=l=>{l.entidad_info?(O.value={codigo:l.entidad_info.id,nombre:l.entidad_info.nombre},r.entidadCodigo=l.entidad_info.id):(O.value=null,r.entidadCodigo=void 0)},xe=async()=>{var l;if(B.caseCodeProp){Y.value=!0;try{const a=await we.getCaseByCode(B.caseCodeProp),b=(l=a==null?void 0:a.paciente)==null?void 0:l.cedula;if(!b)throw new Error("El caso no contiene cédula de paciente");const H=await fe.getPatientByCedula(b);if(!H)throw new Error("Paciente no encontrado en la colección de pacientes");const Q=v(H);Object.assign(r,Q),$.value={...Q},n(H),x.value=!0,z.value=Q}catch(a){console.error("Error al cargar datos del paciente:",a),ee("error","Error",a.message||"Error al cargar los datos del paciente")}finally{Y.value=!1}}},he=async()=>{if(!ie.value)return;const l=r.numeroCedula||j.value;if(!l){ee("error","Error","Debe buscar un paciente primero para poder editar sus datos");return}Y.value=!0;try{const a=fe.validatePatientData(r);if(!a.isValid)throw new Error(`Datos inválidos: ${a.errors.join(", ")}`);O.value&&(r.entidadCodigo=O.value.codigo,r.entidad=O.value.nombre);const b=await fe.updatePatient(l,r),H=v(b);$.value={...H},V.value=b,de("patient-updated",H),ee("success","¡Paciente Actualizado Exitosamente!","",0),qe()}catch(a){console.error("Error al actualizar paciente:",a),ee("error","Error",a.message||"Error al actualizar los datos del paciente")}finally{Y.value=!1}},ve=()=>{G(),Object.assign(r,{numeroCedula:"",nombrePaciente:"",sexo:"",edad:"",entidad:"",entidadCodigo:"",tipoAtencion:"",observaciones:""}),j.value="",U.value="",x.value=!1,z.value=null,O.value=null,$.value=null,V.value=null},qe=()=>{Object.assign(r,{numeroCedula:"",nombrePaciente:"",sexo:"",edad:"",entidad:"",entidadCodigo:"",tipoAtencion:"",observaciones:""}),j.value="",U.value="",x.value=!1,z.value=null,O.value=null,$.value=null};Pe(()=>B.caseCodeProp,l=>{l&&xe()},{immediate:!0}),Pe(()=>C.visible,l=>{l&&L()}),We(()=>{B.caseCodeProp&&xe()});const $e=l=>{let a=l.replace(/\D/g,"");a.length>10&&(a=a.substring(0,10)),j.value=a,U.value="",x.value=!1,z.value=null},ye=async()=>{if(!j.value.trim()){U.value="Por favor ingrese un número de cédula";return}if(j.value.length<6){U.value="La cédula debe tener al menos 6 dígitos";return}A.value=!0,U.value="",x.value=!1;try{const l=await fe.getPatientByCedula(j.value);if(l){const a=v(l);z.value=a,x.value=!0,Object.assign(r,a),$.value={...a},n(l)}else U.value=`No se encontró un paciente con la cédula ${j.value}`,x.value=!1,z.value=null}catch(l){console.error("Error al buscar paciente:",l),U.value=l.message||"Error al buscar el paciente. Verifique la cédula e intente nuevamente.",x.value=!1,z.value=null}finally{A.value=!1}},Ce=l=>{O.value=l,l?(r.entidad=l.nombre,r.entidadCodigo=l.codigo):(r.entidad="",r.entidadCodigo=void 0)};return(l,a)=>(m(),_("div",Tt,[e("form",{class:"space-y-4",onSubmit:Ve(he,["prevent"])},[l.caseCodeProp?P("",!0):(m(),_("div",Lt,[e("div",Ft,[a[15]||(a[15]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center"},[e("svg",{class:"w-4 h-4 mr-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),ke(" Buscar Paciente para Editar ")],-1)),e("div",Ot,[e("div",Rt,[g(s(D),{modelValue:j.value,"onUpdate:modelValue":[a[0]||(a[0]=b=>j.value=b),$e],placeholder:"Ingrese número de cédula",required:!0,"max-length":10,inputmode:"numeric",disabled:A.value,onKeydown:Je(Ve(ye,["prevent"]),["enter"])},null,8,["modelValue","disabled","onKeydown"])]),e("div",It,[g(s(Ze),{text:"Buscar","loading-text":"Buscando...",loading:A.value,onClick:ye,size:"md",variant:"primary"},null,8,["loading"]),x.value?(m(),J(s(Ee),{key:0,text:"Limpiar",onClick:ve})):P("",!0)])]),U.value?(m(),_("div",Yt,[e("div",Ht,[a[7]||(a[7]=e("svg",{class:"w-5 h-5 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e("p",Kt,c(U.value),1)])])):P("",!0),x.value&&z.value?(m(),_("div",Gt,[a[14]||(a[14]=Ae('<div class="flex items-center justify-between mb-3"><div class="flex items-center"><svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><h4 class="text-sm font-semibold text-green-800">Paciente Encontrado y Cargado</h4></div></div>',1)),e("div",Wt,[e("div",null,[a[8]||(a[8]=e("span",{class:"font-medium text-green-700"},"Nombre:",-1)),e("p",Jt,c(z.value.nombrePaciente),1)]),e("div",null,[a[9]||(a[9]=e("span",{class:"font-medium text-green-700"},"Cédula:",-1)),e("p",Qt,c(z.value.numeroCedula),1)]),e("div",null,[a[10]||(a[10]=e("span",{class:"font-medium text-green-700"},"Edad:",-1)),e("p",Xt,c(z.value.edad)+" años",1)]),e("div",null,[a[11]||(a[11]=e("span",{class:"font-medium text-green-700"},"Sexo:",-1)),e("p",Zt,c(z.value.sexo),1)]),e("div",null,[a[12]||(a[12]=e("span",{class:"font-medium text-green-700"},"Entidad:",-1)),e("p",Dt,c(z.value.entidad),1)]),e("div",null,[a[13]||(a[13]=e("span",{class:"font-medium text-green-700"},"Tipo de Atención:",-1)),e("p",ea,c(z.value.tipoAtencion),1)])])])):P("",!0)])])),!x.value&&!s(C).visible?(m(),_("div",oa,[...a[16]||(a[16]=[Ae('<div class="flex flex-col items-center space-y-3"><svg class="w-12 h-12 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg><h3 class="text-lg font-medium text-blue-800">Busque un paciente para editar</h3><p class="text-blue-600 text-sm">Ingrese la cédula del paciente en el campo de búsqueda arriba para comenzar a editar</p></div>',1)])])):P("",!0),x.value?(m(),_("div",ta,[g(s(D),{modelValue:r.nombrePaciente,"onUpdate:modelValue":a[1]||(a[1]=b=>r.nombrePaciente=b),label:"Nombre completo",placeholder:"Ingrese el nombre del paciente",required:""},null,8,["modelValue"]),e("div",aa,[g(s(D),{modelValue:r.edad,"onUpdate:modelValue":a[2]||(a[2]=b=>r.edad=b),type:"number",label:"Edad",placeholder:"Ingrese la edad",required:""},null,8,["modelValue"]),g(s(Se),{modelValue:r.sexo,"onUpdate:modelValue":a[3]||(a[3]=b=>r.sexo=b),options:ge,label:"Sexo",placeholder:"Seleccione sexo",required:""},null,8,["modelValue"]),g(s(Se),{modelValue:r.tipoAtencion,"onUpdate:modelValue":a[4]||(a[4]=b=>r.tipoAtencion=b),options:T,label:"Tipo de atención",placeholder:"Seleccione tipo de atención",required:""},null,8,["modelValue"]),g(s(to),{modelValue:r.entidadCodigo,"onUpdate:modelValue":a[5]||(a[5]=b=>r.entidadCodigo=b),label:"Entidad",placeholder:"Buscar entidad...",required:!0,"auto-load":!0,error:R.value,onEntitySelected:Ce},null,8,["modelValue","error"])]),g(s(De),{modelValue:r.observaciones,"onUpdate:modelValue":a[6]||(a[6]=b=>r.observaciones=b),label:"Observaciones",placeholder:"Observaciones del paciente",rows:3,"max-length":500,"show-counter":!0,"help-text":"Información adicional sobre el paciente"},null,8,["modelValue"]),e("div",na,[g(s(Ee),{onClick:ve,disabled:Y.value},null,8,["disabled"]),g(s(oo),{text:"Guardar Cambios",onClick:he,disabled:Y.value||!ie.value,loading:Y.value},null,8,["disabled","loading"])])])):P("",!0),s(C).visible?(m(),_("div",{key:3,ref_key:"notificationContainer",ref:F},[g(eo,{visible:s(C).visible,type:s(C).type,title:s(C).title,message:s(C).message,inline:!0,"auto-close":!1,onClose:s(G)},Qe({_:2},[s(C).type==="success"&&V.value?{name:"content",fn:re(()=>{var b;return[e("div",ia,[e("div",sa,[e("div",la,[e("h3",ra,c(V.value.nombre),1),e("p",da,[a[17]||(a[17]=e("span",{class:"font-medium"},"Cédula:",-1)),e("span",ua,c(V.value.cedula),1)])]),e("div",ca,[e("div",ma,[e("div",null,[a[18]||(a[18]=e("span",{class:"text-gray-500 font-medium block mb-1"},"Edad:",-1)),e("p",pa,c(V.value.nombre),1)]),e("div",null,[a[19]||(a[19]=e("span",{class:"text-gray-500 font-medium block mb-1"},"Sexo:",-1)),e("p",ga,c(V.value.sexo),1)]),e("div",null,[a[20]||(a[20]=e("span",{class:"text-gray-500 font-medium block mb-1"},"Tipo de Atención:",-1)),e("p",va,c(V.value.tipo_atencion),1)])]),e("div",ba,[a[21]||(a[21]=e("span",{class:"text-gray-500 font-medium block mb-1"},"Entidad:",-1)),e("p",fa,c((b=V.value.entidad_info)==null?void 0:b.nombre),1)])])])])]}),key:"0"}:void 0]),1032,["visible","type","title","message","onClose"])],512)):P("",!0)],32)]))}}),xa={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},ha={class:"space-y-6"},ya={class:"space-y-6"},Ua=Be({__name:"EditCaseView",setup(_e){const pe=p("Modificar Caso Médico"),B=xo(),de=ze(()=>{const $=B.params.code;return Array.isArray($)?$[0]||"":$||""}),C=p(null),ee=p(null),G=$=>{C.value=$},Y=$=>{ee.value=$};return($,F)=>(m(),J(s(ho),null,{default:re(()=>[g(s(yo),{pageTitle:pe.value},null,8,["pageTitle"]),e("div",xa,[e("div",ha,[g(s(Ke),{title:"Modificar Datos del Caso",description:"Actualice la información del caso existente."},{icon:re(()=>[...F[0]||(F[0]=[e("svg",{class:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])]),default:re(()=>[g(Ut,{"case-code-prop":de.value,onCaseUpdated:G},null,8,["case-code-prop"])]),_:1})]),e("div",ya,[g(s(Ke),{title:"Modificar Datos del Paciente",description:"Edite los datos demográficos del paciente asociado."},{icon:re(()=>[...F[1]||(F[1]=[e("svg",{class:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)])]),default:re(()=>[g(_a,{"case-code-prop":de.value,onPatientUpdated:Y},null,8,["case-code-prop"])]),_:1})])])]),_:1}))}});export{Ua as default};
